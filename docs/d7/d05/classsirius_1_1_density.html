<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SIRIUS: sirius::Density Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SIRIUS
   &#160;<span id="projectnumber">6.4.0</span>
   </div>
   <div id="projectbrief">Electronic structure library and applications</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d5/def/namespacesirius.html">sirius</a></li><li class="navelem"><a class="el" href="../../d7/d05/classsirius_1_1_density.html">Density</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d5/dd6/classsirius_1_1_density-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">sirius::Density Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Generate charge density and magnetization from occupied spinor wave-functions.  
 <a href="../../d7/d05/classsirius_1_1_density.html#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for sirius::Density:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d6/d14/classsirius_1_1_density__inherit__graph.svg" width="118" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for sirius::Density:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../df/d7f/classsirius_1_1_density__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d97/structsirius_1_1_density_1_1paw__density__data__t.html">paw_density_data_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7dca6937cc2b1e865f1d77edfc575906"><td class="memItemLeft" align="right" valign="top"><a id="a7dca6937cc2b1e865f1d77edfc575906"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a7dca6937cc2b1e865f1d77edfc575906">Density</a> (<a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;ctx__)</td></tr>
<tr class="memdesc:a7dca6937cc2b1e865f1d77edfc575906"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. <br /></td></tr>
<tr class="separator:a7dca6937cc2b1e865f1d77edfc575906"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a370e60a8667fcad8fb3a0fe945a4ac72"><td class="memItemLeft" align="right" valign="top"><a id="a370e60a8667fcad8fb3a0fe945a4ac72"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>update</b> ()</td></tr>
<tr class="separator:a370e60a8667fcad8fb3a0fe945a4ac72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1060ccda46864cd753bd9b38a288a681"><td class="memItemLeft" align="right" valign="top"><a id="a1060ccda46864cd753bd9b38a288a681"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a1060ccda46864cd753bd9b38a288a681">core_leakage</a> () const</td></tr>
<tr class="memdesc:a1060ccda46864cd753bd9b38a288a681"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the total leakage of the core states out of the muffin-tins. <br /></td></tr>
<tr class="separator:a1060ccda46864cd753bd9b38a288a681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abea8fcd04749747c5abba5185420f413"><td class="memItemLeft" align="right" valign="top"><a id="abea8fcd04749747c5abba5185420f413"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#abea8fcd04749747c5abba5185420f413">initial_density</a> ()</td></tr>
<tr class="memdesc:abea8fcd04749747c5abba5185420f413"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate initial charge density and magnetization. <br /></td></tr>
<tr class="separator:abea8fcd04749747c5abba5185420f413"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45356dcd88effd130b03724827ba427"><td class="memItemLeft" align="right" valign="top"><a id="ae45356dcd88effd130b03724827ba427"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>initial_density_pseudo</b> ()</td></tr>
<tr class="separator:ae45356dcd88effd130b03724827ba427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2df9c61b1173bd89987926b3d249b94e"><td class="memItemLeft" align="right" valign="top"><a id="a2df9c61b1173bd89987926b3d249b94e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>initial_density_full_pot</b> ()</td></tr>
<tr class="separator:a2df9c61b1173bd89987926b3d249b94e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a644b3aa48c4ec61bc9ac33c3c7b6f435"><td class="memItemLeft" align="right" valign="top"><a id="a644b3aa48c4ec61bc9ac33c3c7b6f435"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>normalize</b> ()</td></tr>
<tr class="separator:a644b3aa48c4ec61bc9ac33c3c7b6f435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e938e2bbeaa45fc8bd31f2428eefe45"><td class="memItemLeft" align="right" valign="top"><a id="a6e938e2bbeaa45fc8bd31f2428eefe45"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a6e938e2bbeaa45fc8bd31f2428eefe45">check_num_electrons</a> () const</td></tr>
<tr class="memdesc:a6e938e2bbeaa45fc8bd31f2428eefe45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check total density for the correct number of electrons. <br /></td></tr>
<tr class="separator:a6e938e2bbeaa45fc8bd31f2428eefe45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cb3a45fa14f4d5e59d1ef6b69c7d624"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a7cb3a45fa14f4d5e59d1ef6b69c7d624">generate</a> (<a class="el" href="../../d9/dbd/classsirius_1_1_k__point__set.html">K_point_set</a> const &amp;ks__, bool add_core__, bool transform_to_rg__)</td></tr>
<tr class="memdesc:a7cb3a45fa14f4d5e59d1ef6b69c7d624"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate full charge density (valence + core) and magnetization from the wave functions.  <a href="#a7cb3a45fa14f4d5e59d1ef6b69c7d624">More...</a><br /></td></tr>
<tr class="separator:a7cb3a45fa14f4d5e59d1ef6b69c7d624"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7ca673d53b416e8ebbe12b29272911f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ab7ca673d53b416e8ebbe12b29272911f">generate_valence</a> (<a class="el" href="../../d9/dbd/classsirius_1_1_k__point__set.html">K_point_set</a> const &amp;ks__)</td></tr>
<tr class="memdesc:ab7ca673d53b416e8ebbe12b29272911f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate valence charge density and magnetization from the wave functions.  <a href="#ab7ca673d53b416e8ebbe12b29272911f">More...</a><br /></td></tr>
<tr class="separator:ab7ca673d53b416e8ebbe12b29272911f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a663a8c76c344c5983092ddb6bd31f56a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a663a8c76c344c5983092ddb6bd31f56a">augment</a> ()</td></tr>
<tr class="memdesc:a663a8c76c344c5983092ddb6bd31f56a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add augmentation charge Q(r).  <a href="#a663a8c76c344c5983092ddb6bd31f56a">More...</a><br /></td></tr>
<tr class="separator:a663a8c76c344c5983092ddb6bd31f56a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a83f9d0a1a26330f181ebaf853644b3"><td class="memItemLeft" align="right" valign="top"><a id="a8a83f9d0a1a26330f181ebaf853644b3"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a8a83f9d0a1a26330f181ebaf853644b3">generate_rho_aug</a> ()</td></tr>
<tr class="memdesc:a8a83f9d0a1a26330f181ebaf853644b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate augmentation charge density. <br /></td></tr>
<tr class="separator:a8a83f9d0a1a26330f181ebaf853644b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba49bccd299f66e8673c5930c46f2972"><td class="memItemLeft" align="right" valign="top"><a id="aba49bccd299f66e8673c5930c46f2972"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#aba49bccd299f66e8673c5930c46f2972">check_density_continuity_at_mt</a> ()</td></tr>
<tr class="memdesc:aba49bccd299f66e8673c5930c46f2972"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check density at MT boundary. <br /></td></tr>
<tr class="separator:aba49bccd299f66e8673c5930c46f2972"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a349e10ada5b6fbb5e8b9d5206aba765c"><td class="memItemLeft" align="right" valign="top"><a id="a349e10ada5b6fbb5e8b9d5206aba765c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>save</b> ()</td></tr>
<tr class="separator:a349e10ada5b6fbb5e8b9d5206aba765c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78ed4dc5b87a927570fe2e7552c548e1"><td class="memItemLeft" align="right" valign="top"><a id="a78ed4dc5b87a927570fe2e7552c548e1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>load</b> ()</td></tr>
<tr class="separator:a78ed4dc5b87a927570fe2e7552c548e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cea378baf2b5fab91d738d88d07842e"><td class="memItemLeft" align="right" valign="top"><a id="a5cea378baf2b5fab91d738d88d07842e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>save_to_xsf</b> ()</td></tr>
<tr class="separator:a5cea378baf2b5fab91d738d88d07842e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79fabeb03c5e4cd4d44127a2696e13e7"><td class="memItemLeft" align="right" valign="top"><a id="a79fabeb03c5e4cd4d44127a2696e13e7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>save_to_ted</b> ()</td></tr>
<tr class="separator:a79fabeb03c5e4cd4d44127a2696e13e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2b76bcacc2db613be601b1484d078bd"><td class="memItemLeft" align="right" valign="top"><a id="af2b76bcacc2db613be601b1484d078bd"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>save_to_xdmf</b> ()</td></tr>
<tr class="separator:af2b76bcacc2db613be601b1484d078bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4982fd3e14b8f9f9ba2b3d4d26ae9775"><td class="memItemLeft" align="right" valign="top"><a id="a4982fd3e14b8f9f9ba2b3d4d26ae9775"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a4982fd3e14b8f9f9ba2b3d4d26ae9775">core_leakage</a> (int ic) const</td></tr>
<tr class="memdesc:a4982fd3e14b8f9f9ba2b3d4d26ae9775"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return core leakage for a specific atom symmetry class. <br /></td></tr>
<tr class="separator:a4982fd3e14b8f9f9ba2b3d4d26ae9775"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50f4d549fe301c715a20d18188e99bdf"><td class="memItemLeft" align="right" valign="top"><a id="a50f4d549fe301c715a20d18188e99bdf"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a50f4d549fe301c715a20d18188e99bdf">rho</a> ()</td></tr>
<tr class="memdesc:a50f4d549fe301c715a20d18188e99bdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return charge density (scalar functions). <br /></td></tr>
<tr class="separator:a50f4d549fe301c715a20d18188e99bdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a513e391f0e65a84caec9c7e82967c6b4"><td class="memItemLeft" align="right" valign="top"><a id="a513e391f0e65a84caec9c7e82967c6b4"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a513e391f0e65a84caec9c7e82967c6b4">rho</a> () const</td></tr>
<tr class="memdesc:a513e391f0e65a84caec9c7e82967c6b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return const reference to charge density (scalar functions). <br /></td></tr>
<tr class="separator:a513e391f0e65a84caec9c7e82967c6b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a140642e23f409ec34df4fa49b1aec0b8"><td class="memItemLeft" align="right" valign="top"><a id="a140642e23f409ec34df4fa49b1aec0b8"></a>
<a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>rho_pseudo_core</b> ()</td></tr>
<tr class="separator:a140642e23f409ec34df4fa49b1aec0b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a743d7ef1111ba87b414aa6f3ecb001b2"><td class="memItemLeft" align="right" valign="top"><a id="a743d7ef1111ba87b414aa6f3ecb001b2"></a>
<a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>rho_pseudo_core</b> () const</td></tr>
<tr class="separator:a743d7ef1111ba87b414aa6f3ecb001b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5ee4b8490a976d7f007b333bf8307fb"><td class="memItemLeft" align="right" valign="top"><a id="aa5ee4b8490a976d7f007b333bf8307fb"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>magnetization</b> (int i)</td></tr>
<tr class="separator:aa5ee4b8490a976d7f007b333bf8307fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29cf00c83f1f76e7413856384f5331a5"><td class="memItemLeft" align="right" valign="top"><a id="a29cf00c83f1f76e7413856384f5331a5"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>magnetization</b> (int i) const</td></tr>
<tr class="separator:a29cf00c83f1f76e7413856384f5331a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac650f1c7e71e1cf8153ef9396caa81ec"><td class="memItemLeft" align="right" valign="top"><a id="ac650f1c7e71e1cf8153ef9396caa81ec"></a>
<a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>density_mt</b> (int ialoc) const</td></tr>
<tr class="separator:ac650f1c7e71e1cf8153ef9396caa81ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7904609f7a2d6f197ad1cb8cdef119a"><td class="memItemLeft" align="right" valign="top"><a id="af7904609f7a2d6f197ad1cb8cdef119a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#af7904609f7a2d6f197ad1cb8cdef119a">generate_paw_loc_density</a> ()</td></tr>
<tr class="memdesc:af7904609f7a2d6f197ad1cb8cdef119a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate \( n_1 \) and \( \tilde{n}_1 \) in lm components. <br /></td></tr>
<tr class="separator:af7904609f7a2d6f197ad1cb8cdef119a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc8ae822a10438f93fc2563b91931753"><td class="memItemLeft" align="right" valign="top"><a id="afc8ae822a10438f93fc2563b91931753"></a>
std::vector&lt; <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>ae_paw_atom_density</b> (int spl_paw_ind) const</td></tr>
<tr class="separator:afc8ae822a10438f93fc2563b91931753"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4135f25dca0609e0f5b19187c5e24e57"><td class="memItemLeft" align="right" valign="top"><a id="a4135f25dca0609e0f5b19187c5e24e57"></a>
std::vector&lt; <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>ps_paw_atom_density</b> (int spl_paw_ind) const</td></tr>
<tr class="separator:a4135f25dca0609e0f5b19187c5e24e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac49bc0be91cfc0e1c6de821959ed2211"><td class="memItemLeft" align="right" valign="top"><a id="ac49bc0be91cfc0e1c6de821959ed2211"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mixer_input</b> ()</td></tr>
<tr class="separator:ac49bc0be91cfc0e1c6de821959ed2211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa98f530b6ca5ce2cff733bffb22d589d"><td class="memItemLeft" align="right" valign="top"><a id="aa98f530b6ca5ce2cff733bffb22d589d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mixer_output</b> ()</td></tr>
<tr class="separator:aa98f530b6ca5ce2cff733bffb22d589d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab641f144d771e506c78c52ce3bd8c5cd"><td class="memItemLeft" align="right" valign="top"><a id="ab641f144d771e506c78c52ce3bd8c5cd"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mixer_init</b> (<a class="el" href="../../d4/db0/structsirius_1_1_mixer__input.html">Mixer_input</a> mixer_cfg__)</td></tr>
<tr class="separator:ab641f144d771e506c78c52ce3bd8c5cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a856614b00a6343e0d977e2b4e449f07f"><td class="memItemLeft" align="right" valign="top"><a id="a856614b00a6343e0d977e2b4e449f07f"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>mix</b> ()</td></tr>
<tr class="separator:a856614b00a6343e0d977e2b4e449f07f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cb08fd961d6109934001c47f44d3397"><td class="memItemLeft" align="right" valign="top"><a id="a3cb08fd961d6109934001c47f44d3397"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 4 &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>density_matrix</b> () const</td></tr>
<tr class="separator:a3cb08fd961d6109934001c47f44d3397"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acff0558af95fedf292051d0c8b24a344"><td class="memItemLeft" align="right" valign="top"><a id="acff0558af95fedf292051d0c8b24a344"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 4 &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>density_matrix</b> ()</td></tr>
<tr class="separator:acff0558af95fedf292051d0c8b24a344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04610b8505e14c5f815482a7780feb8c"><td class="memItemLeft" align="right" valign="top"><a id="a04610b8505e14c5f815482a7780feb8c"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a04610b8505e14c5f815482a7780feb8c">density_matrix_aux</a> (int iat__)</td></tr>
<tr class="memdesc:a04610b8505e14c5f815482a7780feb8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return density matrix in auxiliary form. <br /></td></tr>
<tr class="separator:a04610b8505e14c5f815482a7780feb8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5089752b2414fa4a16aa521b6731ab9e"><td class="memItemLeft" align="right" valign="top"><a id="a5089752b2414fa4a16aa521b6731ab9e"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a5089752b2414fa4a16aa521b6731ab9e">compute_atomic_mag_mom</a> () const</td></tr>
<tr class="memdesc:a5089752b2414fa4a16aa521b6731ab9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate approximate atomic magnetic moments in case of PP-PW. <br /></td></tr>
<tr class="separator:a5089752b2414fa4a16aa521b6731ab9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a961ccdca6c2653f8755b47c747f2720f"><td class="memItemLeft" align="right" valign="top">std::tuple&lt; std::array&lt; double, 3 &gt;, std::array&lt; double, 3 &gt;, std::vector&lt; std::array&lt; double, 3 &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a961ccdca6c2653f8755b47c747f2720f">get_magnetisation</a> () const</td></tr>
<tr class="memdesc:a961ccdca6c2653f8755b47c747f2720f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total magnetization and also contributions from interstitial and muffin-tin parts.  <a href="#a961ccdca6c2653f8755b47c747f2720f">More...</a><br /></td></tr>
<tr class="separator:a961ccdca6c2653f8755b47c747f2720f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aa2c64b50733841e1508208a242ee87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a5aa2c64b50733841e1508208a242ee87">symmetrize_density_matrix</a> ()</td></tr>
<tr class="memdesc:a5aa2c64b50733841e1508208a242ee87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Symmetrize density matrix.  <a href="#a5aa2c64b50733841e1508208a242ee87">More...</a><br /></td></tr>
<tr class="separator:a5aa2c64b50733841e1508208a242ee87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af54552a59505153d86ed71f256820188"><td class="memItemLeft" align="right" valign="top"><a id="af54552a59505153d86ed71f256820188"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>symmetrize</b> ()</td></tr>
<tr class="separator:af54552a59505153d86ed71f256820188"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classsirius_1_1_field4_d"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classsirius_1_1_field4_d')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html">sirius::Field4D</a></td></tr>
<tr class="memitem:a28b1083500ae2cbc7926bd95ce68418f inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a28b1083500ae2cbc7926bd95ce68418f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Field4D</b> (<a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;ctx__, int lmmax__)</td></tr>
<tr class="separator:a28b1083500ae2cbc7926bd95ce68418f inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac46db987e3bce8d86a27d0ad567ea8a7 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="ac46db987e3bce8d86a27d0ad567ea8a7"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#ac46db987e3bce8d86a27d0ad567ea8a7">scalar</a> ()</td></tr>
<tr class="memdesc:ac46db987e3bce8d86a27d0ad567ea8a7 inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return scalar part of the field. <br /></td></tr>
<tr class="separator:ac46db987e3bce8d86a27d0ad567ea8a7 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3ab52194f408696d8d4866311f96ec1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="aa3ab52194f408696d8d4866311f96ec1"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#aa3ab52194f408696d8d4866311f96ec1">scalar</a> () const</td></tr>
<tr class="memdesc:aa3ab52194f408696d8d4866311f96ec1 inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return scalar part of the field. <br /></td></tr>
<tr class="separator:aa3ab52194f408696d8d4866311f96ec1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e134300db71bb73274bc5f7bfd42073 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a8e134300db71bb73274bc5f7bfd42073"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#a8e134300db71bb73274bc5f7bfd42073">vector</a> (int i)</td></tr>
<tr class="memdesc:a8e134300db71bb73274bc5f7bfd42073 inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return component of the vector part of the field. <br /></td></tr>
<tr class="separator:a8e134300db71bb73274bc5f7bfd42073 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83a48620b0a8bb1218135b328880bf4c inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a83a48620b0a8bb1218135b328880bf4c"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#a83a48620b0a8bb1218135b328880bf4c">vector</a> (int i) const</td></tr>
<tr class="memdesc:a83a48620b0a8bb1218135b328880bf4c inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return component of the vector part of the field. <br /></td></tr>
<tr class="separator:a83a48620b0a8bb1218135b328880bf4c inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6760e58b189285aa6d45864a6c638cb1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a6760e58b189285aa6d45864a6c638cb1"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>component</b> (int i)</td></tr>
<tr class="separator:a6760e58b189285aa6d45864a6c638cb1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6ca1b060099cc75b5c7a0ba49060c4e inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="ad6ca1b060099cc75b5c7a0ba49060c4e"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#ad6ca1b060099cc75b5c7a0ba49060c4e">component_raise</a> (int i)</td></tr>
<tr class="memdesc:ad6ca1b060099cc75b5c7a0ba49060c4e inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Throws error in case of invalid access. <br /></td></tr>
<tr class="separator:ad6ca1b060099cc75b5c7a0ba49060c4e inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a066e5cb9cbd58539c2ccf5747b02eeed inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a066e5cb9cbd58539c2ccf5747b02eeed"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>component</b> (int i) const</td></tr>
<tr class="separator:a066e5cb9cbd58539c2ccf5747b02eeed inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf95b126e3e692c2e93a01eba7b0d943 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="adf95b126e3e692c2e93a01eba7b0d943"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>zero</b> ()</td></tr>
<tr class="separator:adf95b126e3e692c2e93a01eba7b0d943 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa34675a4cefd019dfe6567024da36b17 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="aa34675a4cefd019dfe6567024da36b17"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>fft_transform</b> (int direction__)</td></tr>
<tr class="separator:aa34675a4cefd019dfe6567024da36b17 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf935423af950dc46a97852c1d787903 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="aaf935423af950dc46a97852c1d787903"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mixer_input</b> ()</td></tr>
<tr class="separator:aaf935423af950dc46a97852c1d787903 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00bbdc6c15c965463e8254509aec5170 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a00bbdc6c15c965463e8254509aec5170"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mixer_output</b> ()</td></tr>
<tr class="separator:a00bbdc6c15c965463e8254509aec5170 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af43079007c73c1d9427fb02aae6e0585 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="af43079007c73c1d9427fb02aae6e0585"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mixer_init</b> (<a class="el" href="../../d4/db0/structsirius_1_1_mixer__input.html">Mixer_input</a> mixer_cfg__)</td></tr>
<tr class="separator:af43079007c73c1d9427fb02aae6e0585 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3b5f8fb15546cb04ff186e1a76cd496 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="aa3b5f8fb15546cb04ff186e1a76cd496"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>mix</b> (double rss_min__)</td></tr>
<tr class="separator:aa3b5f8fb15546cb04ff186e1a76cd496 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af36a17ade3860cfdb872b42d9b11fbad inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="af36a17ade3860cfdb872b42d9b11fbad"></a>
<a class="el" href="../../d1/d76/classsirius_1_1_mixer.html">Mixer</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>mixer</b> ()</td></tr>
<tr class="separator:af36a17ade3860cfdb872b42d9b11fbad inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1b2e72b2168727b3a1c022f882d4eaa inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="ae1b2e72b2168727b3a1c022f882d4eaa"></a>
<a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>ctx</b> ()</td></tr>
<tr class="separator:ae1b2e72b2168727b3a1c022f882d4eaa inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a67328cc11d444a56f5557a6c05ef4aab"><td class="memItemLeft" align="right" valign="top"><a id="a67328cc11d444a56f5557a6c05ef4aab"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a67328cc11d444a56f5557a6c05ef4aab">init_paw</a> ()</td></tr>
<tr class="memdesc:a67328cc11d444a56f5557a6c05ef4aab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate PAW data. <br /></td></tr>
<tr class="separator:a67328cc11d444a56f5557a6c05ef4aab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83cf34e3ebef152492c5c1527379a7ad"><td class="memItemLeft" align="right" valign="top"><a id="a83cf34e3ebef152492c5c1527379a7ad"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a83cf34e3ebef152492c5c1527379a7ad">generate_paw_atom_density</a> (<a class="el" href="../../d2/d97/structsirius_1_1_density_1_1paw__density__data__t.html">paw_density_data_t</a> &amp;pdd)</td></tr>
<tr class="memdesc:a83cf34e3ebef152492c5c1527379a7ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate atomic densities in the case of PAW. <br /></td></tr>
<tr class="separator:a83cf34e3ebef152492c5c1527379a7ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af399d9d8dce9410e3a3fd2881f53a7fe"><td class="memItemLeft" align="right" valign="top"><a id="af399d9d8dce9410e3a3fd2881f53a7fe"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#af399d9d8dce9410e3a3fd2881f53a7fe">init_density_matrix_for_paw</a> ()</td></tr>
<tr class="memdesc:af399d9d8dce9410e3a3fd2881f53a7fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize PAW density matrix. <br /></td></tr>
<tr class="separator:af399d9d8dce9410e3a3fd2881f53a7fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a107ce66dee55f7066e73d5797be490cd"><td class="memTemplParams" colspan="2">template&lt;int num_mag_dims&gt; </td></tr>
<tr class="memitem:a107ce66dee55f7066e73d5797be490cd"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a107ce66dee55f7066e73d5797be490cd">reduce_density_matrix</a> (<a class="el" href="../../d3/d37/classsirius_1_1_atom__type.html">Atom_type</a> const &amp;atom_type__, int ia__, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 4 &gt; const &amp;zdens__, <a class="el" href="../../de/dfd/classsirius_1_1_gaunt__coefficients.html">Gaunt_coefficients</a>&lt; double_complex &gt; const &amp;gaunt_coeffs__, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double, 3 &gt; &amp;mt_density_matrix__)</td></tr>
<tr class="memdesc:a107ce66dee55f7066e73d5797be490cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduce complex density matrix over magnetic quantum numbers.  <a href="#a107ce66dee55f7066e73d5797be490cd">More...</a><br /></td></tr>
<tr class="separator:a107ce66dee55f7066e73d5797be490cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a196bae7e30dffa1e83db9976ef8e0109"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a196bae7e30dffa1e83db9976ef8e0109"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a196bae7e30dffa1e83db9976ef8e0109">add_k_point_contribution_dm</a> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a> *kp__, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 4 &gt; &amp;density_matrix__)</td></tr>
<tr class="memdesc:a196bae7e30dffa1e83db9976ef8e0109"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add k-point contribution to the density matrix in the canonical form.  <a href="#a196bae7e30dffa1e83db9976ef8e0109">More...</a><br /></td></tr>
<tr class="separator:a196bae7e30dffa1e83db9976ef8e0109"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7494a6071dc9a5ace4d812abb3eedfdd"><td class="memItemLeft" align="right" valign="top"><a id="a7494a6071dc9a5ace4d812abb3eedfdd"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a7494a6071dc9a5ace4d812abb3eedfdd">add_k_point_contribution_rg</a> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a> *kp__)</td></tr>
<tr class="memdesc:a7494a6071dc9a5ace4d812abb3eedfdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add k-point contribution to the density and magnetization defined on the regular FFT grid. <br /></td></tr>
<tr class="separator:a7494a6071dc9a5ace4d812abb3eedfdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca7bdf85719124fbf559a7f7ab21173e"><td class="memItemLeft" align="right" valign="top"><a id="aca7bdf85719124fbf559a7f7ab21173e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#aca7bdf85719124fbf559a7f7ab21173e">generate_valence_mt</a> ()</td></tr>
<tr class="memdesc:aca7bdf85719124fbf559a7f7ab21173e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate valence density in the muffin-tins. <br /></td></tr>
<tr class="separator:aca7bdf85719124fbf559a7f7ab21173e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e9f97560b07fd662011b3f623025b26"><td class="memItemLeft" align="right" valign="top"><a id="a4e9f97560b07fd662011b3f623025b26"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a4e9f97560b07fd662011b3f623025b26">generate_core_charge_density</a> ()</td></tr>
<tr class="memdesc:a4e9f97560b07fd662011b3f623025b26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate charge density of core states. <br /></td></tr>
<tr class="separator:a4e9f97560b07fd662011b3f623025b26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ece62d577aecebbfd881af0ab33e6eb"><td class="memItemLeft" align="right" valign="top"><a id="a8ece62d577aecebbfd881af0ab33e6eb"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>generate_pseudo_core_charge_density</b> ()</td></tr>
<tr class="separator:a8ece62d577aecebbfd881af0ab33e6eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a3211e17c9026accf293bdef96b96edcb"><td class="memItemLeft" align="right" valign="top"><a id="a3211e17c9026accf293bdef96b96edcb"></a>
<a class="el" href="../../d6/dd1/classsirius_1_1_unit__cell.html">Unit_cell</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a3211e17c9026accf293bdef96b96edcb">unit_cell_</a></td></tr>
<tr class="memdesc:a3211e17c9026accf293bdef96b96edcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alias to ctx_.unit_cell() <br /></td></tr>
<tr class="separator:a3211e17c9026accf293bdef96b96edcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae98b9da0334e70ab463a59ed0afe75d"><td class="memItemLeft" align="right" valign="top"><a id="aae98b9da0334e70ab463a59ed0afe75d"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 4 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#aae98b9da0334e70ab463a59ed0afe75d">density_matrix_</a></td></tr>
<tr class="memdesc:aae98b9da0334e70ab463a59ed0afe75d"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d7/d05/classsirius_1_1_density.html" title="Generate charge density and magnetization from occupied spinor wave-functions.">Density</a> matrix for all atoms. <br /></td></tr>
<tr class="separator:aae98b9da0334e70ab463a59ed0afe75d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34b9631d36848183f8cf280544449dd1"><td class="memItemLeft" align="right" valign="top"><a id="a34b9631d36848183f8cf280544449dd1"></a>
std::vector&lt; <a class="el" href="../../d2/d97/structsirius_1_1_density_1_1paw__density__data__t.html">paw_density_data_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>paw_density_data_</b></td></tr>
<tr class="separator:a34b9631d36848183f8cf280544449dd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9d2944c3a36c3f5c8dde800848bcf1e"><td class="memItemLeft" align="right" valign="top">std::array&lt; std::unique_ptr&lt; <a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; &gt;, 4 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ae9d2944c3a36c3f5c8dde800848bcf1e">rho_mag_coarse_</a></td></tr>
<tr class="memdesc:ae9d2944c3a36c3f5c8dde800848bcf1e"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d7/d05/classsirius_1_1_density.html" title="Generate charge density and magnetization from occupied spinor wave-functions.">Density</a> and magnetization on the coarse FFT mesh.  <a href="#ae9d2944c3a36c3f5c8dde800848bcf1e">More...</a><br /></td></tr>
<tr class="separator:ae9d2944c3a36c3f5c8dde800848bcf1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad12b8d4968f7b6076280141f1cabb4b5"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ad12b8d4968f7b6076280141f1cabb4b5">rho_pseudo_core_</a> {nullptr}</td></tr>
<tr class="memdesc:ad12b8d4968f7b6076280141f1cabb4b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to pseudo core charge density.  <a href="#ad12b8d4968f7b6076280141f1cabb4b5">More...</a><br /></td></tr>
<tr class="separator:ad12b8d4968f7b6076280141f1cabb4b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acee7a0147e974ac60cedc82d903f70d4"><td class="memItemLeft" align="right" valign="top"><a id="acee7a0147e974ac60cedc82d903f70d4"></a>
std::unique_ptr&lt; <a class="el" href="../../de/dfd/classsirius_1_1_gaunt__coefficients.html">Gaunt_coefficients</a>&lt; double_complex &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#acee7a0147e974ac60cedc82d903f70d4">gaunt_coefs_</a> {nullptr}</td></tr>
<tr class="memdesc:acee7a0147e974ac60cedc82d903f70d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non-zero Gaunt coefficients. <br /></td></tr>
<tr class="separator:acee7a0147e974ac60cedc82d903f70d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade06e0d3019316f0cf544a5bc2303776"><td class="memItemLeft" align="right" valign="top"><a id="ade06e0d3019316f0cf544a5bc2303776"></a>
std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ade06e0d3019316f0cf544a5bc2303776">l_by_lm_</a></td></tr>
<tr class="memdesc:ade06e0d3019316f0cf544a5bc2303776"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fast mapping between composite lm index and corresponding orbital quantum number. <br /></td></tr>
<tr class="separator:ade06e0d3019316f0cf544a5bc2303776"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3997726eef6fbde2d91516c0a35b01e1"><td class="memItemLeft" align="right" valign="top"><a id="a3997726eef6fbde2d91516c0a35b01e1"></a>
std::unique_ptr&lt; <a class="el" href="../../d1/d76/classsirius_1_1_mixer.html">Mixer</a>&lt; double_complex &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a3997726eef6fbde2d91516c0a35b01e1">mixer_</a> {nullptr}</td></tr>
<tr class="memdesc:a3997726eef6fbde2d91516c0a35b01e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Low-frequency mixer for the pseudopotential density mixing. <br /></td></tr>
<tr class="separator:a3997726eef6fbde2d91516c0a35b01e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27d424e929337cf8fdf62ac38cba0ad5"><td class="memItemLeft" align="right" valign="top"><a id="a27d424e929337cf8fdf62ac38cba0ad5"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a27d424e929337cf8fdf62ac38cba0ad5">gvec_mixer_weights_</a></td></tr>
<tr class="memdesc:a27d424e929337cf8fdf62ac38cba0ad5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Weights of G-vectors for the mixer. <br /></td></tr>
<tr class="separator:a27d424e929337cf8fdf62ac38cba0ad5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classsirius_1_1_field4_d"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classsirius_1_1_field4_d')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html">sirius::Field4D</a></td></tr>
<tr class="memitem:a7f248a9f9365c8311c0cb266ec4429ba inherit pro_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a7f248a9f9365c8311c0cb266ec4429ba"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>symmetrize</b> (<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *f__, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *gz__, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *gx__, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *gy__)</td></tr>
<tr class="separator:a7f248a9f9365c8311c0cb266ec4429ba inherit pro_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classsirius_1_1_field4_d"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classsirius_1_1_field4_d')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html">sirius::Field4D</a></td></tr>
<tr class="memitem:a7feb66284564598af275959d77e2c10b inherit pro_attribs_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a7feb66284564598af275959d77e2c10b"></a>
<a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>ctx_</b></td></tr>
<tr class="separator:a7feb66284564598af275959d77e2c10b inherit pro_attribs_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Generate charge density and magnetization from occupied spinor wave-functions. </p>
<p>Let's start from the definition of the complex density matrix: </p><p class="formulaDsp">
\[ \rho_{\sigma&#39; \sigma}({\bf r}) = \sum_{j{\bf k}} n_{j{\bf k}} \Psi_{j{\bf k}}^{\sigma*}({\bf r}) \Psi_{j{\bf k}}^{\sigma&#39;}({\bf r}) = \frac{1}{2} \left( \begin{array}{cc} \rho({\bf r})+m_z({\bf r}) &amp; m_x({\bf r})-im_y({\bf r}) \\ m_x({\bf r})+im_y({\bf r}) &amp; \rho({\bf r})-m_z({\bf r}) \end{array} \right) \]
</p>
<p> We notice that the diagonal components of the density matrix are actually real and the off-diagonal components are expressed trough two independent functions \( m_x({\bf r}) \) and \( m_y({\bf r}) \). Having this in mind we will work with a slightly different object, namely a real density matrix, defined as a 1-, 2- or 4-dimensional (depending on the number of magnetic components) vector with the following elements:</p><ul>
<li>\( [ \rho({\bf r}) ] \) in case of non-magnetic configuration</li>
<li>\( [ \rho_{\uparrow \uparrow}({\bf r}), \rho_{\downarrow \downarrow}({\bf r}) ] = [ \frac{\rho({\bf r})+m_z({\bf r})}{2}, \frac{\rho({\bf r})-m_z({\bf r})}{2} ] \) in case of collinear magnetic configuration</li>
<li>\( [ \rho_{\uparrow \uparrow}({\bf r}), \rho_{\downarrow \downarrow}({\bf r}), 2 \Re \rho_{\uparrow \downarrow}({\bf r}), -2 \Im \rho_{\uparrow \downarrow}({\bf r}) ] = [ \frac{\rho({\bf r})+m_z({\bf r})}{2}, \frac{\rho({\bf r})-m_z({\bf r})}{2}, m_x({\bf r}), m_y({\bf r}) ] \) in the general case of non-collinear magnetic configuration</li>
</ul>
<p>At this point it is straightforward to compute the density and magnetization in the interstitial (see <a class="el" href="../../d7/d05/classsirius_1_1_density.html#a7494a6071dc9a5ace4d812abb3eedfdd" title="Add k-point contribution to the density and magnetization defined on the regular FFT grid.">add_k_point_contribution_rg()</a>). The muffin-tin part of the density and magnetization is obtained in a slighlty more complicated way. Recall the expansion of spinor wave-functions inside the muffin-tin \( \alpha \) </p><p class="formulaDsp">
\[ \Psi_{j{\bf k}}^{\sigma}({\bf r}) = \sum_{\xi}^{N_{\xi}^{\alpha}} {S_{\xi}^{\sigma j {\bf k},\alpha}} f_{\ell_{\xi} \lambda_{\xi}}^{\alpha}(r)Y_{\ell_{\xi}m_{\xi}}(\hat {\bf r}) \]
</p>
<p> which we insert into expression for the complex density matrix: </p><p class="formulaDsp">
\[ \rho_{\sigma&#39; \sigma}({\bf r}) = \sum_{j{\bf k}} n_{j{\bf k}} \sum_{\xi}^{N_{\xi}^{\alpha}} S_{\xi}^{\sigma j {\bf k},\alpha*} f_{\ell_{\xi} \lambda_{\xi}}^{\alpha}(r) Y_{\ell_{\xi}m_{\xi}}^{*}(\hat {\bf r}) \sum_{\xi&#39;}^{N_{\xi&#39;}^{\alpha}} S_{\xi&#39;}^{\sigma&#39; j{\bf k},\alpha} f_{\ell_{\xi&#39;} \lambda_{\xi&#39;}}^{\alpha}(r)Y_{\ell_{\xi&#39;}m_{\xi&#39;}}(\hat {\bf r}) \]
</p>
<p> First, we eliminate a sum over bands and k-points by forming an auxiliary density tensor: </p><p class="formulaDsp">
\[ D_{\xi \sigma, \xi&#39; \sigma&#39;}^{\alpha} = \sum_{j{\bf k}} n_{j{\bf k}} S_{\xi}^{\sigma j {\bf k},\alpha*} S_{\xi&#39;}^{\sigma&#39; j {\bf k},\alpha} \]
</p>
<p> The expression for complex density matrix simplifies to: </p><p class="formulaDsp">
\[ \rho_{\sigma&#39; \sigma}({\bf r}) = \sum_{\xi \xi&#39;} D_{\xi \sigma, \xi&#39; \sigma&#39;}^{\alpha} f_{\ell_{\xi} \lambda_{\xi}}^{\alpha}(r)Y_{\ell_{\xi}m_{\xi}}^{*}(\hat {\bf r}) f_{\ell_{\xi&#39;} \lambda_{\xi&#39;}}^{\alpha}(r)Y_{\ell_{\xi&#39;}m_{\xi&#39;}}(\hat {\bf r}) \]
</p>
<p> Now we can switch to the real density matrix and write its' expansion in real spherical harmonics. Let's take non-magnetic case as an example: </p><p class="formulaDsp">
\[ \rho({\bf r}) = \sum_{\xi \xi&#39;} D_{\xi \xi&#39;}^{\alpha} f_{\ell_{\xi} \lambda_{\xi}}^{\alpha}(r)Y_{\ell_{\xi}m_{\xi}}^{*}(\hat {\bf r}) f_{\ell_{\xi&#39;} \lambda_{\xi&#39;}}^{\alpha}(r)Y_{\ell_{\xi&#39;}m_{\xi&#39;}}(\hat {\bf r}) = \sum_{\ell_3 m_3} \rho_{\ell_3 m_3}^{\alpha}(r) R_{\ell_3 m_3}(\hat {\bf r}) \]
</p>
<p> where </p><p class="formulaDsp">
\[ \rho_{\ell_3 m_3}^{\alpha}(r) = \sum_{\xi \xi&#39;} D_{\xi \xi&#39;}^{\alpha} f_{\ell_{\xi} \lambda_{\xi}}^{\alpha}(r) f_{\ell_{\xi&#39;} \lambda_{\xi&#39;}}^{\alpha}(r) \langle Y_{\ell_{\xi}m_{\xi}} | R_{\ell_3 m_3} | Y_{\ell_{\xi&#39;}m_{\xi&#39;}} \rangle \]
</p>
<p> We are almost done. Now it is time to switch to the full index notation \( \xi \rightarrow \{ \ell \lambda m \} \) and sum over <em>m</em> and <em>m'</em> indices: </p><p class="formulaDsp">
\[ \rho_{\ell_3 m_3}^{\alpha}(r) = \sum_{\ell \lambda, \ell&#39; \lambda&#39;} f_{\ell \lambda}^{\alpha}(r) f_{\ell&#39; \lambda&#39;}^{\alpha}(r) d_{\ell \lambda, \ell&#39; \lambda&#39;, \ell_3 m_3}^{\alpha} \]
</p>
<p> where </p><p class="formulaDsp">
\[ d_{\ell \lambda, \ell&#39; \lambda&#39;, \ell_3 m_3}^{\alpha} = \sum_{mm&#39;} D_{\ell \lambda m, \ell&#39; \lambda&#39; m&#39;}^{\alpha} \langle Y_{\ell m} | R_{\ell_3 m_3} | Y_{\ell&#39; m&#39;} \rangle \]
</p>
<p> This is our final answer: radial components of density and magnetization are expressed as a linear combination of quadratic forms in radial functions.</p>
<dl class="section note"><dt>Note</dt><dd>density and potential are allocated as global function because it's easier to load and save them. </dd>
<dd>
In case of full-potential calculation valence + core electron charge density is computed. </dd>
<dd>
In tcase of pseudopotential valence charge density is computed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00152">152</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a107ce66dee55f7066e73d5797be490cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a107ce66dee55f7066e73d5797be490cd">&#9670;&nbsp;</a></span>reduce_density_matrix()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int num_mag_dims&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::reduce_density_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d37/classsirius_1_1_atom__type.html">Atom_type</a> const &amp;&#160;</td>
          <td class="paramname"><em>atom_type__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ia__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 4 &gt; const &amp;&#160;</td>
          <td class="paramname"><em>zdens__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/dfd/classsirius_1_1_gaunt__coefficients.html">Gaunt_coefficients</a>&lt; double_complex &gt; const &amp;&#160;</td>
          <td class="paramname"><em>gaunt_coeffs__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>mt_density_matrix__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reduce complex density matrix over magnetic quantum numbers. </p>
<p>The following operation is performed: </p><p class="formulaDsp">
\[ n_{\ell \lambda, \ell&#39; \lambda&#39;, \ell_3 m_3}^{\alpha} = \sum_{mm&#39;} D_{\ell \lambda m, \ell&#39; \lambda&#39; m&#39;}^{\alpha} \langle Y_{\ell m} | R_{\ell_3 m_3} | Y_{\ell&#39; m&#39;} \rangle \]
</p>
 
<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01414">1414</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a196bae7e30dffa1e83db9976ef8e0109"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a196bae7e30dffa1e83db9976ef8e0109">&#9670;&nbsp;</a></span>add_k_point_contribution_dm()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::add_k_point_contribution_dm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a> *&#160;</td>
          <td class="paramname"><em>kp__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 4 &gt; &amp;&#160;</td>
          <td class="paramname"><em>density_matrix__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add k-point contribution to the density matrix in the canonical form. </p>
<p>In case of full-potential LAPW complex density matrix has the following expression: </p><p class="formulaDsp">
\[ d_{\xi \sigma, \xi&#39; \sigma&#39;}^{\alpha} = \sum_{j{\bf k}} n_{j{\bf k}} S_{\xi}^{\sigma j {\bf k},\alpha*} S_{\xi&#39;}^{\sigma&#39; j {\bf k},\alpha} \]
</p>
<p>where \( S_{\xi}^{\sigma j {\bf k},\alpha} \) are the expansion coefficients of spinor wave functions inside muffin-tin spheres.</p>
<p>In case of LDA+U the occupation matrix is also computed. It has the following expression: </p><p class="formulaDsp">
\[ n_{\ell,mm&#39;}^{\sigma \sigma&#39;} = \sum_{i {\bf k}}^{occ} \int_{0}^{R_{MT}} r^2 dr \Psi_{\ell m}^{i{\bf k}\sigma *}({\bf r}) \Psi_{\ell m&#39;}^{i{\bf k}\sigma&#39;}({\bf r}) \]
</p>
<p>In case of ultrasoft pseudopotential the following density matrix has to be computed for each atom: </p><p class="formulaDsp">
\[ d_{\xi \xi&#39;}^{\alpha} = \langle \beta_{\xi}^{\alpha} | \hat N | \beta_{\xi&#39;}^{\alpha} \rangle = \sum_{j {\bf k}} \langle \beta_{\xi}^{\alpha} | \Psi_{j{\bf k}} \rangle n_{j{\bf k}} \langle \Psi_{j{\bf k}} | \beta_{\xi&#39;}^{\alpha} \rangle \]
</p>
<p> Here \( \hat N = \sum_{j{\bf k}} | \Psi_{j{\bf k}} \rangle n_{j{\bf k}} \langle \Psi_{j{\bf k}} | \) is the occupancy operator written in spectral representation. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l00746">746</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a7cb3a45fa14f4d5e59d1ef6b69c7d624"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cb3a45fa14f4d5e59d1ef6b69c7d624">&#9670;&nbsp;</a></span>generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::generate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/dbd/classsirius_1_1_k__point__set.html">K_point_set</a> const &amp;&#160;</td>
          <td class="paramname"><em>ks__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>add_core__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>transform_to_rg__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate full charge density (valence + core) and magnetization from the wave functions. </p>
<p>This function calls <a class="el" href="../../d7/d05/classsirius_1_1_density.html#ab7ca673d53b416e8ebbe12b29272911f" title="Generate valence charge density and magnetization from the wave functions.">generate_valence()</a> and then in case of full-potential LAPW method adds a core density to get the full charge density of the system. <a class="el" href="../../d7/d05/classsirius_1_1_density.html" title="Generate charge density and magnetization from occupied spinor wave-functions.">Density</a> is generated in spectral representation, i.e. plane-wave coefficients in the interstitial and spherical harmonic components in the muffin-tins. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01048">1048</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="ab7ca673d53b416e8ebbe12b29272911f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7ca673d53b416e8ebbe12b29272911f">&#9670;&nbsp;</a></span>generate_valence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::generate_valence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/dbd/classsirius_1_1_k__point__set.html">K_point_set</a> const &amp;&#160;</td>
          <td class="paramname"><em>ks__</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate valence charge density and magnetization from the wave functions. </p>
<p>The interstitial density is generated on the coarse FFT grid and then transformed to the PW domain. After symmetrization and mixing and before the generation of the XC potential density is transformted to the real-space domain and checked for the number of electrons. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01111">1111</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a663a8c76c344c5983092ddb6bd31f56a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a663a8c76c344c5983092ddb6bd31f56a">&#9670;&nbsp;</a></span>augment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::augment </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add augmentation charge Q(r). </p>
<p>Restore valence density by adding the Q-operator constribution. The following term is added to the valence density, generated by the pseudo wave-functions: </p><p class="formulaDsp">
\[ \tilde \rho({\bf G}) = \sum_{\alpha} \sum_{\xi \xi&#39;} d_{\xi \xi&#39;}^{\alpha} Q_{\xi&#39; \xi}^{\alpha}({\bf G}) \]
</p>
<p> Plane-wave coefficients of the Q-operator for a given atom \( \alpha \) can be obtained from the corresponding coefficients of the Q-operator for a given atom <em>type</em> A: </p><p class="formulaDsp">
\[ Q_{\xi&#39; \xi}^{\alpha(A)}({\bf G}) = e^{-i{\bf G}\tau_{\alpha(A)}} Q_{\xi&#39; \xi}^{A}({\bf G}) \]
</p>
<p> We use this property to split the sum over atoms into sum over atom types and inner sum over atoms of the same type: </p><p class="formulaDsp">
\[ \tilde \rho({\bf G}) = \sum_{A} \sum_{\xi \xi&#39;} Q_{\xi&#39; \xi}^{A}({\bf G}) \sum_{\alpha(A)} d_{\xi \xi&#39;}^{\alpha(A)} e^{-i{\bf G}\tau_{\alpha(A)}} = \sum_{A} \sum_{\xi \xi&#39;} Q_{\xi&#39; \xi}^{A}({\bf G}) d_{\xi \xi&#39;}^{A}({\bf G}) \]
</p>
<p> where </p><p class="formulaDsp">
\[ d_{\xi \xi&#39;}^{A}({\bf G}) = \sum_{\alpha(A)} d_{\xi \xi&#39;}^{\alpha(A)} e^{-i{\bf G}\tau_{\alpha(A)}} \]
</p>
 
<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01079">1079</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a961ccdca6c2653f8755b47c747f2720f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a961ccdca6c2653f8755b47c747f2720f">&#9670;&nbsp;</a></span>get_magnetisation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::tuple&lt; std::array&lt; double, 3 &gt;, std::array&lt; double, 3 &gt;, std::vector&lt; std::array&lt; double, 3 &gt; &gt; &gt; sirius::Density::get_magnetisation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get total magnetization and also contributions from interstitial and muffin-tin parts. </p>
<p>In case of PP-PW there are no real muffin-tins. Instead, a value of magnetization inside atomic sphere with some chosen radius is returned. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01677">1677</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a5aa2c64b50733841e1508208a242ee87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aa2c64b50733841e1508208a242ee87">&#9670;&nbsp;</a></span>symmetrize_density_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::symmetrize_density_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Symmetrize density matrix. </p>
<p>Initially, density matrix is obtained with summation over irreducible BZ: </p><p class="formulaDsp">
\[ \tilde n_{\ell \lambda m \sigma, \ell&#39; \lambda&#39; m&#39; \sigma&#39;}^{\alpha} = \sum_{j} \sum_{{\bf k}}^{IBZ} \langle Y_{\ell m} u_{\ell \lambda}^{\alpha}| \Psi_{j{\bf k}}^{\sigma} \rangle w_{\bf k} n_{j{\bf k}} \langle \Psi_{j{\bf k}}^{\sigma&#39;} | u_{\ell&#39; \lambda&#39;}^{\alpha} Y_{\ell&#39; m&#39;} \rangle \]
</p>
<p> In order to symmetrize it, the following operation is performed: </p><p class="formulaDsp">
\[ n_{\ell \lambda m \sigma, \ell&#39; \lambda&#39; m&#39; \sigma&#39;}^{\alpha} = \sum_{{\bf P}} \sum_{j} \sum_{\bf k}^{IBZ} \langle Y_{\ell m} u_{\ell \lambda}^{\alpha}| \Psi_{j{\bf P}{\bf k}}^{\sigma} \rangle w_{\bf k} n_{j{\bf k}} \langle \Psi_{j{\bf P}{\bf k}}^{\sigma&#39;} | u_{\ell&#39; \lambda&#39;}^{\alpha} Y_{\ell&#39; m&#39;} \rangle \]
</p>
<p> where \( {\bf P} \) is the space-group symmetry operation. The inner product between wave-function and local orbital is transformed as: </p><p class="formulaDsp">
\[ \langle \Psi_{j{\bf P}{\bf k}}^{\sigma} | u_{\ell \lambda}^{\alpha} Y_{\ell m} \rangle = \int \Psi_{j{\bf P}{\bf k}}^{\sigma *}({\bf r}) u_{\ell \lambda}^{\alpha}(r) Y_{\ell m}(\hat {\bf r}) dr = \int \Psi_{j{\bf k}}^{\sigma *}({\bf P}^{-1}{\bf r}) u_{\ell \lambda}^{\alpha}(r) Y_{\ell m}(\hat {\bf r}) dr = \int \Psi_{j{\bf k}}^{\sigma *}({\bf r}) u_{\ell \lambda}^{{\bf P}\alpha}(r) Y_{\ell m}({\bf P} \hat{\bf r}) dr \]
</p>
<p> Under rotation the spherical harmonic is transformed as: </p><p class="formulaDsp">
\[ Y_{\ell m}({\bf P} \hat{\bf r}) = {\bf P}^{-1}Y_{\ell m}(\hat {\bf r}) = \sum_{m&#39;} D_{m&#39;m}^{\ell}({\bf P}^{-1}) Y_{\ell m&#39;}(\hat {\bf r}) = \sum_{m&#39;} D_{mm&#39;}^{\ell}({\bf P}) Y_{\ell m&#39;}(\hat {\bf r}) \]
</p>
<p> The inner-product integral is then rewritten as: </p><p class="formulaDsp">
\[ \langle \Psi_{j{\bf P}{\bf k}}^{\sigma} | u_{\ell \lambda}^{\alpha} Y_{\ell m} \rangle = \sum_{m&#39;} D_{mm&#39;}^{\ell}({\bf P}) \langle \Psi_{j{\bf k}}^{\sigma} | u_{\ell \lambda}^{{\bf P}\alpha} Y_{\ell m} \rangle \]
</p>
<p> and the final expression for density matrix gets the following form: </p><p class="formulaDsp">
\[ n_{\ell \lambda m \sigma, \ell&#39; \lambda&#39; m&#39; \sigma&#39;}^{\alpha} = \sum_{{\bf P}} \sum_{j} \sum_{\bf k}^{IBZ} \sum_{m_1 m_2} D_{mm_1}^{\ell *}({\bf P}) D_{m&#39;m_2}^{\ell&#39;}({\bf P}) \langle Y_{\ell m_1} u_{\ell \lambda}^{{\bf P} \alpha}| \Psi_{j{\bf k}}^{\sigma} \rangle w_{\bf k} n_{j{\bf k}} \langle \Psi_{j{\bf k}}^{\sigma&#39;} | u_{\ell&#39; \lambda&#39;}^{{\bf P}\alpha} Y_{\ell&#39; m_2} \rangle = \sum_{{\bf P}} \sum_{m_1 m_2} D_{mm_1}^{\ell *}({\bf P}) D_{m&#39;m_2}^{\ell&#39;}({\bf P}) \tilde n_{\ell \lambda m_1 \sigma, \ell&#39; \lambda&#39; m_2 \sigma&#39;}^{{\bf P}\alpha} \]
</p>
 
<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01591">1591</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ae9d2944c3a36c3f5c8dde800848bcf1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9d2944c3a36c3f5c8dde800848bcf1e">&#9670;&nbsp;</a></span>rho_mag_coarse_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::array&lt;std::unique_ptr&lt;<a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt;double&gt; &gt;, 4&gt; sirius::Density::rho_mag_coarse_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="../../d7/d05/classsirius_1_1_density.html" title="Generate charge density and magnetization from occupied spinor wave-functions.">Density</a> and magnetization on the coarse FFT mesh. </p>
<p>Coarse FFT grid is enough to generate density and magnetization from the wave-functions. The components of the <code>rho_mag_coarse</code> vector have the following order: \( \{\rho({\bf r}), m_z({\bf r}), m_x({\bf r}), m_y({\bf r}) \} \). </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00178">178</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="ad12b8d4968f7b6076280141f1cabb4b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad12b8d4968f7b6076280141f1cabb4b5">&#9670;&nbsp;</a></span>rho_pseudo_core_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt;double&gt; &gt; sirius::Density::rho_pseudo_core_ {nullptr}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to pseudo core charge density. </p>
<p>In the case of pseudopotential we need to know the non-linear core correction to the exchange-correlation energy which is introduced trough the pseudo core density: \( E_{xc}[\rho_{val} + \rho_{core}] \). The 'pseudo' reflects the fact that this density integrated does not reproduce the total number of core elctrons. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00185">185</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a></li>
<li><a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 4 2019 11:48:44 for SIRIUS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
