<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SIRIUS: sirius::Density Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SIRIUS<span id="projectnumber">&#160;7.3.1</span>
   </div>
   <div id="projectbrief">Electronic structure library and applications</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d5/def/namespacesirius.html">sirius</a></li><li class="navelem"><a class="el" href="../../d7/d05/classsirius_1_1_density.html">Density</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d5/dd6/classsirius_1_1_density-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">sirius::Density Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Generate charge density and magnetization from occupied spinor wave-functions.  
 <a href="../../d7/d05/classsirius_1_1_density.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for sirius::Density:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d6/d14/classsirius_1_1_density__inherit__graph.svg" width="118" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for sirius::Density:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../df/d7f/classsirius_1_1_density__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7dca6937cc2b1e865f1d77edfc575906"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a7dca6937cc2b1e865f1d77edfc575906">Density</a> (<a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;ctx__)</td></tr>
<tr class="memdesc:a7dca6937cc2b1e865f1d77edfc575906"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="../../d7/d05/classsirius_1_1_density.html#a7dca6937cc2b1e865f1d77edfc575906">More...</a><br /></td></tr>
<tr class="separator:a7dca6937cc2b1e865f1d77edfc575906"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a370e60a8667fcad8fb3a0fe945a4ac72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a370e60a8667fcad8fb3a0fe945a4ac72">update</a> ()</td></tr>
<tr class="memdesc:a370e60a8667fcad8fb3a0fe945a4ac72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update internal parameters after a change of lattice vectors or atomic coordinates.  <a href="../../d7/d05/classsirius_1_1_density.html#a370e60a8667fcad8fb3a0fe945a4ac72">More...</a><br /></td></tr>
<tr class="separator:a370e60a8667fcad8fb3a0fe945a4ac72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1060ccda46864cd753bd9b38a288a681"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a1060ccda46864cd753bd9b38a288a681">core_leakage</a> () const</td></tr>
<tr class="memdesc:a1060ccda46864cd753bd9b38a288a681"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the total leakage of the core states out of the muffin-tins.  <a href="../../d7/d05/classsirius_1_1_density.html#a1060ccda46864cd753bd9b38a288a681">More...</a><br /></td></tr>
<tr class="separator:a1060ccda46864cd753bd9b38a288a681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abea8fcd04749747c5abba5185420f413"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#abea8fcd04749747c5abba5185420f413">initial_density</a> ()</td></tr>
<tr class="memdesc:abea8fcd04749747c5abba5185420f413"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate initial charge density and magnetization.  <a href="../../d7/d05/classsirius_1_1_density.html#abea8fcd04749747c5abba5185420f413">More...</a><br /></td></tr>
<tr class="separator:abea8fcd04749747c5abba5185420f413"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45356dcd88effd130b03724827ba427"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ae45356dcd88effd130b03724827ba427">initial_density_pseudo</a> ()</td></tr>
<tr class="separator:ae45356dcd88effd130b03724827ba427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2df9c61b1173bd89987926b3d249b94e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a2df9c61b1173bd89987926b3d249b94e">initial_density_full_pot</a> ()</td></tr>
<tr class="separator:a2df9c61b1173bd89987926b3d249b94e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a644b3aa48c4ec61bc9ac33c3c7b6f435"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a644b3aa48c4ec61bc9ac33c3c7b6f435">normalize</a> ()</td></tr>
<tr class="separator:a644b3aa48c4ec61bc9ac33c3c7b6f435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e938e2bbeaa45fc8bd31f2428eefe45"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a6e938e2bbeaa45fc8bd31f2428eefe45">check_num_electrons</a> () const</td></tr>
<tr class="memdesc:a6e938e2bbeaa45fc8bd31f2428eefe45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check total density for the correct number of electrons.  <a href="../../d7/d05/classsirius_1_1_density.html#a6e938e2bbeaa45fc8bd31f2428eefe45">More...</a><br /></td></tr>
<tr class="separator:a6e938e2bbeaa45fc8bd31f2428eefe45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af63db5d72dc92a562ce3acc9838f6dfe"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:af63db5d72dc92a562ce3acc9838f6dfe"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#af63db5d72dc92a562ce3acc9838f6dfe">generate</a> (<a class="el" href="../../d9/dbd/classsirius_1_1_k__point__set.html">K_point_set</a> const &amp;ks__, bool symmetrize__, bool add_core__, bool transform_to_rg__)</td></tr>
<tr class="memdesc:af63db5d72dc92a562ce3acc9838f6dfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate full charge density (valence + core) and magnetization from the wave functions.  <a href="../../d7/d05/classsirius_1_1_density.html#af63db5d72dc92a562ce3acc9838f6dfe">More...</a><br /></td></tr>
<tr class="separator:af63db5d72dc92a562ce3acc9838f6dfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee7ff2d2a8d755561d3f50bff9dc0d57"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:aee7ff2d2a8d755561d3f50bff9dc0d57"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#aee7ff2d2a8d755561d3f50bff9dc0d57">generate_valence</a> (<a class="el" href="../../d9/dbd/classsirius_1_1_k__point__set.html">K_point_set</a> const &amp;ks__)</td></tr>
<tr class="memdesc:aee7ff2d2a8d755561d3f50bff9dc0d57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate valence charge density and magnetization from the wave functions.  <a href="../../d7/d05/classsirius_1_1_density.html#aee7ff2d2a8d755561d3f50bff9dc0d57">More...</a><br /></td></tr>
<tr class="separator:aee7ff2d2a8d755561d3f50bff9dc0d57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a663a8c76c344c5983092ddb6bd31f56a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a663a8c76c344c5983092ddb6bd31f56a">augment</a> ()</td></tr>
<tr class="memdesc:a663a8c76c344c5983092ddb6bd31f56a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add augmentation charge Q(r).  <a href="../../d7/d05/classsirius_1_1_density.html#a663a8c76c344c5983092ddb6bd31f56a">More...</a><br /></td></tr>
<tr class="separator:a663a8c76c344c5983092ddb6bd31f56a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a83f9d0a1a26330f181ebaf853644b3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a8a83f9d0a1a26330f181ebaf853644b3">generate_rho_aug</a> ()</td></tr>
<tr class="memdesc:a8a83f9d0a1a26330f181ebaf853644b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate augmentation charge density.  <a href="../../d7/d05/classsirius_1_1_density.html#a8a83f9d0a1a26330f181ebaf853644b3">More...</a><br /></td></tr>
<tr class="separator:a8a83f9d0a1a26330f181ebaf853644b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba49bccd299f66e8673c5930c46f2972"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#aba49bccd299f66e8673c5930c46f2972">check_density_continuity_at_mt</a> ()</td></tr>
<tr class="memdesc:aba49bccd299f66e8673c5930c46f2972"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check density at MT boundary.  <a href="../../d7/d05/classsirius_1_1_density.html#aba49bccd299f66e8673c5930c46f2972">More...</a><br /></td></tr>
<tr class="separator:aba49bccd299f66e8673c5930c46f2972"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a349e10ada5b6fbb5e8b9d5206aba765c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a349e10ada5b6fbb5e8b9d5206aba765c">save</a> ()</td></tr>
<tr class="separator:a349e10ada5b6fbb5e8b9d5206aba765c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78ed4dc5b87a927570fe2e7552c548e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a78ed4dc5b87a927570fe2e7552c548e1">load</a> ()</td></tr>
<tr class="separator:a78ed4dc5b87a927570fe2e7552c548e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cea378baf2b5fab91d738d88d07842e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a5cea378baf2b5fab91d738d88d07842e">save_to_xsf</a> ()</td></tr>
<tr class="separator:a5cea378baf2b5fab91d738d88d07842e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79fabeb03c5e4cd4d44127a2696e13e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a79fabeb03c5e4cd4d44127a2696e13e7">save_to_ted</a> ()</td></tr>
<tr class="separator:a79fabeb03c5e4cd4d44127a2696e13e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2b76bcacc2db613be601b1484d078bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#af2b76bcacc2db613be601b1484d078bd">save_to_xdmf</a> ()</td></tr>
<tr class="separator:af2b76bcacc2db613be601b1484d078bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4982fd3e14b8f9f9ba2b3d4d26ae9775"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a4982fd3e14b8f9f9ba2b3d4d26ae9775">core_leakage</a> (int ic) const</td></tr>
<tr class="memdesc:a4982fd3e14b8f9f9ba2b3d4d26ae9775"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return core leakage for a specific atom symmetry class.  <a href="../../d7/d05/classsirius_1_1_density.html#a4982fd3e14b8f9f9ba2b3d4d26ae9775">More...</a><br /></td></tr>
<tr class="separator:a4982fd3e14b8f9f9ba2b3d4d26ae9775"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c91ca07e4e42b0dc28191eafbcae627"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a7c91ca07e4e42b0dc28191eafbcae627">rho</a> ()</td></tr>
<tr class="memdesc:a7c91ca07e4e42b0dc28191eafbcae627"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return charge density (scalar functions).  <a href="../../d7/d05/classsirius_1_1_density.html#a7c91ca07e4e42b0dc28191eafbcae627">More...</a><br /></td></tr>
<tr class="separator:a7c91ca07e4e42b0dc28191eafbcae627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c1441166ff824f0d85bac7e93e9bc8a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a4c1441166ff824f0d85bac7e93e9bc8a">rho</a> () const</td></tr>
<tr class="memdesc:a4c1441166ff824f0d85bac7e93e9bc8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return const reference to charge density (scalar functions).  <a href="../../d7/d05/classsirius_1_1_density.html#a4c1441166ff824f0d85bac7e93e9bc8a">More...</a><br /></td></tr>
<tr class="separator:a4c1441166ff824f0d85bac7e93e9bc8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec1134eb54d284eb76f4864ab90243c4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#aec1134eb54d284eb76f4864ab90243c4">rho_pseudo_core</a> ()</td></tr>
<tr class="separator:aec1134eb54d284eb76f4864ab90243c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0b314b7faf46fe2b94c7a3de33b75ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ad0b314b7faf46fe2b94c7a3de33b75ee">rho_pseudo_core</a> () const</td></tr>
<tr class="separator:ad0b314b7faf46fe2b94c7a3de33b75ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9b933d68bb2a38db3b9e8b9aec96544"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ae9b933d68bb2a38db3b9e8b9aec96544">magnetization</a> (int i)</td></tr>
<tr class="separator:ae9b933d68bb2a38db3b9e8b9aec96544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ff3f2c89dcbf2fe884c5d1721ec1904"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a4ff3f2c89dcbf2fe884c5d1721ec1904">magnetization</a> (int i) const</td></tr>
<tr class="separator:a4ff3f2c89dcbf2fe884c5d1721ec1904"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21fd6b83366a9d5db231ca71742c1a05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a21fd6b83366a9d5db231ca71742c1a05">density_mt</a> (int ialoc) const</td></tr>
<tr class="separator:a21fd6b83366a9d5db231ca71742c1a05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7904609f7a2d6f197ad1cb8cdef119a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#af7904609f7a2d6f197ad1cb8cdef119a">generate_paw_loc_density</a> ()</td></tr>
<tr class="memdesc:af7904609f7a2d6f197ad1cb8cdef119a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate \( n_1 \) and \( \tilde{n}_1 \) in lm components.  <a href="../../d7/d05/classsirius_1_1_density.html#af7904609f7a2d6f197ad1cb8cdef119a">More...</a><br /></td></tr>
<tr class="separator:af7904609f7a2d6f197ad1cb8cdef119a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3986db2add5c27ffee452b0d0bee332d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; const * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a3986db2add5c27ffee452b0d0bee332d">paw_ae_density</a> (int idx__) const</td></tr>
<tr class="memdesc:a3986db2add5c27ffee452b0d0bee332d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return list of pointers to all-electron PAW density function for a given local index of atom with PAW potential.  <a href="../../d7/d05/classsirius_1_1_density.html#a3986db2add5c27ffee452b0d0bee332d">More...</a><br /></td></tr>
<tr class="separator:a3986db2add5c27ffee452b0d0bee332d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e2d016668924f71f4a69cda9f6733db"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; const * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a5e2d016668924f71f4a69cda9f6733db">paw_ps_density</a> (int idx__) const</td></tr>
<tr class="memdesc:a5e2d016668924f71f4a69cda9f6733db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return list of pointers to pseudo PAW density function for a given local index of atom with PAW potential.  <a href="../../d7/d05/classsirius_1_1_density.html#a5e2d016668924f71f4a69cda9f6733db">More...</a><br /></td></tr>
<tr class="separator:a5e2d016668924f71f4a69cda9f6733db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac49bc0be91cfc0e1c6de821959ed2211"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ac49bc0be91cfc0e1c6de821959ed2211">mixer_input</a> ()</td></tr>
<tr class="separator:ac49bc0be91cfc0e1c6de821959ed2211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa98f530b6ca5ce2cff733bffb22d589d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#aa98f530b6ca5ce2cff733bffb22d589d">mixer_output</a> ()</td></tr>
<tr class="separator:aa98f530b6ca5ce2cff733bffb22d589d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32fa07e6992b98aa949c1245c3bd413e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a32fa07e6992b98aa949c1245c3bd413e">mixer_init</a> (<a class="el" href="../../dc/d5b/classsirius_1_1config__t_1_1mixer__t.html">config_t::mixer_t</a> const &amp;mixer_cfg__)</td></tr>
<tr class="memdesc:a32fa07e6992b98aa949c1245c3bd413e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize density mixer.  <a href="../../d7/d05/classsirius_1_1_density.html#a32fa07e6992b98aa949c1245c3bd413e">More...</a><br /></td></tr>
<tr class="separator:a32fa07e6992b98aa949c1245c3bd413e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a856614b00a6343e0d977e2b4e449f07f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a856614b00a6343e0d977e2b4e449f07f">mix</a> ()</td></tr>
<tr class="memdesc:a856614b00a6343e0d977e2b4e449f07f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mix new density.  <a href="../../d7/d05/classsirius_1_1_density.html#a856614b00a6343e0d977e2b4e449f07f">More...</a><br /></td></tr>
<tr class="separator:a856614b00a6343e0d977e2b4e449f07f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62b21528bd79291766f0fd1ba8f0bdf2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a62b21528bd79291766f0fd1ba8f0bdf2">density_matrix</a> () const</td></tr>
<tr class="separator:a62b21528bd79291766f0fd1ba8f0bdf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d08d209aabdaf32feb948c250d4b7d6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a2d08d209aabdaf32feb948c250d4b7d6">density_matrix</a> ()</td></tr>
<tr class="separator:a2d08d209aabdaf32feb948c250d4b7d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af14668b81c5fd18011d8d7d930941e9a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#af14668b81c5fd18011d8d7d930941e9a">density_matrix_aux</a> (<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; const &amp;dm__, int iat__) const</td></tr>
<tr class="memdesc:af14668b81c5fd18011d8d7d930941e9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return density matrix in auxiliary form.  <a href="../../d7/d05/classsirius_1_1_density.html#af14668b81c5fd18011d8d7d930941e9a">More...</a><br /></td></tr>
<tr class="separator:af14668b81c5fd18011d8d7d930941e9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5089752b2414fa4a16aa521b6731ab9e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a5089752b2414fa4a16aa521b6731ab9e">compute_atomic_mag_mom</a> () const</td></tr>
<tr class="memdesc:a5089752b2414fa4a16aa521b6731ab9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate approximate atomic magnetic moments in case of PP-PW.  <a href="../../d7/d05/classsirius_1_1_density.html#a5089752b2414fa4a16aa521b6731ab9e">More...</a><br /></td></tr>
<tr class="separator:a5089752b2414fa4a16aa521b6731ab9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a961ccdca6c2653f8755b47c747f2720f"><td class="memItemLeft" align="right" valign="top">std::tuple&lt; std::array&lt; double, 3 &gt;, std::array&lt; double, 3 &gt;, std::vector&lt; std::array&lt; double, 3 &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a961ccdca6c2653f8755b47c747f2720f">get_magnetisation</a> () const</td></tr>
<tr class="memdesc:a961ccdca6c2653f8755b47c747f2720f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total magnetization and also contributions from interstitial and muffin-tin parts.  <a href="../../d7/d05/classsirius_1_1_density.html#a961ccdca6c2653f8755b47c747f2720f">More...</a><br /></td></tr>
<tr class="separator:a961ccdca6c2653f8755b47c747f2720f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aa2c64b50733841e1508208a242ee87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a5aa2c64b50733841e1508208a242ee87">symmetrize_density_matrix</a> ()</td></tr>
<tr class="memdesc:a5aa2c64b50733841e1508208a242ee87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Symmetrize density matrix.  <a href="../../d7/d05/classsirius_1_1_density.html#a5aa2c64b50733841e1508208a242ee87">More...</a><br /></td></tr>
<tr class="separator:a5aa2c64b50733841e1508208a242ee87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af36505c03971740defb12068c0d92639"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#af36505c03971740defb12068c0d92639">print_info</a> () const</td></tr>
<tr class="separator:af36505c03971740defb12068c0d92639"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dace67a5b32b154cd247c7460422c32"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/dcc/classsirius_1_1_occupation__matrix.html">Occupation_matrix</a> const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a5dace67a5b32b154cd247c7460422c32">occupation_matrix</a> () const</td></tr>
<tr class="separator:a5dace67a5b32b154cd247c7460422c32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a573c6dc90ddc875c9d43ab3c322e3a34"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/dcc/classsirius_1_1_occupation__matrix.html">Occupation_matrix</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a573c6dc90ddc875c9d43ab3c322e3a34">occupation_matrix</a> ()</td></tr>
<tr class="separator:a573c6dc90ddc875c9d43ab3c322e3a34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classsirius_1_1_field4_d"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classsirius_1_1_field4_d')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html">sirius::Field4D</a></td></tr>
<tr class="memitem:a28b1083500ae2cbc7926bd95ce68418f inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#a28b1083500ae2cbc7926bd95ce68418f">Field4D</a> (<a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;ctx__, int lmmax__)</td></tr>
<tr class="separator:a28b1083500ae2cbc7926bd95ce68418f inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac46db987e3bce8d86a27d0ad567ea8a7 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#ac46db987e3bce8d86a27d0ad567ea8a7">scalar</a> ()</td></tr>
<tr class="memdesc:ac46db987e3bce8d86a27d0ad567ea8a7 inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return scalar part of the field.  <a href="../../d3/d1f/classsirius_1_1_field4_d.html#ac46db987e3bce8d86a27d0ad567ea8a7">More...</a><br /></td></tr>
<tr class="separator:ac46db987e3bce8d86a27d0ad567ea8a7 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3ab52194f408696d8d4866311f96ec1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#aa3ab52194f408696d8d4866311f96ec1">scalar</a> () const</td></tr>
<tr class="memdesc:aa3ab52194f408696d8d4866311f96ec1 inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return scalar part of the field.  <a href="../../d3/d1f/classsirius_1_1_field4_d.html#aa3ab52194f408696d8d4866311f96ec1">More...</a><br /></td></tr>
<tr class="separator:aa3ab52194f408696d8d4866311f96ec1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acccaef76373355cc4000a00d6f4161fc inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#acccaef76373355cc4000a00d6f4161fc">vector</a> (int i)</td></tr>
<tr class="memdesc:acccaef76373355cc4000a00d6f4161fc inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return component of the vector part of the field.  <a href="../../d3/d1f/classsirius_1_1_field4_d.html#acccaef76373355cc4000a00d6f4161fc">More...</a><br /></td></tr>
<tr class="separator:acccaef76373355cc4000a00d6f4161fc inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f2080fa009eec01a4854a0b968cfaf5 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#a0f2080fa009eec01a4854a0b968cfaf5">vector</a> (int i) const</td></tr>
<tr class="memdesc:a0f2080fa009eec01a4854a0b968cfaf5 inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return component of the vector part of the field.  <a href="../../d3/d1f/classsirius_1_1_field4_d.html#a0f2080fa009eec01a4854a0b968cfaf5">More...</a><br /></td></tr>
<tr class="separator:a0f2080fa009eec01a4854a0b968cfaf5 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f5ed02635d59fda9bf623c2f283b557 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#a0f5ed02635d59fda9bf623c2f283b557">component</a> (int i)</td></tr>
<tr class="separator:a0f5ed02635d59fda9bf623c2f283b557 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5f07519c2314aa2315fdf6646b3008b inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#ae5f07519c2314aa2315fdf6646b3008b">component_raise</a> (int i)</td></tr>
<tr class="memdesc:ae5f07519c2314aa2315fdf6646b3008b inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Throws error in case of invalid access.  <a href="../../d3/d1f/classsirius_1_1_field4_d.html#ae5f07519c2314aa2315fdf6646b3008b">More...</a><br /></td></tr>
<tr class="separator:ae5f07519c2314aa2315fdf6646b3008b inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c94462c5fcc52b2bfe2d0d30dbba704 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#a8c94462c5fcc52b2bfe2d0d30dbba704">component</a> (int i) const</td></tr>
<tr class="separator:a8c94462c5fcc52b2bfe2d0d30dbba704 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf95b126e3e692c2e93a01eba7b0d943 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#adf95b126e3e692c2e93a01eba7b0d943">zero</a> ()</td></tr>
<tr class="separator:adf95b126e3e692c2e93a01eba7b0d943 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa34675a4cefd019dfe6567024da36b17 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#aa34675a4cefd019dfe6567024da36b17">fft_transform</a> (int direction__)</td></tr>
<tr class="separator:aa34675a4cefd019dfe6567024da36b17 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a703d7fee50a4989eef5b8fb342140ea1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#a703d7fee50a4989eef5b8fb342140ea1">ctx</a> ()</td></tr>
<tr class="separator:a703d7fee50a4989eef5b8fb342140ea1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a539ea0b776fdc8f956ce35f66f177fef inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#a539ea0b776fdc8f956ce35f66f177fef">ctx</a> () const</td></tr>
<tr class="separator:a539ea0b776fdc8f956ce35f66f177fef inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c4cd8a744648ce6def512868adc8cd1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#a8c4cd8a744648ce6def512868adc8cd1">symmetrize</a> ()</td></tr>
<tr class="memdesc:a8c4cd8a744648ce6def512868adc8cd1 inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Symmetrize the scalar and vector components of the filed with crystall symmetries.  <a href="../../d3/d1f/classsirius_1_1_field4_d.html#a8c4cd8a744648ce6def512868adc8cd1">More...</a><br /></td></tr>
<tr class="separator:a8c4cd8a744648ce6def512868adc8cd1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ad70cbc40e98da722482ed4fc456d6d09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ad70cbc40e98da722482ed4fc456d6d09">generate_paw_atom_density</a> (int iapaw__)</td></tr>
<tr class="memdesc:ad70cbc40e98da722482ed4fc456d6d09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate atomic densities in the case of PAW.  <a href="../../d7/d05/classsirius_1_1_density.html#ad70cbc40e98da722482ed4fc456d6d09">More...</a><br /></td></tr>
<tr class="separator:ad70cbc40e98da722482ed4fc456d6d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af399d9d8dce9410e3a3fd2881f53a7fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#af399d9d8dce9410e3a3fd2881f53a7fe">init_density_matrix_for_paw</a> ()</td></tr>
<tr class="memdesc:af399d9d8dce9410e3a3fd2881f53a7fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize PAW density matrix.  <a href="../../d7/d05/classsirius_1_1_density.html#af399d9d8dce9410e3a3fd2881f53a7fe">More...</a><br /></td></tr>
<tr class="separator:af399d9d8dce9410e3a3fd2881f53a7fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f4087938501d5174f233b3015512801"><td class="memTemplParams" colspan="2">template&lt;int num_mag_dims&gt; </td></tr>
<tr class="memitem:a8f4087938501d5174f233b3015512801"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a8f4087938501d5174f233b3015512801">reduce_density_matrix</a> (<a class="el" href="../../d3/d37/classsirius_1_1_atom__type.html">Atom_type</a> const &amp;atom_type__, int ia__, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; const &amp;zdens__, <a class="el" href="../../de/dfd/classsirius_1_1_gaunt__coefficients.html">Gaunt_coefficients</a>&lt; double_complex &gt; const &amp;gaunt_coeffs__, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double, 3 &gt; &amp;mt_density_matrix__)</td></tr>
<tr class="memdesc:a8f4087938501d5174f233b3015512801"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduce complex density matrix over magnetic quantum numbers.  <a href="../../d7/d05/classsirius_1_1_density.html#a8f4087938501d5174f233b3015512801">More...</a><br /></td></tr>
<tr class="separator:a8f4087938501d5174f233b3015512801"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08c19e346257f2dcb99069f0128e2841"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a08c19e346257f2dcb99069f0128e2841"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a08c19e346257f2dcb99069f0128e2841">add_k_point_contribution_dm</a> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a>&lt; real_type&lt; T &gt; &gt; *kp__, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; &amp;density_matrix__)</td></tr>
<tr class="memdesc:a08c19e346257f2dcb99069f0128e2841"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add k-point contribution to the density matrix in the canonical form.  <a href="../../d7/d05/classsirius_1_1_density.html#a08c19e346257f2dcb99069f0128e2841">More...</a><br /></td></tr>
<tr class="separator:a08c19e346257f2dcb99069f0128e2841"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d87acf173df15acdd5fd2f330e94570"><td class="memTemplParams" colspan="2"><a id="a1d87acf173df15acdd5fd2f330e94570" name="a1d87acf173df15acdd5fd2f330e94570"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:a1d87acf173df15acdd5fd2f330e94570"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>add_k_point_contribution_dm_real</b> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a>&lt; T &gt; *kp__, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; &amp;density_matrix__)</td></tr>
<tr class="separator:a1d87acf173df15acdd5fd2f330e94570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a466c49795ae7cc6417573ee44b0c70fb"><td class="memTemplParams" colspan="2"><a id="a466c49795ae7cc6417573ee44b0c70fb" name="a466c49795ae7cc6417573ee44b0c70fb"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:a466c49795ae7cc6417573ee44b0c70fb"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>add_k_point_contribution_dm_complex</b> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a>&lt; T &gt; *kp__, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; &amp;density_matrix__)</td></tr>
<tr class="separator:a466c49795ae7cc6417573ee44b0c70fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8577698eab483d37e0c2cbe906058cd"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ab8577698eab483d37e0c2cbe906058cd"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ab8577698eab483d37e0c2cbe906058cd">add_k_point_contribution_rg</a> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a>&lt; T &gt; *kp__)</td></tr>
<tr class="memdesc:ab8577698eab483d37e0c2cbe906058cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add k-point contribution to the density and magnetization defined on the regular FFT grid.  <a href="../../d7/d05/classsirius_1_1_density.html#ab8577698eab483d37e0c2cbe906058cd">More...</a><br /></td></tr>
<tr class="separator:ab8577698eab483d37e0c2cbe906058cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca7bdf85719124fbf559a7f7ab21173e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#aca7bdf85719124fbf559a7f7ab21173e">generate_valence_mt</a> ()</td></tr>
<tr class="memdesc:aca7bdf85719124fbf559a7f7ab21173e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate valence density in the muffin-tins.  <a href="../../d7/d05/classsirius_1_1_density.html#aca7bdf85719124fbf559a7f7ab21173e">More...</a><br /></td></tr>
<tr class="separator:aca7bdf85719124fbf559a7f7ab21173e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e9f97560b07fd662011b3f623025b26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a4e9f97560b07fd662011b3f623025b26">generate_core_charge_density</a> ()</td></tr>
<tr class="memdesc:a4e9f97560b07fd662011b3f623025b26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate charge density of core states.  <a href="../../d7/d05/classsirius_1_1_density.html#a4e9f97560b07fd662011b3f623025b26">More...</a><br /></td></tr>
<tr class="separator:a4e9f97560b07fd662011b3f623025b26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ece62d577aecebbfd881af0ab33e6eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a8ece62d577aecebbfd881af0ab33e6eb">generate_pseudo_core_charge_density</a> ()</td></tr>
<tr class="separator:a8ece62d577aecebbfd881af0ab33e6eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a9d2831af236bca505132f4e7172475"><td class="memItemLeft" align="right" valign="top">template&lt;&gt; </td></tr>
<tr class="memitem:a4a9d2831af236bca505132f4e7172475"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a4a9d2831af236bca505132f4e7172475">add_k_point_contribution_dm_real</a> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a>&lt; double &gt; *kp__, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; &amp;density_matrix__)</td></tr>
<tr class="separator:a4a9d2831af236bca505132f4e7172475"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af30882ff875ff1127548e5af84adbe0e"><td class="memItemLeft" align="right" valign="top">template&lt;&gt; </td></tr>
<tr class="memitem:af30882ff875ff1127548e5af84adbe0e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#af30882ff875ff1127548e5af84adbe0e">add_k_point_contribution_dm_complex</a> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a>&lt; double &gt; *kp__, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; &amp;density_matrix__)</td></tr>
<tr class="separator:af30882ff875ff1127548e5af84adbe0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a3211e17c9026accf293bdef96b96edcb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/dd1/classsirius_1_1_unit__cell.html">Unit_cell</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a3211e17c9026accf293bdef96b96edcb">unit_cell_</a></td></tr>
<tr class="memdesc:a3211e17c9026accf293bdef96b96edcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alias to ctx_.unit_cell()  <a href="../../d7/d05/classsirius_1_1_density.html#a3211e17c9026accf293bdef96b96edcb">More...</a><br /></td></tr>
<tr class="separator:a3211e17c9026accf293bdef96b96edcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4dc00b929339bfea22af8c2ee92b5d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a4b4dc00b929339bfea22af8c2ee92b5d">density_matrix_</a></td></tr>
<tr class="memdesc:a4b4dc00b929339bfea22af8c2ee92b5d"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d7/d05/classsirius_1_1_density.html" title="Generate charge density and magnetization from occupied spinor wave-functions.">Density</a> matrix for all atoms.  <a href="../../d7/d05/classsirius_1_1_density.html#a4b4dc00b929339bfea22af8c2ee92b5d">More...</a><br /></td></tr>
<tr class="separator:a4b4dc00b929339bfea22af8c2ee92b5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3db706205cbd02c85333d1e164f096b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/db0/classsirius_1_1paw__density.html">paw_density</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ae3db706205cbd02c85333d1e164f096b">paw_density_</a></td></tr>
<tr class="memdesc:ae3db706205cbd02c85333d1e164f096b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local fraction of atoms with PAW correction.  <a href="../../d7/d05/classsirius_1_1_density.html#ae3db706205cbd02c85333d1e164f096b">More...</a><br /></td></tr>
<tr class="separator:ae3db706205cbd02c85333d1e164f096b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb6a683dd999ff0a2a162e5a65c9c036"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="../../d1/dcc/classsirius_1_1_occupation__matrix.html">Occupation_matrix</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#adb6a683dd999ff0a2a162e5a65c9c036">occupation_matrix_</a></td></tr>
<tr class="memdesc:adb6a683dd999ff0a2a162e5a65c9c036"><td class="mdescLeft">&#160;</td><td class="mdescRight">Occupation matrix of the LDA+U method.  <a href="../../d7/d05/classsirius_1_1_density.html#adb6a683dd999ff0a2a162e5a65c9c036">More...</a><br /></td></tr>
<tr class="separator:adb6a683dd999ff0a2a162e5a65c9c036"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9d2944c3a36c3f5c8dde800848bcf1e"><td class="memItemLeft" align="right" valign="top">std::array&lt; std::unique_ptr&lt; <a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; &gt;, 4 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ae9d2944c3a36c3f5c8dde800848bcf1e">rho_mag_coarse_</a></td></tr>
<tr class="memdesc:ae9d2944c3a36c3f5c8dde800848bcf1e"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d7/d05/classsirius_1_1_density.html" title="Generate charge density and magnetization from occupied spinor wave-functions.">Density</a> and magnetization on the coarse FFT mesh.  <a href="../../d7/d05/classsirius_1_1_density.html#ae9d2944c3a36c3f5c8dde800848bcf1e">More...</a><br /></td></tr>
<tr class="separator:ae9d2944c3a36c3f5c8dde800848bcf1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad12b8d4968f7b6076280141f1cabb4b5"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ad12b8d4968f7b6076280141f1cabb4b5">rho_pseudo_core_</a> {nullptr}</td></tr>
<tr class="memdesc:ad12b8d4968f7b6076280141f1cabb4b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to pseudo core charge density.  <a href="../../d7/d05/classsirius_1_1_density.html#ad12b8d4968f7b6076280141f1cabb4b5">More...</a><br /></td></tr>
<tr class="separator:ad12b8d4968f7b6076280141f1cabb4b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acee7a0147e974ac60cedc82d903f70d4"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="../../de/dfd/classsirius_1_1_gaunt__coefficients.html">Gaunt_coefficients</a>&lt; double_complex &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#acee7a0147e974ac60cedc82d903f70d4">gaunt_coefs_</a> {nullptr}</td></tr>
<tr class="memdesc:acee7a0147e974ac60cedc82d903f70d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non-zero Gaunt coefficients.  <a href="../../d7/d05/classsirius_1_1_density.html#acee7a0147e974ac60cedc82d903f70d4">More...</a><br /></td></tr>
<tr class="separator:acee7a0147e974ac60cedc82d903f70d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade06e0d3019316f0cf544a5bc2303776"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#ade06e0d3019316f0cf544a5bc2303776">l_by_lm_</a></td></tr>
<tr class="memdesc:ade06e0d3019316f0cf544a5bc2303776"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fast mapping between composite lm index and corresponding orbital quantum number.  <a href="../../d7/d05/classsirius_1_1_density.html#ade06e0d3019316f0cf544a5bc2303776">More...</a><br /></td></tr>
<tr class="separator:ade06e0d3019316f0cf544a5bc2303776"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6191d37fc8abddc83ed67f1988d03d6e"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="../../db/d0d/classsirius_1_1mixer_1_1_mixer.html">mixer::Mixer</a>&lt; <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt;, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt;, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt;, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt;, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt;, <a class="el" href="../../dd/db0/classsirius_1_1paw__density.html">paw_density</a>, <a class="el" href="../../d2/da0/classsirius_1_1_hubbard__matrix.html">Hubbard_matrix</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d05/classsirius_1_1_density.html#a6191d37fc8abddc83ed67f1988d03d6e">mixer_</a></td></tr>
<tr class="memdesc:a6191d37fc8abddc83ed67f1988d03d6e"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d7/d05/classsirius_1_1_density.html" title="Generate charge density and magnetization from occupied spinor wave-functions.">Density</a> mixer.  <a href="../../d7/d05/classsirius_1_1_density.html#a6191d37fc8abddc83ed67f1988d03d6e">More...</a><br /></td></tr>
<tr class="separator:a6191d37fc8abddc83ed67f1988d03d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classsirius_1_1_field4_d"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classsirius_1_1_field4_d')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html">sirius::Field4D</a></td></tr>
<tr class="memitem:a7f248a9f9365c8311c0cb266ec4429ba inherit pro_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#a7f248a9f9365c8311c0cb266ec4429ba">symmetrize</a> (<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *f__, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *gz__, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *gx__, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *gy__)</td></tr>
<tr class="separator:a7f248a9f9365c8311c0cb266ec4429ba inherit pro_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classsirius_1_1_field4_d"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classsirius_1_1_field4_d')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html">sirius::Field4D</a></td></tr>
<tr class="memitem:ad0259afeea103f3738262f45370856b6 inherit pro_attribs_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#ad0259afeea103f3738262f45370856b6">lmmax_</a></td></tr>
<tr class="separator:ad0259afeea103f3738262f45370856b6 inherit pro_attribs_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7feb66284564598af275959d77e2c10b inherit pro_attribs_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#a7feb66284564598af275959d77e2c10b">ctx_</a></td></tr>
<tr class="separator:a7feb66284564598af275959d77e2c10b inherit pro_attribs_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Generate charge density and magnetization from occupied spinor wave-functions. </p>
<p >Let's start from the definition of the complex density matrix: </p><p class="formulaDsp">
\[ \rho_{\sigma&#39; \sigma}({\bf r}) = \sum_{j{\bf k}} n_{j{\bf k}} \Psi_{j{\bf k}}^{\sigma*}({\bf r}) \Psi_{j{\bf k}}^{\sigma&#39;}({\bf r}) = \frac{1}{2} \left( \begin{array}{cc} \rho({\bf r})+m_z({\bf r}) &amp; m_x({\bf r})-im_y({\bf r}) \\ m_x({\bf r})+im_y({\bf r}) &amp; \rho({\bf r})-m_z({\bf r}) \end{array} \right) \]
</p>
<p> We notice that the diagonal components of the density matrix are actually real and the off-diagonal components are expressed trough two independent functions \( m_x({\bf r}) \) and \( m_y({\bf r}) \). Having this in mind we will work with a slightly different object, namely a real density matrix, defined as a 1-, 2- or 4-dimensional (depending on the number of magnetic components) vector with the following elements:</p><ul>
<li>\( [ \rho({\bf r}) ] \) in case of non-magnetic configuration</li>
<li>\( [ \rho_{\uparrow \uparrow}({\bf r}), \rho_{\downarrow \downarrow}({\bf r}) ] = [ \frac{\rho({\bf r})+m_z({\bf r})}{2}, \frac{\rho({\bf r})-m_z({\bf r})}{2} ] \) in case of collinear magnetic configuration</li>
<li>\( [ \rho_{\uparrow \uparrow}({\bf r}), \rho_{\downarrow \downarrow}({\bf r}), 2 \Re \rho_{\uparrow \downarrow}({\bf r}), -2 \Im \rho_{\uparrow \downarrow}({\bf r}) ] = [ \frac{\rho({\bf r})+m_z({\bf r})}{2}, \frac{\rho({\bf r})-m_z({\bf r})}{2}, m_x({\bf r}), m_y({\bf r}) ] \) in the general case of non-collinear magnetic configuration</li>
</ul>
<p >At this point it is straightforward to compute the density and magnetization in the interstitial (see <a class="el" href="../../d7/d05/classsirius_1_1_density.html#ab8577698eab483d37e0c2cbe906058cd" title="Add k-point contribution to the density and magnetization defined on the regular FFT grid.">Density::add_k_point_contribution_rg()</a>). The muffin-tin part of the density and magnetization is obtained in a slighlty more complicated way. Recall the expansion of spinor wave-functions inside the muffin-tin \( \alpha \): </p><p class="formulaDsp">
\[ \Psi_{j{\bf k}}^{\sigma}({\bf r}) = \sum_{\xi}^{N_{\xi}^{\alpha}} {S_{\xi}^{\sigma j {\bf k},\alpha}} f_{\ell_{\xi} \lambda_{\xi}}^{\alpha}(r)Y_{\ell_{\xi}m_{\xi}}(\hat {\bf r}) \]
</p>
<p> which we insert into expression for the complex density matrix: </p><p class="formulaDsp">
\[ \rho_{\sigma&#39; \sigma}({\bf r}) = \sum_{j{\bf k}} n_{j{\bf k}} \sum_{\xi}^{N_{\xi}^{\alpha}} S_{\xi}^{\sigma j {\bf k},\alpha*} f_{\ell_{\xi} \lambda_{\xi}}^{\alpha}(r) Y_{\ell_{\xi}m_{\xi}}^{*}(\hat {\bf r}) \sum_{\xi&#39;}^{N_{\xi&#39;}^{\alpha}} S_{\xi&#39;}^{\sigma&#39; j{\bf k},\alpha} f_{\ell_{\xi&#39;} \lambda_{\xi&#39;}}^{\alpha}(r)Y_{\ell_{\xi&#39;}m_{\xi&#39;}}(\hat {\bf r}) \]
</p>
<p> First, we eliminate a sum over bands and k-points by forming an auxiliary density tensor: </p><p class="formulaDsp">
\[ D_{\xi \sigma, \xi&#39; \sigma&#39;}^{\alpha} = \sum_{j{\bf k}} n_{j{\bf k}} S_{\xi}^{\sigma j {\bf k},\alpha*} S_{\xi&#39;}^{\sigma&#39; j {\bf k},\alpha} \]
</p>
<p> The expression for complex density matrix simplifies to: </p><p class="formulaDsp">
\[ \rho_{\sigma&#39; \sigma}({\bf r}) = \sum_{\xi \xi&#39;} D_{\xi \sigma, \xi&#39; \sigma&#39;}^{\alpha} f_{\ell_{\xi} \lambda_{\xi}}^{\alpha}(r)Y_{\ell_{\xi}m_{\xi}}^{*}(\hat {\bf r}) f_{\ell_{\xi&#39;} \lambda_{\xi&#39;}}^{\alpha}(r)Y_{\ell_{\xi&#39;}m_{\xi&#39;}}(\hat {\bf r}) \]
</p>
<p> Now we can switch to the real density matrix and write its' expansion in real spherical harmonics. Let's take non-magnetic case as an example: </p><p class="formulaDsp">
\[ \rho({\bf r}) = \sum_{\xi \xi&#39;} D_{\xi \xi&#39;}^{\alpha} f_{\ell_{\xi} \lambda_{\xi}}^{\alpha}(r)Y_{\ell_{\xi}m_{\xi}}^{*}(\hat {\bf r}) f_{\ell_{\xi&#39;} \lambda_{\xi&#39;}}^{\alpha}(r)Y_{\ell_{\xi&#39;}m_{\xi&#39;}}(\hat {\bf r}) = \sum_{\ell_3 m_3} \rho_{\ell_3 m_3}^{\alpha}(r) R_{\ell_3 m_3}(\hat {\bf r}) \]
</p>
<p> where </p><p class="formulaDsp">
\[ \rho_{\ell_3 m_3}^{\alpha}(r) = \sum_{\xi \xi&#39;} D_{\xi \xi&#39;}^{\alpha} f_{\ell_{\xi} \lambda_{\xi}}^{\alpha}(r) f_{\ell_{\xi&#39;} \lambda_{\xi&#39;}}^{\alpha}(r) \langle Y_{\ell_{\xi}m_{\xi}} | R_{\ell_3 m_3} | Y_{\ell_{\xi&#39;}m_{\xi&#39;}} \rangle \]
</p>
<p> We are almost done. Now it is time to switch to the full index notation \( \xi \rightarrow \{ \ell \lambda m \} \) and sum over <em>m</em> and <em>m'</em> indices: </p><p class="formulaDsp">
\[ \rho_{\ell_3 m_3}^{\alpha}(r) = \sum_{\ell \lambda, \ell&#39; \lambda&#39;} f_{\ell \lambda}^{\alpha}(r) f_{\ell&#39; \lambda&#39;}^{\alpha}(r) d_{\ell \lambda, \ell&#39; \lambda&#39;, \ell_3 m_3}^{\alpha} \]
</p>
<p> where </p><p class="formulaDsp">
\[ d_{\ell \lambda, \ell&#39; \lambda&#39;, \ell_3 m_3}^{\alpha} = \sum_{mm&#39;} D_{\ell \lambda m, \ell&#39; \lambda&#39; m&#39;}^{\alpha} \langle Y_{\ell m} | R_{\ell_3 m_3} | Y_{\ell&#39; m&#39;} \rangle \]
</p>
<p> This is our final answer: radial components of density and magnetization are expressed as a linear combination of quadratic forms in radial functions.</p>
<dl class="section note"><dt>Note</dt><dd>density and potential are allocated as global function because it's easier to load and save them. </dd>
<dd>
In case of full-potential calculation valence + core electron charge density is computed. </dd>
<dd>
In tcase of pseudopotential valence charge density is computed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00196">196</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a7dca6937cc2b1e865f1d77edfc575906" name="a7dca6937cc2b1e865f1d77edfc575906"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dca6937cc2b1e865f1d77edfc575906">&#9670;&nbsp;</a></span>Density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sirius::Density::Density </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;&#160;</td>
          <td class="paramname"><em>ctx__</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l00076">76</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ad70cbc40e98da722482ed4fc456d6d09" name="ad70cbc40e98da722482ed4fc456d6d09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad70cbc40e98da722482ed4fc456d6d09">&#9670;&nbsp;</a></span>generate_paw_atom_density()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::generate_paw_atom_density </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iapaw__</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate atomic densities in the case of PAW. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l00506">506</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="af399d9d8dce9410e3a3fd2881f53a7fe" name="af399d9d8dce9410e3a3fd2881f53a7fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af399d9d8dce9410e3a3fd2881f53a7fe">&#9670;&nbsp;</a></span>init_density_matrix_for_paw()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::init_density_matrix_for_paw </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize PAW density matrix. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l00462">462</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a8f4087938501d5174f233b3015512801" name="a8f4087938501d5174f233b3015512801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f4087938501d5174f233b3015512801">&#9670;&nbsp;</a></span>reduce_density_matrix()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int num_mag_dims&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::reduce_density_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d37/classsirius_1_1_atom__type.html">Atom_type</a> const &amp;&#160;</td>
          <td class="paramname"><em>atom_type__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ia__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; const &amp;&#160;</td>
          <td class="paramname"><em>zdens__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/dfd/classsirius_1_1_gaunt__coefficients.html">Gaunt_coefficients</a>&lt; double_complex &gt; const &amp;&#160;</td>
          <td class="paramname"><em>gaunt_coeffs__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>mt_density_matrix__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reduce complex density matrix over magnetic quantum numbers. </p>
<p >The following operation is performed: </p><p class="formulaDsp">
\[ n_{\ell \lambda, \ell&#39; \lambda&#39;, \ell_3 m_3}^{\alpha} = \sum_{mm&#39;} D_{\ell \lambda m, \ell&#39; \lambda&#39; m&#39;}^{\alpha} \langle Y_{\ell m} | R_{\ell_3 m_3} | Y_{\ell&#39; m&#39;} \rangle \]
</p>
 
<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01590">1590</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a08c19e346257f2dcb99069f0128e2841" name="a08c19e346257f2dcb99069f0128e2841"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08c19e346257f2dcb99069f0128e2841">&#9670;&nbsp;</a></span>add_k_point_contribution_dm()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::add_k_point_contribution_dm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a>&lt; real_type&lt; T &gt; &gt; *&#160;</td>
          <td class="paramname"><em>kp__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; &amp;&#160;</td>
          <td class="paramname"><em>density_matrix__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add k-point contribution to the density matrix in the canonical form. </p>
<p >In case of full-potential LAPW complex density matrix has the following expression: </p><p class="formulaDsp">
\[ d_{\xi \sigma, \xi&#39; \sigma&#39;}^{\alpha} = \sum_{j{\bf k}} n_{j{\bf k}} S_{\xi}^{\sigma j {\bf k},\alpha*} S_{\xi&#39;}^{\sigma&#39; j {\bf k},\alpha} \]
</p>
<p >where \( S_{\xi}^{\sigma j {\bf k},\alpha} \) are the expansion coefficients of spinor wave functions inside muffin-tin spheres.</p>
<p >In case of LDA+U the occupation matrix is also computed. It has the following expression: </p><p class="formulaDsp">
\[ n_{\ell,mm&#39;}^{\sigma \sigma&#39;} = \sum_{i {\bf k}}^{occ} \int_{0}^{R_{MT}} r^2 dr \Psi_{\ell m}^{i{\bf k}\sigma *}({\bf r}) \Psi_{\ell m&#39;}^{i{\bf k}\sigma&#39;}({\bf r}) \]
</p>
<p >In case of ultrasoft pseudopotential the following density matrix has to be computed for each atom: </p><p class="formulaDsp">
\[ d_{\xi \xi&#39;}^{\alpha} = \langle \beta_{\xi}^{\alpha} | \hat N | \beta_{\xi&#39;}^{\alpha} \rangle = \sum_{j {\bf k}} \langle \beta_{\xi}^{\alpha} | \Psi_{j{\bf k}} \rangle n_{j{\bf k}} \langle \Psi_{j{\bf k}} | \beta_{\xi&#39;}^{\alpha} \rangle \]
</p>
<p> Here \( \hat N = \sum_{j{\bf k}} | \Psi_{j{\bf k}} \rangle n_{j{\bf k}} \langle \Psi_{j{\bf k}} | \) is the occupancy operator written in spectral representation. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l00782">782</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="ab8577698eab483d37e0c2cbe906058cd" name="ab8577698eab483d37e0c2cbe906058cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8577698eab483d37e0c2cbe906058cd">&#9670;&nbsp;</a></span>add_k_point_contribution_rg()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::add_k_point_contribution_rg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a>&lt; T &gt; *&#160;</td>
          <td class="paramname"><em>kp__</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add k-point contribution to the density and magnetization defined on the regular FFT grid. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l00603">603</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="aca7bdf85719124fbf559a7f7ab21173e" name="aca7bdf85719124fbf559a7f7ab21173e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca7bdf85719124fbf559a7f7ab21173e">&#9670;&nbsp;</a></span>generate_valence_mt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::generate_valence_mt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate valence density in the muffin-tins. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01629">1629</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a4e9f97560b07fd662011b3f623025b26" name="a4e9f97560b07fd662011b3f623025b26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e9f97560b07fd662011b3f623025b26">&#9670;&nbsp;</a></span>generate_core_charge_density()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::generate_core_charge_density </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate charge density of core states. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00301">301</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a8ece62d577aecebbfd881af0ab33e6eb" name="a8ece62d577aecebbfd881af0ab33e6eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ece62d577aecebbfd881af0ab33e6eb">&#9670;&nbsp;</a></span>generate_pseudo_core_charge_density()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::generate_pseudo_core_charge_density </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00316">316</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a370e60a8667fcad8fb3a0fe945a4ac72" name="a370e60a8667fcad8fb3a0fe945a4ac72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a370e60a8667fcad8fb3a0fe945a4ac72">&#9670;&nbsp;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::update </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update internal parameters after a change of lattice vectors or atomic coordinates. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l00134">134</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a1060ccda46864cd753bd9b38a288a681" name="a1060ccda46864cd753bd9b38a288a681"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1060ccda46864cd753bd9b38a288a681">&#9670;&nbsp;</a></span>core_leakage() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sirius::Density::core_leakage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the total leakage of the core states out of the muffin-tins. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l00151">151</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="abea8fcd04749747c5abba5185420f413" name="abea8fcd04749747c5abba5185420f413"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abea8fcd04749747c5abba5185420f413">&#9670;&nbsp;</a></span>initial_density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::initial_density </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate initial charge density and magnetization. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l00160">160</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="ae45356dcd88effd130b03724827ba427" name="ae45356dcd88effd130b03724827ba427"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae45356dcd88effd130b03724827ba427">&#9670;&nbsp;</a></span>initial_density_pseudo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::initial_density_pseudo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l00185">185</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a2df9c61b1173bd89987926b3d249b94e" name="a2df9c61b1173bd89987926b3d249b94e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2df9c61b1173bd89987926b3d249b94e">&#9670;&nbsp;</a></span>initial_density_full_pot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::initial_density_full_pot </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l00294">294</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a644b3aa48c4ec61bc9ac33c3c7b6f435" name="a644b3aa48c4ec61bc9ac33c3c7b6f435"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a644b3aa48c4ec61bc9ac33c3c7b6f435">&#9670;&nbsp;</a></span>normalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::normalize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01074">1074</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a6e938e2bbeaa45fc8bd31f2428eefe45" name="a6e938e2bbeaa45fc8bd31f2428eefe45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e938e2bbeaa45fc8bd31f2428eefe45">&#9670;&nbsp;</a></span>check_num_electrons()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool sirius::Density::check_num_electrons </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check total density for the correct number of electrons. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01095">1095</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="af63db5d72dc92a562ce3acc9838f6dfe" name="af63db5d72dc92a562ce3acc9838f6dfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af63db5d72dc92a562ce3acc9838f6dfe">&#9670;&nbsp;</a></span>generate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">template void sirius::Density::generate&lt; double &gt; </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/dbd/classsirius_1_1_k__point__set.html">K_point_set</a> const &amp;&#160;</td>
          <td class="paramname"><em>ks__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>symmetrize__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>add_core__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>transform_to_rg__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate full charge density (valence + core) and magnetization from the wave functions. </p>
<p >This function calls <a class="el" href="../../d7/d05/classsirius_1_1_density.html#aee7ff2d2a8d755561d3f50bff9dc0d57" title="Generate valence charge density and magnetization from the wave functions.">generate_valence()</a> and then in case of full-potential LAPW method adds a core density to get the full charge density of the system. <a class="el" href="../../d7/d05/classsirius_1_1_density.html" title="Generate charge density and magnetization from occupied spinor wave-functions.">Density</a> is generated in spectral representation, i.e. plane-wave coefficients in the interstitial and spherical harmonic components in the muffin-tins. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01125">1125</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="aee7ff2d2a8d755561d3f50bff9dc0d57" name="aee7ff2d2a8d755561d3f50bff9dc0d57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee7ff2d2a8d755561d3f50bff9dc0d57">&#9670;&nbsp;</a></span>generate_valence()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::generate_valence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/dbd/classsirius_1_1_k__point__set.html">K_point_set</a> const &amp;&#160;</td>
          <td class="paramname"><em>ks__</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate valence charge density and magnetization from the wave functions. </p>
<p >The interstitial density is generated on the coarse FFT grid and then transformed to the PW domain. After symmetrization and mixing and before the generation of the XC potential density is transformted to the real-space domain and checked for the number of electrons. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01252">1252</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a663a8c76c344c5983092ddb6bd31f56a" name="a663a8c76c344c5983092ddb6bd31f56a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a663a8c76c344c5983092ddb6bd31f56a">&#9670;&nbsp;</a></span>augment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::augment </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add augmentation charge Q(r). </p>
<p >Restore valence density by adding the Q-operator constribution. The following term is added to the valence density, generated by the pseudo wave-functions: </p><p class="formulaDsp">
\[ \tilde \rho({\bf G}) = \sum_{\alpha} \sum_{\xi \xi&#39;} d_{\xi \xi&#39;}^{\alpha} Q_{\xi&#39; \xi}^{\alpha}({\bf G}) \]
</p>
<p> Plane-wave coefficients of the Q-operator for a given atom \( \alpha \) can be obtained from the corresponding coefficients of the Q-operator for a given atom <em>type</em> A: </p><p class="formulaDsp">
\[ Q_{\xi&#39; \xi}^{\alpha(A)}({\bf G}) = e^{-i{\bf G}\tau_{\alpha(A)}} Q_{\xi&#39; \xi}^{A}({\bf G}) \]
</p>
<p> We use this property to split the sum over atoms into sum over atom types and inner sum over atoms of the same type: </p><p class="formulaDsp">
\[ \tilde \rho({\bf G}) = \sum_{A} \sum_{\xi \xi&#39;} Q_{\xi&#39; \xi}^{A}({\bf G}) \sum_{\alpha(A)} d_{\xi \xi&#39;}^{\alpha(A)} e^{-i{\bf G}\tau_{\alpha(A)}} = \sum_{A} \sum_{\xi \xi&#39;} Q_{\xi&#39; \xi}^{A}({\bf G}) d_{\xi \xi&#39;}^{A}({\bf G}) \]
</p>
<p> where </p><p class="formulaDsp">
\[ d_{\xi \xi&#39;}^{A}({\bf G}) = \sum_{\alpha(A)} d_{\xi \xi&#39;}^{\alpha(A)} e^{-i{\bf G}\tau_{\alpha(A)}} \]
</p>
 
<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01232">1232</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a8a83f9d0a1a26330f181ebaf853644b3" name="a8a83f9d0a1a26330f181ebaf853644b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a83f9d0a1a26330f181ebaf853644b3">&#9670;&nbsp;</a></span>generate_rho_aug()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 2 &gt; sirius::Density::generate_rho_aug </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate augmentation charge density. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01427">1427</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="aba49bccd299f66e8673c5930c46f2972" name="aba49bccd299f66e8673c5930c46f2972"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba49bccd299f66e8673c5930c46f2972">&#9670;&nbsp;</a></span>check_density_continuity_at_mt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::check_density_continuity_at_mt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check density at MT boundary. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00398">398</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a349e10ada5b6fbb5e8b9d5206aba765c" name="a349e10ada5b6fbb5e8b9d5206aba765c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a349e10ada5b6fbb5e8b9d5206aba765c">&#9670;&nbsp;</a></span>save()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::save </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00434">434</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a78ed4dc5b87a927570fe2e7552c548e1" name="a78ed4dc5b87a927570fe2e7552c548e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78ed4dc5b87a927570fe2e7552c548e1">&#9670;&nbsp;</a></span>load()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::load </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00445">445</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a5cea378baf2b5fab91d738d88d07842e" name="a5cea378baf2b5fab91d738d88d07842e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cea378baf2b5fab91d738d88d07842e">&#9670;&nbsp;</a></span>save_to_xsf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::save_to_xsf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00465">465</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a79fabeb03c5e4cd4d44127a2696e13e7" name="a79fabeb03c5e4cd4d44127a2696e13e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79fabeb03c5e4cd4d44127a2696e13e7">&#9670;&nbsp;</a></span>save_to_ted()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::save_to_ted </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00490">490</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="af2b76bcacc2db613be601b1484d078bd" name="af2b76bcacc2db613be601b1484d078bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2b76bcacc2db613be601b1484d078bd">&#9670;&nbsp;</a></span>save_to_xdmf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::save_to_xdmf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00520">520</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a4982fd3e14b8f9f9ba2b3d4d26ae9775" name="a4982fd3e14b8f9f9ba2b3d4d26ae9775"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4982fd3e14b8f9f9ba2b3d4d26ae9775">&#9670;&nbsp;</a></span>core_leakage() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double sirius::Density::core_leakage </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ic</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return core leakage for a specific atom symmetry class. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00610">610</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a7c91ca07e4e42b0dc28191eafbcae627" name="a7c91ca07e4e42b0dc28191eafbcae627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c91ca07e4e42b0dc28191eafbcae627">&#9670;&nbsp;</a></span>rho() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp; sirius::Density::rho </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return charge density (scalar functions). </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00616">616</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a4c1441166ff824f0d85bac7e93e9bc8a" name="a4c1441166ff824f0d85bac7e93e9bc8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c1441166ff824f0d85bac7e93e9bc8a">&#9670;&nbsp;</a></span>rho() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp; sirius::Density::rho </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return const reference to charge density (scalar functions). </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00622">622</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="aec1134eb54d284eb76f4864ab90243c4" name="aec1134eb54d284eb76f4864ab90243c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec1134eb54d284eb76f4864ab90243c4">&#9670;&nbsp;</a></span>rho_pseudo_core() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; &amp; sirius::Density::rho_pseudo_core </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00627">627</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="ad0b314b7faf46fe2b94c7a3de33b75ee" name="ad0b314b7faf46fe2b94c7a3de33b75ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0b314b7faf46fe2b94c7a3de33b75ee">&#9670;&nbsp;</a></span>rho_pseudo_core() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; const  &amp; sirius::Density::rho_pseudo_core </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00632">632</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="ae9b933d68bb2a38db3b9e8b9aec96544" name="ae9b933d68bb2a38db3b9e8b9aec96544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9b933d68bb2a38db3b9e8b9aec96544">&#9670;&nbsp;</a></span>magnetization() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp; sirius::Density::magnetization </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00637">637</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a4ff3f2c89dcbf2fe884c5d1721ec1904" name="a4ff3f2c89dcbf2fe884c5d1721ec1904"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ff3f2c89dcbf2fe884c5d1721ec1904">&#9670;&nbsp;</a></span>magnetization() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp; sirius::Density::magnetization </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00642">642</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a21fd6b83366a9d5db231ca71742c1a05" name="a21fd6b83366a9d5db231ca71742c1a05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21fd6b83366a9d5db231ca71742c1a05">&#9670;&nbsp;</a></span>density_mt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; const  &amp; sirius::Density::density_mt </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ialoc</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00647">647</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="af7904609f7a2d6f197ad1cb8cdef119a" name="af7904609f7a2d6f197ad1cb8cdef119a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7904609f7a2d6f197ad1cb8cdef119a">&#9670;&nbsp;</a></span>generate_paw_loc_density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::generate_paw_loc_density </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate \( n_1 \) and \( \tilde{n}_1 \) in lm components. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l00590">590</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a3986db2add5c27ffee452b0d0bee332d" name="a3986db2add5c27ffee452b0d0bee332d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3986db2add5c27ffee452b0d0bee332d">&#9670;&nbsp;</a></span>paw_ae_density()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; const  * &gt; sirius::Density::paw_ae_density </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx__</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return list of pointers to all-electron PAW density function for a given local index of atom with PAW potential. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00656">656</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a5e2d016668924f71f4a69cda9f6733db" name="a5e2d016668924f71f4a69cda9f6733db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e2d016668924f71f4a69cda9f6733db">&#9670;&nbsp;</a></span>paw_ps_density()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; const  * &gt; sirius::Density::paw_ps_density </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx__</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return list of pointers to pseudo PAW density function for a given local index of atom with PAW potential. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00666">666</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="ac49bc0be91cfc0e1c6de821959ed2211" name="ac49bc0be91cfc0e1c6de821959ed2211"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac49bc0be91cfc0e1c6de821959ed2211">&#9670;&nbsp;</a></span>mixer_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::mixer_input </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01962">1962</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="aa98f530b6ca5ce2cff733bffb22d589d" name="aa98f530b6ca5ce2cff733bffb22d589d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa98f530b6ca5ce2cff733bffb22d589d">&#9670;&nbsp;</a></span>mixer_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::mixer_output </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01986">1986</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a32fa07e6992b98aa949c1245c3bd413e" name="a32fa07e6992b98aa949c1245c3bd413e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32fa07e6992b98aa949c1245c3bd413e">&#9670;&nbsp;</a></span>mixer_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::mixer_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/d5b/classsirius_1_1config__t_1_1mixer__t.html">config_t::mixer_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>mixer_cfg__</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize density mixer. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01921">1921</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a856614b00a6343e0d977e2b4e449f07f" name="a856614b00a6343e0d977e2b4e449f07f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a856614b00a6343e0d977e2b4e449f07f">&#9670;&nbsp;</a></span>mix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sirius::Density::mix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mix new density. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l02013">2013</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a62b21528bd79291766f0fd1ba8f0bdf2" name="a62b21528bd79291766f0fd1ba8f0bdf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62b21528bd79291766f0fd1ba8f0bdf2">&#9670;&nbsp;</a></span>density_matrix() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; const  &amp; sirius::Density::density_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00685">685</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a2d08d209aabdaf32feb948c250d4b7d6" name="a2d08d209aabdaf32feb948c250d4b7d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d08d209aabdaf32feb948c250d4b7d6">&#9670;&nbsp;</a></span>density_matrix() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; &amp; sirius::Density::density_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00690">690</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="af14668b81c5fd18011d8d7d930941e9a" name="af14668b81c5fd18011d8d7d930941e9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af14668b81c5fd18011d8d7d930941e9a">&#9670;&nbsp;</a></span>density_matrix_aux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double, 3 &gt; sirius::Density::density_matrix_aux </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; const &amp;&#160;</td>
          <td class="paramname"><em>dm__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iat__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return density matrix in auxiliary form. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01884">1884</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a5089752b2414fa4a16aa521b6731ab9e" name="a5089752b2414fa4a16aa521b6731ab9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5089752b2414fa4a16aa521b6731ab9e">&#9670;&nbsp;</a></span>compute_atomic_mag_mom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double, 2 &gt; sirius::Density::compute_atomic_mag_mom </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate approximate atomic magnetic moments in case of PP-PW. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01822">1822</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a961ccdca6c2653f8755b47c747f2720f" name="a961ccdca6c2653f8755b47c747f2720f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a961ccdca6c2653f8755b47c747f2720f">&#9670;&nbsp;</a></span>get_magnetisation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::tuple&lt; std::array&lt; double, 3 &gt;, std::array&lt; double, 3 &gt;, std::vector&lt; std::array&lt; double, 3 &gt; &gt; &gt; sirius::Density::get_magnetisation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get total magnetization and also contributions from interstitial and muffin-tin parts. </p>
<p >In case of PP-PW there are no real muffin-tins. Instead, a value of magnetization inside atomic sphere with some chosen radius is returned. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01850">1850</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="a5aa2c64b50733841e1508208a242ee87" name="a5aa2c64b50733841e1508208a242ee87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aa2c64b50733841e1508208a242ee87">&#9670;&nbsp;</a></span>symmetrize_density_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::symmetrize_density_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Symmetrize density matrix. </p>
<p >We start from the spectral represntation of the occupancy operator defined for the irreducible Brillouin zone: </p><p class="formulaDsp">
\[ \hat N_{IBZ} = \sum_{j} \sum_{{\bf k}}^{IBZ} | \Psi_{j{\bf k}}^{\sigma} \rangle w_{\bf k} n_{j{\bf k}} \langle \Psi_{j{\bf k}}^{\sigma&#39;} | \]
</p>
<p> and a set of localized orbitals with the pure angular character (this can be LAPW functions, beta-projectors or localized <a class="el" href="../../d7/d27/classsirius_1_1_hubbard.html" title="Apply Hubbard correction in the collinear case.">Hubbard</a> orbitals) : </p><p class="formulaDsp">
\[ |\phi_{\ell m}^{\alpha {\bf T}}\rangle \]
</p>
<p> The orbitals are labeled by the angular and azimuthal quantum numbers ( \( \ell m \)), atom index ( \( \alpha \)) and a lattice translation vector ( \( {\bf T} \)) such that: </p><p class="formulaDsp">
\[ \langle {\bf r} | \phi_{\ell m}^{\alpha {\bf T}} \rangle = \phi_{\ell m}({\bf r - r_{\alpha} - T}) \]
</p>
<p >There might be several localized orbitals per atom. We wish to compute the symmetrized occupation matrix: </p><p class="formulaDsp">
\[ n_{\ell m \alpha {\bf T} \sigma, \ell&#39; m&#39; \alpha&#39; {\bf T}&#39; \sigma&#39;} = \langle \phi_{\ell m}^{\alpha {\bf T}} | \hat N | \phi_{\ell&#39; m&#39;}^{\alpha&#39; {\bf T&#39;}} \rangle = \sum_{\bf P} \sum_{j} \sum_{{\bf k}}^{IBZ} \langle \phi_{\ell m}^{\alpha {\bf T}} | \hat{\bf P} \Psi_{j{\bf k}}^{\sigma} \rangle w_{\bf k} n_{j{\bf k}} \langle \hat{\bf P} \Psi_{j{\bf k}}^{\sigma&#39;} | \phi_{\ell&#39; m&#39;}^{\alpha&#39; {\bf T&#39;}} \rangle \]
</p>
<p >Let's now label the overlap integrals between localized orbitals and KS wave-functions: </p><p class="formulaDsp">
\[ A_{\ell m j{\bf k}}^{\alpha {\bf T} \sigma} = \langle \Psi_{j{\bf k}}^{\sigma} | \phi_{\ell m}^{\alpha {\bf T}} \rangle = \int \Psi_{j{\bf k}}^{\sigma *}({\bf r}) \phi_{\ell m}({\bf r} - {\bf r}_{\alpha} - {\bf T}) d{\bf r} \]
</p>
<p> and check how it transforms under the symmetry operation \( \hat {\bf P} = \{ {\bf R} | {\bf t} \} \) applied to the KS states. </p><p class="formulaDsp">
\[ \int \big( \hat {\bf P}\Psi_{j {\bf k}}^{\sigma *}({\bf r}) \big) \phi_{\ell m}({\bf r} - {\bf r}_{\alpha} - {\bf T}) d{\bf r} = \int \Psi_{j {\bf k}}^{\sigma *}({\bf r}) \big( \hat {\bf P}^{-1} \phi_{\ell m}({\bf r} - {\bf r}_{\alpha} - {\bf T}) \big) d{\bf r} \]
</p>
<p >Let's first derive how the inverse symmetry operation acts on the localized orbital centered on the atom inside a unit cell (no <b>T</b>): </p><p class="formulaDsp">
\[ \hat {\bf P}^{-1} \phi\big( {\bf r} - {\bf r}_{\alpha} \big) = \phi\big( {\bf R} {\bf r} + {\bf t} - {\bf r}_{\alpha} \big) = \\ \phi\big( {\bf R}({\bf r} - {\bf R}^{-1}({\bf r}_{\alpha} - {\bf t})) \big) = \tilde \phi \big( {\bf r} - {\bf R}^{-1}({\bf r}_{\alpha} - {\bf t}) \big) \]
</p>
<p> This operation rotates the orbital and centers it at the position </p><p class="formulaDsp">
\[ {\bf r}_{\beta} = {\bf R}^{-1}{\bf r}_{\alpha} - {\bf R}^{-1}{\bf t} = \hat {\bf P}^{-1}{\bf r}_{\alpha} \]
</p>
<p >For example, suppose thar we have y-orbital centered at \( {\bf r}_{\alpha} = [1, 0] \) (black dot) and a symmetry operation \( \hat {\bf P} = \{ {\bf R} | {\bf t} \} \) that rotates by \( \pi/2 \) counterclockwise and translates by [1/2, 1/2]:</p>
<div class="image">
<img src="../../sym_orbital1.png" alt="" width="400px"/>
</div>
<p >Under this symmetry operation the atom coordinate will transform into [1/2, 3/2] (red dot), but this is not(!) how the orbital is transformed. The origin of the atom will transform according to the inverse of \( \hat {\bf P} \) into \( {\bf r}_{\beta} = [-1/2, -1/2] \) (blue dot) such that \( \hat {\bf P} {\bf r}_{\beta} = {\bf r}_{\alpha} \):</p>
<div class="image">
<img src="../../sym_orbital2.png" alt="" width="400px"/>
</div>
<p >To be more precise, we should highlight that the transformed atom coordinate can go out of the original unit cell and can be brought back with a translation vector: </p><p class="formulaDsp">
\[ \hat {\bf P}^{-1}{\bf r}_{\alpha} = {\bf r}_{\beta} + {\bf T}_{P\alpha\beta} \]
</p>
<p >Now let's derive how the inverse symmetry operation acts on the localized orbital \( \phi({\bf r}) \) centered on atom in the arbitrary unit cell: </p><p class="formulaDsp">
\[ \hat {\bf P}^{-1} \phi\big( {\bf r} - {\bf r}_{\alpha} - {\bf T} \big) = \phi\big( {\bf R} {\bf r} + {\bf t} - {\bf r}_{\alpha} - {\bf T} \big) = \\ \phi\big( {\bf R}({\bf r} - {\bf R}^{-1}({\bf r}_{\alpha} + {\bf T} - {\bf t})) \big) = \tilde \phi\big( {\bf r} - {\bf R}^{-1}({\bf r}_{\alpha} + {\bf T} - {\bf t}) \big) = \tilde \phi\big( {\bf r} - {\bf r}_{\beta} - {\bf T}_{P\alpha\beta} - {\bf R}^{-1}{\bf T} \big) \]
</p>
<p >Now let's check how the atomic orbitals transfrom under the rotational part of the symmetry operation. The atomic functions of ( \( \ell m \)) character is expressed as a product of radial function and a spherical harmonic: </p><p class="formulaDsp">
\[ \phi_{\ell m}({\bf r}) = \phi_{\ell}(r) Y_{\ell m}(\theta, \phi) \]
</p>
<p >Under rotation the spherical harmonic is transformed as: </p><p class="formulaDsp">
\[ Y_{\ell m}({\bf P} \hat{\bf r}) = {\bf P}^{-1}Y_{\ell m}(\hat {\bf r}) = \sum_{m&#39;} D_{m&#39;m}^{\ell}({\bf P}^{-1}) Y_{\ell m&#39;}(\hat {\bf r}) = \sum_{m&#39;} D_{mm&#39;}^{\ell}({\bf P}) Y_{\ell m&#39;}(\hat {\bf r}) \]
</p>
<p> so </p><p class="formulaDsp">
\[ \tilde \phi_{\ell m}({\bf r}) =\hat {\bf P}^{-1} \phi_{\ell}(r) Y_{\ell m}(\theta, \phi) = \sum_{m&#39;} D_{mm&#39;}^{\ell}({\bf P}) \phi_{\ell}(r) Y_{\ell m&#39;}(\theta, \phi) \]
</p>
<p >We will use Bloch theorem to get rid of the translations in the argument of \( \tilde \phi \): </p><p class="formulaDsp">
\[ \int \Psi_{j {\bf k}}^{\sigma *}({\bf r}) \tilde \phi_{\ell m} \big( {\bf r} - {\bf r}_{\beta} - {\bf T}_{P\alpha\beta} - {\bf R}^{-1}{\bf T} \big) d{\bf r} = e^{-i{\bf k}({\bf T}_{P\alpha\beta} + {\bf R}^{-1}{\bf T})} \int \Psi_{j {\bf k}}^{\sigma *}({\bf r}) \tilde \phi_{\ell m} \big( {\bf r} - {\bf r}_{\beta} \big) d{\bf r} \]
</p>
<p> (the "-" in the phase factor appears because KS wave-functions are complex conjugate) and now we can write </p><p class="formulaDsp">
\[ A_{\ell m j\hat {\bf P}{\bf k}}^{\alpha {\bf T} \sigma} = e^{-i{\bf k}({\bf T}_{P\alpha\beta} + {\bf R}^{-1}{\bf T})} \sum_{m&#39;} D_{mm&#39;}^{\ell}({\bf P}) A_{\ell m&#39; j{\bf k}}^{\beta \sigma} \]
</p>
<p >The final expression for the symmetrized matrix is then </p><p class="formulaDsp">
\[ n_{\ell m \alpha {\bf T} \sigma, \ell&#39; m&#39; \alpha&#39; {\bf T}&#39; \sigma&#39;} = \sum_{\bf P} \sum_{j} \sum_{{\bf k}}^{IBZ} A_{\ell m j\hat {\bf P}{\bf k}}^{\alpha {\bf T} \sigma *} w_{\bf k} n_{j{\bf k}} A_{\ell&#39; m&#39; j\hat {\bf P}{\bf k}}^{\alpha&#39; {\bf T&#39;} \sigma&#39;} = \\ = \sum_{\bf P} \sum_{j} \sum_{{\bf k}}^{IBZ} e^{i{\bf k}({\bf T}_{P\alpha\beta} + {\bf R}^{-1}{\bf T})} e^{-i{\bf k}({\bf T}_{P\alpha&#39;\beta&#39;} + {\bf R}^{-1}{\bf T&#39;})} \sum_{m_1 m_2} D_{mm_1}^{\ell *}({\bf P}) D_{m&#39;m_2}^{\ell&#39;}({\bf P}) A_{\ell m_1 j{\bf k}}^{\beta \sigma *} A_{\ell&#39; m_2 j{\bf k}}^{\beta&#39; \sigma&#39;} w_{\bf k} n_{j{\bf k}} \]
</p>
<p >In the case of \( \alpha = \alpha&#39; \) and \( {\bf T}={\bf T}&#39; \) all the phase-factor exponents disappear and we get an expression for the "on-site" occupation matrix:</p>
<p class="formulaDsp">
\[ n_{\ell m \sigma, \ell&#39; m&#39; \sigma&#39;}^{\alpha} = \sum_{\bf P} \sum_{j} \sum_{{\bf k}}^{IBZ} \sum_{m_1 m_2} D_{mm_1}^{\ell *}({\bf P}) D_{m&#39;m_2}^{\ell&#39;}({\bf P}) A_{\ell m_1 j{\bf k}}^{\beta \sigma *} A_{\ell&#39; m_2 j{\bf k}}^{\beta \sigma&#39;} w_{\bf k} n_{j{\bf k}} = \\ = \sum_{\bf P} \sum_{m_1 m_2} D_{mm_1}^{\ell *}({\bf P}) D_{m&#39;m_2}^{\ell&#39;}({\bf P}) \tilde n_{\ell m_1 \sigma, \ell&#39; m_2 \sigma&#39;}^{\beta} \]
</p>
<p >To compute the overlap integrals between KS wave-functions and localized <a class="el" href="../../d7/d27/classsirius_1_1_hubbard.html" title="Apply Hubbard correction in the collinear case.">Hubbard</a> orbitals we insert resolution of identity (in \( {\bf G+k} \) planve-waves) between bra and ket: </p><p class="formulaDsp">
\[ \langle \phi_{\ell m}^{\alpha} | \Psi_{j{\bf k}}^{\sigma} \rangle = \sum_{\bf G} \phi_{\ell m}^{\alpha *}({\bf G+k}) \Psi_{j}^{\sigma}({\bf G+k}) \]
</p>
 
<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01764">1764</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="af36505c03971740defb12068c0d92639" name="af36505c03971740defb12068c0d92639"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af36505c03971740defb12068c0d92639">&#9670;&nbsp;</a></span>print_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::print_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00869">869</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a5dace67a5b32b154cd247c7460422c32" name="a5dace67a5b32b154cd247c7460422c32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dace67a5b32b154cd247c7460422c32">&#9670;&nbsp;</a></span>occupation_matrix() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/dcc/classsirius_1_1_occupation__matrix.html">Occupation_matrix</a> const  &amp; sirius::Density::occupation_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00947">947</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a573c6dc90ddc875c9d43ab3c322e3a34" name="a573c6dc90ddc875c9d43ab3c322e3a34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a573c6dc90ddc875c9d43ab3c322e3a34">&#9670;&nbsp;</a></span>occupation_matrix() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/dcc/classsirius_1_1_occupation__matrix.html">Occupation_matrix</a> &amp; sirius::Density::occupation_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00952">952</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a4a9d2831af236bca505132f4e7172475" name="a4a9d2831af236bca505132f4e7172475"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a9d2831af236bca505132f4e7172475">&#9670;&nbsp;</a></span>add_k_point_contribution_dm_real()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::add_k_point_contribution_dm_real </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>kp__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; &amp;&#160;</td>
          <td class="paramname"><em>density_matrix__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01049">1049</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<a id="af30882ff875ff1127548e5af84adbe0e" name="af30882ff875ff1127548e5af84adbe0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af30882ff875ff1127548e5af84adbe0e">&#9670;&nbsp;</a></span>add_k_point_contribution_dm_complex()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Density::add_k_point_contribution_dm_complex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>kp__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt; double_complex, 4 &gt; &amp;&#160;</td>
          <td class="paramname"><em>density_matrix__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d86/density_8cpp_source.html#l01055">1055</a> of file <a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a3211e17c9026accf293bdef96b96edcb" name="a3211e17c9026accf293bdef96b96edcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3211e17c9026accf293bdef96b96edcb">&#9670;&nbsp;</a></span>unit_cell_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/dd1/classsirius_1_1_unit__cell.html">Unit_cell</a>&amp; sirius::Density::unit_cell_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Alias to ctx_.unit_cell() </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00200">200</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a4b4dc00b929339bfea22af8c2ee92b5d" name="a4b4dc00b929339bfea22af8c2ee92b5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b4dc00b929339bfea22af8c2ee92b5d">&#9670;&nbsp;</a></span>density_matrix_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt;double_complex, 4&gt; sirius::Density::density_matrix_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="../../d7/d05/classsirius_1_1_density.html" title="Generate charge density and magnetization from occupied spinor wave-functions.">Density</a> matrix for all atoms. </p>
<p >This is a global matrix, meaning that each MPI rank holds the full copy. This simplifies the symmetrization. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00204">204</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="ae3db706205cbd02c85333d1e164f096b" name="ae3db706205cbd02c85333d1e164f096b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3db706205cbd02c85333d1e164f096b">&#9670;&nbsp;</a></span>paw_density_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/db0/classsirius_1_1paw__density.html">paw_density</a> sirius::Density::paw_density_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Local fraction of atoms with PAW correction. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00207">207</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="adb6a683dd999ff0a2a162e5a65c9c036" name="adb6a683dd999ff0a2a162e5a65c9c036"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb6a683dd999ff0a2a162e5a65c9c036">&#9670;&nbsp;</a></span>occupation_matrix_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="../../d1/dcc/classsirius_1_1_occupation__matrix.html">Occupation_matrix</a>&gt; sirius::Density::occupation_matrix_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Occupation matrix of the LDA+U method. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00210">210</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="ae9d2944c3a36c3f5c8dde800848bcf1e" name="ae9d2944c3a36c3f5c8dde800848bcf1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9d2944c3a36c3f5c8dde800848bcf1e">&#9670;&nbsp;</a></span>rho_mag_coarse_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::array&lt;std::unique_ptr&lt;<a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt;double&gt; &gt;, 4&gt; sirius::Density::rho_mag_coarse_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="../../d7/d05/classsirius_1_1_density.html" title="Generate charge density and magnetization from occupied spinor wave-functions.">Density</a> and magnetization on the coarse FFT mesh. </p>
<p >Coarse FFT grid is enough to generate density and magnetization from the wave-functions. The components of the <code>rho_mag_coarse</code> vector have the following order: \( \{\rho({\bf r}), m_z({\bf r}), m_x({\bf r}), m_y({\bf r}) \} \). </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00217">217</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="ad12b8d4968f7b6076280141f1cabb4b5" name="ad12b8d4968f7b6076280141f1cabb4b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad12b8d4968f7b6076280141f1cabb4b5">&#9670;&nbsp;</a></span>rho_pseudo_core_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt;double&gt; &gt; sirius::Density::rho_pseudo_core_ {nullptr}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to pseudo core charge density. </p>
<p >In the case of pseudopotential we need to know the non-linear core correction to the exchange-correlation energy which is introduced trough the pseudo core density: \( E_{xc}[\rho_{val} + \rho_{core}] \). The 'pseudo' reflects the fact that this density integrated does not reproduce the total number of core elctrons. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00225">225</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="acee7a0147e974ac60cedc82d903f70d4" name="acee7a0147e974ac60cedc82d903f70d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acee7a0147e974ac60cedc82d903f70d4">&#9670;&nbsp;</a></span>gaunt_coefs_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="../../de/dfd/classsirius_1_1_gaunt__coefficients.html">Gaunt_coefficients</a>&lt;double_complex&gt; &gt; sirius::Density::gaunt_coefs_ {nullptr}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Non-zero Gaunt coefficients. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00228">228</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="ade06e0d3019316f0cf544a5bc2303776" name="ade06e0d3019316f0cf544a5bc2303776"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade06e0d3019316f0cf544a5bc2303776">&#9670;&nbsp;</a></span>l_by_lm_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; sirius::Density::l_by_lm_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fast mapping between composite lm index and corresponding orbital quantum number. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00231">231</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<a id="a6191d37fc8abddc83ed67f1988d03d6e" name="a6191d37fc8abddc83ed67f1988d03d6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6191d37fc8abddc83ed67f1988d03d6e">&#9670;&nbsp;</a></span>mixer_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="../../db/d0d/classsirius_1_1mixer_1_1_mixer.html">mixer::Mixer</a>&lt;<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt;double&gt;, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt;double&gt;, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt;double&gt;, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt;double&gt;, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">sddk::mdarray</a>&lt;double_complex, 4&gt;, <a class="el" href="../../dd/db0/classsirius_1_1paw__density.html">paw_density</a>, <a class="el" href="../../d2/da0/classsirius_1_1_hubbard__matrix.html">Hubbard_matrix</a>&gt; &gt; sirius::Density::mixer_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="../../d7/d05/classsirius_1_1_density.html" title="Generate charge density and magnetization from occupied spinor wave-functions.">Density</a> mixer. </p>
<p >Mix the following objects: density, x-,y-,z-components of magnetisation, density matrix and PAW density of atoms. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d9a/density_8hpp_source.html#l00238">238</a> of file <a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d0/d9a/density_8hpp_source.html">density.hpp</a></li>
<li><a class="el" href="../../d9/d86/density_8cpp_source.html">density.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 4 2022 17:24:35 for SIRIUS by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
