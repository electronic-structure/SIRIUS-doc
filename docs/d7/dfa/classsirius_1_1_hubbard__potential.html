<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SIRIUS: sirius::Hubbard_potential Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SIRIUS
   &#160;<span id="projectnumber">5.05</span>
   </div>
   <div id="projectbrief">Electronic structure library and applications</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d5/def/namespacesirius.html">sirius</a></li><li class="navelem"><a class="el" href="../../d7/dfa/classsirius_1_1_hubbard__potential.html">Hubbard_potential</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d3/dc4/classsirius_1_1_hubbard__potential-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">sirius::Hubbard_potential Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for sirius::Hubbard_potential:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d3/d32/classsirius_1_1_hubbard__potential__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1da80dbb6fda45b7f7c9c59b1b2efb5c"><td class="memItemLeft" align="right" valign="top"><a id="a1da80dbb6fda45b7f7c9c59b1b2efb5c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_hubbard_U_plus_V</b> (const bool U_plus_V_)</td></tr>
<tr class="separator:a1da80dbb6fda45b7f7c9c59b1b2efb5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76025171945b05abe2e4d6ff6a995ece"><td class="memItemLeft" align="right" valign="top"><a id="a76025171945b05abe2e4d6ff6a995ece"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_hubbard_simple_correction</b> ()</td></tr>
<tr class="separator:a76025171945b05abe2e4d6ff6a995ece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac91ce7dd34507d8541aa4f0c4473880e"><td class="memItemLeft" align="right" valign="top"><a id="ac91ce7dd34507d8541aa4f0c4473880e"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>hubbard_lmax</b> () const</td></tr>
<tr class="separator:ac91ce7dd34507d8541aa4f0c4473880e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a186f4896114819a92a7ed10af5f14689"><td class="memItemLeft" align="right" valign="top"><a id="a186f4896114819a92a7ed10af5f14689"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_orthogonalize_hubbard_orbitals</b> (const bool test)</td></tr>
<tr class="separator:a186f4896114819a92a7ed10af5f14689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad67dbf7243ded0c687061c4528635cdc"><td class="memItemLeft" align="right" valign="top"><a id="ad67dbf7243ded0c687061c4528635cdc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_normalize_hubbard_orbitals</b> (const bool test)</td></tr>
<tr class="separator:ad67dbf7243ded0c687061c4528635cdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb6a1522584521284b242d679e63d82f"><td class="memItemLeft" align="right" valign="top"><a id="adb6a1522584521284b242d679e63d82f"></a>
double_complex&#160;</td><td class="memItemRight" valign="bottom"><b>U</b> (int m1, int m2, int m3, int m4) const</td></tr>
<tr class="separator:adb6a1522584521284b242d679e63d82f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bdecc7f66582916ff0a34126e519dad"><td class="memItemLeft" align="right" valign="top"><a id="a5bdecc7f66582916ff0a34126e519dad"></a>
double_complex &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>U</b> (int m1, int m2, int m3, int m4)</td></tr>
<tr class="separator:a5bdecc7f66582916ff0a34126e519dad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7958d7cf77c710c6065b33ef9a533124"><td class="memItemLeft" align="right" valign="top"><a id="a7958d7cf77c710c6065b33ef9a533124"></a>
double_complex&#160;</td><td class="memItemRight" valign="bottom"><b>U</b> (int m1, int m2, int m3, int m4, int channel) const</td></tr>
<tr class="separator:a7958d7cf77c710c6065b33ef9a533124"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff4a892e4276af3d1834189aa6ae1aa4"><td class="memItemLeft" align="right" valign="top"><a id="aff4a892e4276af3d1834189aa6ae1aa4"></a>
double_complex &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>U</b> (int m1, int m2, int m3, int m4, int channel)</td></tr>
<tr class="separator:aff4a892e4276af3d1834189aa6ae1aa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7084e759ba65ea1241a667289f4cacd5"><td class="memItemLeft" align="right" valign="top"><a id="a7084e759ba65ea1241a667289f4cacd5"></a>
const bool &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>orthogonalize_hubbard_orbitals</b> () const</td></tr>
<tr class="separator:a7084e759ba65ea1241a667289f4cacd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8f76ccf2e8922015f1e2ad0eca6110d"><td class="memItemLeft" align="right" valign="top"><a id="ac8f76ccf2e8922015f1e2ad0eca6110d"></a>
const bool &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>normalize_hubbard_orbitals</b> () const</td></tr>
<tr class="separator:ac8f76ccf2e8922015f1e2ad0eca6110d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5a194da5e553e812d5563b51c030823"><td class="memItemLeft" align="right" valign="top"><a id="ac5a194da5e553e812d5563b51c030823"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>calculate_hubbard_potential_and_energy</b> ()</td></tr>
<tr class="separator:ac5a194da5e553e812d5563b51c030823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0daa248976748197d64ee819dc4e40d7"><td class="memItemLeft" align="right" valign="top"><a id="a0daa248976748197d64ee819dc4e40d7"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>hubbard_energy</b> () const</td></tr>
<tr class="separator:a0daa248976748197d64ee819dc4e40d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9563ca78adb8442328a9b3b254084a8"><td class="memItemLeft" align="right" valign="top"><a id="ac9563ca78adb8442328a9b3b254084a8"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>number_of_hubbard_orbitals</b> () const</td></tr>
<tr class="separator:ac9563ca78adb8442328a9b3b254084a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0907933d52512103aae6bb69b8bd087"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/classsirius_1_1_hubbard__potential.html#ae0907933d52512103aae6bb69b8bd087">Hubbard_potential</a> (<a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;ctx__)</td></tr>
<tr class="separator:ae0907933d52512103aae6bb69b8bd087"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17dbbaddc142729e3c2e8a91144e99ff"><td class="memItemLeft" align="right" valign="top"><a id="a17dbbaddc142729e3c2e8a91144e99ff"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mixer_input</b> ()</td></tr>
<tr class="separator:a17dbbaddc142729e3c2e8a91144e99ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedcab94f8c3a3d40caff11baaf872f70"><td class="memItemLeft" align="right" valign="top"><a id="aedcab94f8c3a3d40caff11baaf872f70"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mixer_output</b> ()</td></tr>
<tr class="separator:aedcab94f8c3a3d40caff11baaf872f70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b833724b1394a1c2ff52386e440afb5"><td class="memItemLeft" align="right" valign="top"><a id="a5b833724b1394a1c2ff52386e440afb5"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>mix</b> ()</td></tr>
<tr class="separator:a5b833724b1394a1c2ff52386e440afb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a6eeb89ea44a4f8f85353dd0fa83d2b"><td class="memItemLeft" align="right" valign="top"><a id="a8a6eeb89ea44a4f8f85353dd0fa83d2b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>generate_atomic_orbitals</b> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a> &amp;kp, <a class="el" href="../../d4/d66/classsirius_1_1_q__operator.html">Q_operator</a>&lt; double &gt; &amp;q_op)</td></tr>
<tr class="separator:a8a6eeb89ea44a4f8f85353dd0fa83d2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf2d9016344cec74cb90a750d869289b"><td class="memItemLeft" align="right" valign="top"><a id="acf2d9016344cec74cb90a750d869289b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>generate_atomic_orbitals</b> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a> &amp;kp, <a class="el" href="../../d4/d66/classsirius_1_1_q__operator.html">Q_operator</a>&lt; double_complex &gt; &amp;q_op)</td></tr>
<tr class="separator:acf2d9016344cec74cb90a750d869289b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f2a5fed52822c3a31952bfb824b8aee"><td class="memItemLeft" align="right" valign="top"><a id="a4f2a5fed52822c3a31952bfb824b8aee"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>orthogonalize_atomic_orbitals</b> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a> &amp;kp, <a class="el" href="../../d9/d04/classsddk_1_1_wave__functions.html">Wave_functions</a> &amp;sphi)</td></tr>
<tr class="separator:a4f2a5fed52822c3a31952bfb824b8aee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace2b84a8351681eea6d538be89dff652"><td class="memItemLeft" align="right" valign="top"><a id="ace2b84a8351681eea6d538be89dff652"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>GenerateAtomicOrbitals</b> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a> &amp;kp, <a class="el" href="../../d9/d04/classsddk_1_1_wave__functions.html">Wave_functions</a> &amp;phi)</td></tr>
<tr class="separator:ace2b84a8351681eea6d538be89dff652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76fe87a960b34e35116dff1cc4a03732"><td class="memItemLeft" align="right" valign="top"><a id="a76fe87a960b34e35116dff1cc4a03732"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ComputeDerivatives</b> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a> &amp;kp, <a class="el" href="../../d9/d04/classsddk_1_1_wave__functions.html">Wave_functions</a> &amp;phi, <a class="el" href="../../d9/d04/classsddk_1_1_wave__functions.html">Wave_functions</a> &amp;dphi, const int direction)</td></tr>
<tr class="separator:a76fe87a960b34e35116dff1cc4a03732"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f607666007ba5e3067a9d5ceccee844"><td class="memItemLeft" align="right" valign="top"><a id="a3f607666007ba5e3067a9d5ceccee844"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>calculate_hubbard_potential_and_energy_colinear_case</b> ()</td></tr>
<tr class="separator:a3f607666007ba5e3067a9d5ceccee844"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3ca67e5b0922ba06bc04316ab9abec9"><td class="memItemLeft" align="right" valign="top"><a id="ad3ca67e5b0922ba06bc04316ab9abec9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>calculate_hubbard_potential_and_energy_non_colinear_case</b> ()</td></tr>
<tr class="separator:ad3ca67e5b0922ba06bc04316ab9abec9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23ae82cd9a402688bdd66d2bfd15e114"><td class="memItemLeft" align="right" valign="top"><a id="a23ae82cd9a402688bdd66d2bfd15e114"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_hubbard_potential</b> (double *occ, int ld)</td></tr>
<tr class="separator:a23ae82cd9a402688bdd66d2bfd15e114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23ff3ae1490a60e20ef3590db6247e6f"><td class="memItemLeft" align="right" valign="top"><a id="a23ff3ae1490a60e20ef3590db6247e6f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_hubbard_potential_nc</b> (double_complex *occ, int ld)</td></tr>
<tr class="separator:a23ff3ae1490a60e20ef3590db6247e6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3ef3d0c932f301a66ac3e0c018c6e45"><td class="memItemLeft" align="right" valign="top"><a id="af3ef3d0c932f301a66ac3e0c018c6e45"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>apply_hubbard_potential</b> (<a class="el" href="../../d1/daf/classsirius_1_1_k__point.html">K_point</a> &amp;kp, const int idx__, const int n__, <a class="el" href="../../d9/d04/classsddk_1_1_wave__functions.html">Wave_functions</a> &amp;phi, <a class="el" href="../../d9/d04/classsddk_1_1_wave__functions.html">Wave_functions</a> &amp;ophi)</td></tr>
<tr class="separator:af3ef3d0c932f301a66ac3e0c018c6e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6a3070e2417d974b6c63e9d32f8f754"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/classsirius_1_1_hubbard__potential.html#ae6a3070e2417d974b6c63e9d32f8f754">hubbard_compute_occupation_numbers</a> (<a class="el" href="../../d9/dbd/classsirius_1_1_k__point__set.html">K_point_set</a> &amp;kset_)</td></tr>
<tr class="memdesc:ae6a3070e2417d974b6c63e9d32f8f754"><td class="mdescLeft">&#160;</td><td class="mdescRight">We need to symmetrize them.  <a href="#ae6a3070e2417d974b6c63e9d32f8f754">More...</a><br /></td></tr>
<tr class="separator:ae6a3070e2417d974b6c63e9d32f8f754"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a13f0e86f72f5348b6b9503b95259ed"><td class="memItemLeft" align="right" valign="top"><a id="a9a13f0e86f72f5348b6b9503b95259ed"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>calculate_initial_occupation_numbers</b> ()</td></tr>
<tr class="separator:a9a13f0e86f72f5348b6b9503b95259ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa548c134581835cb33872c3aaa034f75"><td class="memItemLeft" align="right" valign="top"><a id="aa548c134581835cb33872c3aaa034f75"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>natural_lm_to_qe</b> (int m, int l)</td></tr>
<tr class="separator:aa548c134581835cb33872c3aaa034f75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48aed8f2a6095af71b0e973112783ebc"><td class="memItemLeft" align="right" valign="top"><a id="a48aed8f2a6095af71b0e973112783ebc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_hubbard_occupancies_matrix</b> (double *occ, int ld)</td></tr>
<tr class="separator:a48aed8f2a6095af71b0e973112783ebc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f579e2dee371fee810032320c8e1f54"><td class="memItemLeft" align="right" valign="top"><a id="a1f579e2dee371fee810032320c8e1f54"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_hubbard_occupancies_matrix_nc</b> (double_complex *occ, int ld)</td></tr>
<tr class="separator:a1f579e2dee371fee810032320c8e1f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4fc9c8e81e227f255c36f5d4d00fe00"><td class="memItemLeft" align="right" valign="top"><a id="ad4fc9c8e81e227f255c36f5d4d00fe00"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>get_hubbard_occupancies_matrix</b> (double *occ, int ld)</td></tr>
<tr class="separator:ad4fc9c8e81e227f255c36f5d4d00fe00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8786f46b53dcf3f774b766f9aef9af8b"><td class="memItemLeft" align="right" valign="top"><a id="a8786f46b53dcf3f774b766f9aef9af8b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>get_hubbard_occupancies_matrix_nc</b> (double_complex *occ, int ld)</td></tr>
<tr class="separator:a8786f46b53dcf3f774b766f9aef9af8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af121455aeaf6154ec360ec1fe37b16fe"><td class="memItemLeft" align="right" valign="top"><a id="af121455aeaf6154ec360ec1fe37b16fe"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>print_occupancies</b> ()</td></tr>
<tr class="separator:af121455aeaf6154ec360ec1fe37b16fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a862cf35215ad9972b12a8808e75e9d44"><td class="memItemLeft" align="right" valign="top"><a id="a862cf35215ad9972b12a8808e75e9d44"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>symmetrize_occupancy_matrix_noncolinear_case</b> ()</td></tr>
<tr class="separator:a862cf35215ad9972b12a8808e75e9d44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01099de6348dd4fef0e3a54b3bb8ab52"><td class="memItemLeft" align="right" valign="top"><a id="a01099de6348dd4fef0e3a54b3bb8ab52"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>symmetrize_occupancy_matrix</b> ()</td></tr>
<tr class="separator:a01099de6348dd4fef0e3a54b3bb8ab52"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ac82aa7187d8e27255603dc4af19b92dc"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/classsirius_1_1_hubbard__potential.html#ac82aa7187d8e27255603dc4af19b92dc">offset</a></td></tr>
<tr class="separator:ac82aa7187d8e27255603dc4af19b92dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a6b0de5ada04c24cdbe25b1b73df07124"><td class="memItemLeft" align="right" valign="top"><a id="a6b0de5ada04c24cdbe25b1b73df07124"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>calculate_wavefunction_with_U_offset</b> ()</td></tr>
<tr class="separator:a6b0de5ada04c24cdbe25b1b73df07124"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a1d83ba7b068cf17f7236914682c5ecd7"><td class="memItemLeft" align="right" valign="top"><a id="a1d83ba7b068cf17f7236914682c5ecd7"></a>
<a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>ctx_</b></td></tr>
<tr class="separator:a1d83ba7b068cf17f7236914682c5ecd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac65049b7cd83c36c1a4e7946b6ff0a76"><td class="memItemLeft" align="right" valign="top"><a id="ac65049b7cd83c36c1a4e7946b6ff0a76"></a>
<a class="el" href="../../d6/dd1/classsirius_1_1_unit__cell.html">Unit_cell</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>unit_cell_</b></td></tr>
<tr class="separator:ac65049b7cd83c36c1a4e7946b6ff0a76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35145634d69fd9e23d20a71b8d3cd58a"><td class="memItemLeft" align="right" valign="top"><a id="a35145634d69fd9e23d20a71b8d3cd58a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>lmax_</b> {0}</td></tr>
<tr class="separator:a35145634d69fd9e23d20a71b8d3cd58a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a325d37f6c7f5006666e1f09f7bd16067"><td class="memItemLeft" align="right" valign="top"><a id="a325d37f6c7f5006666e1f09f7bd16067"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>number_of_hubbard_orbitals_</b> {0}</td></tr>
<tr class="separator:a325d37f6c7f5006666e1f09f7bd16067"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97eead02c34f5eaab46c3fb68ca7463a"><td class="memItemLeft" align="right" valign="top"><a id="a97eead02c34f5eaab46c3fb68ca7463a"></a>
std::unique_ptr&lt; <a class="el" href="../../d1/d76/classsirius_1_1_mixer.html">Mixer</a>&lt; double_complex &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/classsirius_1_1_hubbard__potential.html#a97eead02c34f5eaab46c3fb68ca7463a">mixer_</a> {nullptr}</td></tr>
<tr class="memdesc:a97eead02c34f5eaab46c3fb68ca7463a"><td class="mdescLeft">&#160;</td><td class="mdescRight">mixer for the hubbard occupancies. <br /></td></tr>
<tr class="separator:a97eead02c34f5eaab46c3fb68ca7463a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fbb325860df7149dc501ff7034b75f8"><td class="memItemLeft" align="right" valign="top"><a id="a7fbb325860df7149dc501ff7034b75f8"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 5 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>occupancy_number_</b></td></tr>
<tr class="separator:a7fbb325860df7149dc501ff7034b75f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7139c58085dbc401faee5716690b66d5"><td class="memItemLeft" align="right" valign="top"><a id="a7139c58085dbc401faee5716690b66d5"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>hubbard_energy_</b> {0.0}</td></tr>
<tr class="separator:a7139c58085dbc401faee5716690b66d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e26f2916cbb9d1e3e1def88ec5efbeb"><td class="memItemLeft" align="right" valign="top"><a id="a7e26f2916cbb9d1e3e1def88ec5efbeb"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>hubbard_energy_u_</b> {0.0}</td></tr>
<tr class="separator:a7e26f2916cbb9d1e3e1def88ec5efbeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ada77dc53d35bea88ec2ee8bb16ef85"><td class="memItemLeft" align="right" valign="top"><a id="a8ada77dc53d35bea88ec2ee8bb16ef85"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>hubbard_energy_dc_contribution_</b> {0.0}</td></tr>
<tr class="separator:a8ada77dc53d35bea88ec2ee8bb16ef85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8f10f933a04a3c5c7e8869c40807dfe"><td class="memItemLeft" align="right" valign="top"><a id="ab8f10f933a04a3c5c7e8869c40807dfe"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>hubbard_energy_noflip_</b> {0.0}</td></tr>
<tr class="separator:ab8f10f933a04a3c5c7e8869c40807dfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9067aa49a2ae7ffe0876313495dbc0e9"><td class="memItemLeft" align="right" valign="top"><a id="a9067aa49a2ae7ffe0876313495dbc0e9"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>hubbard_energy_flip_</b> {0.0}</td></tr>
<tr class="separator:a9067aa49a2ae7ffe0876313495dbc0e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9cb267241c406571fae7751816ca69b"><td class="memItemLeft" align="right" valign="top"><a id="aa9cb267241c406571fae7751816ca69b"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 5 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>hubbard_potential_</b></td></tr>
<tr class="separator:aa9cb267241c406571fae7751816ca69b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18843d1573bb44c3610a52a78029b1fd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/classsirius_1_1_hubbard__potential.html#a18843d1573bb44c3610a52a78029b1fd">approximation_</a> {false}</td></tr>
<tr class="separator:a18843d1573bb44c3610a52a78029b1fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa4b72dfb3e36b2309e9f56faf77b767"><td class="memItemLeft" align="right" valign="top"><a id="afa4b72dfb3e36b2309e9f56faf77b767"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/classsirius_1_1_hubbard__potential.html#afa4b72dfb3e36b2309e9f56faf77b767">orthogonalize_hubbard_orbitals_</a> {false}</td></tr>
<tr class="memdesc:afa4b72dfb3e36b2309e9f56faf77b767"><td class="mdescLeft">&#160;</td><td class="mdescRight">orthogonalize and/or normalize the projectors <br /></td></tr>
<tr class="separator:afa4b72dfb3e36b2309e9f56faf77b767"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ff8e73692d2f3da84507b6e73a0cfc0"><td class="memItemLeft" align="right" valign="top"><a id="a0ff8e73692d2f3da84507b6e73a0cfc0"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/classsirius_1_1_hubbard__potential.html#a0ff8e73692d2f3da84507b6e73a0cfc0">normalize_orbitals_only_</a> {false}</td></tr>
<tr class="memdesc:a0ff8e73692d2f3da84507b6e73a0cfc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">by default we just normalize them <br /></td></tr>
<tr class="separator:a0ff8e73692d2f3da84507b6e73a0cfc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6da2d3e080d025d5125900f504257a12"><td class="memItemLeft" align="right" valign="top"><a id="a6da2d3e080d025d5125900f504257a12"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/classsirius_1_1_hubbard__potential.html#a6da2d3e080d025d5125900f504257a12">hubbard_U_plus_V_</a> {false}</td></tr>
<tr class="memdesc:a6da2d3e080d025d5125900f504257a12"><td class="mdescLeft">&#160;</td><td class="mdescRight">hubbard correction with next nearest neighbors <br /></td></tr>
<tr class="separator:a6da2d3e080d025d5125900f504257a12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe6ea0d4b86eb36afe7caf2aee984332"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/classsirius_1_1_hubbard__potential.html#afe6ea0d4b86eb36afe7caf2aee984332">projection_method_</a> {0}</td></tr>
<tr class="separator:afe6ea0d4b86eb36afe7caf2aee984332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4536fde2f74285218c922d05f331e27d"><td class="memItemLeft" align="right" valign="top"><a id="a4536fde2f74285218c922d05f331e27d"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/classsirius_1_1_hubbard__potential.html#a4536fde2f74285218c922d05f331e27d">multi_channels_</a> {false}</td></tr>
<tr class="memdesc:a4536fde2f74285218c922d05f331e27d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hubbard with multi channels (not implemented yet) <br /></td></tr>
<tr class="separator:a4536fde2f74285218c922d05f331e27d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c4081bb994abc45f849abca6fe04c3e"><td class="memItemLeft" align="right" valign="top"><a id="a0c4081bb994abc45f849abca6fe04c3e"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/classsirius_1_1_hubbard__potential.html#a0c4081bb994abc45f849abca6fe04c3e">wave_function_file_</a></td></tr>
<tr class="memdesc:a0c4081bb994abc45f849abca6fe04c3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">file containing the hubbard wave functions <br /></td></tr>
<tr class="separator:a0c4081bb994abc45f849abca6fe04c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../db/d74/hubbard_8hpp_source.html#l00015">15</a> of file <a class="el" href="../../db/d74/hubbard_8hpp_source.html">hubbard.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae0907933d52512103aae6bb69b8bd087"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0907933d52512103aae6bb69b8bd087">&#9670;&nbsp;</a></span>Hubbard_potential()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sirius::Hubbard_potential::Hubbard_potential </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;&#160;</td>
          <td class="paramname"><em>ctx__</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>if spin orbit coupling or non colinear magnetisms are activated, then we consider the full spherical hubbard correction </p>

<p class="definition">Definition at line <a class="el" href="../../db/d74/hubbard_8hpp_source.html#l00180">180</a> of file <a class="el" href="../../db/d74/hubbard_8hpp_source.html">hubbard.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae6a3070e2417d974b6c63e9d32f8f754"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6a3070e2417d974b6c63e9d32f8f754">&#9670;&nbsp;</a></span>hubbard_compute_occupation_numbers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Hubbard_potential::hubbard_compute_occupation_numbers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/dbd/classsirius_1_1_k__point__set.html">K_point_set</a> &amp;&#160;</td>
          <td class="paramname"><em>kset_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>We need to symmetrize them. </p>
<p>as the name says. We compute the occupation numbers associated to the hubbard wavefunctions (locally centered orbitals, wannier functions, etc) that are relevant for the hubbard correction. These quantities are defined by </p><p class="formulaDsp">
\[ n_{m,m&#39;}^I \sigma = \sum_{kv} f(\varepsilon_{kv}) |&lt;\psi_{kv}| phi_I_m&gt;|^2 \]
</p>
<p> where </p><p class="formulaDsp">
\[m=-l\cdot l$ (same for m&#39;)\]
</p>
<p>, I is the a. </p>

<p class="definition">Definition at line <a class="el" href="../../db/d74/hubbard_8hpp_source.html#l00011">11</a> of file <a class="el" href="../../db/d74/hubbard_8hpp_source.html">hubbard.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a18843d1573bb44c3610a52a78029b1fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18843d1573bb44c3610a52a78029b1fd">&#9670;&nbsp;</a></span>approximation_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool sirius::Hubbard_potential::approximation_ {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>type of hubbard correction to be considered. put to true if we consider a simple hubbard correction. Not valid if spin orbit coupling is included </p>

<p class="definition">Definition at line <a class="el" href="../../db/d74/hubbard_8hpp_source.html#l00045">45</a> of file <a class="el" href="../../db/d74/hubbard_8hpp_source.html">hubbard.hpp</a>.</p>

</div>
</div>
<a id="afe6ea0d4b86eb36afe7caf2aee984332"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe6ea0d4b86eb36afe7caf2aee984332">&#9670;&nbsp;</a></span>projection_method_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int sirius::Hubbard_potential::projection_method_ {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>hubbard projection method. By default we use the wave functions provided by the pseudo potentials. </p>

<p class="definition">Definition at line <a class="el" href="../../db/d74/hubbard_8hpp_source.html#l00058">58</a> of file <a class="el" href="../../db/d74/hubbard_8hpp_source.html">hubbard.hpp</a>.</p>

</div>
</div>
<a id="ac82aa7187d8e27255603dc4af19b92dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac82aa7187d8e27255603dc4af19b92dc">&#9670;&nbsp;</a></span>offset</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; sirius::Hubbard_potential::offset</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pointer the radial integrals of the projectors. Only there for future use. std::unique_ptr&lt;Radial_integrals_centered_atomic_wfc&gt; wfc_; </p>

<p class="definition">Definition at line <a class="el" href="../../db/d74/hubbard_8hpp_source.html#l00071">71</a> of file <a class="el" href="../../db/d74/hubbard_8hpp_source.html">hubbard.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="../../db/d74/hubbard_8hpp_source.html">hubbard.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 15 2018 10:42:46 for SIRIUS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
