<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SIRIUS: sirius::Potential Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SIRIUS
   &#160;<span id="projectnumber">6.4.0</span>
   </div>
   <div id="projectbrief">Electronic structure library and applications</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d5/def/namespacesirius.html">sirius</a></li><li class="navelem"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html">Potential</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d0/ded/classsirius_1_1_potential-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">sirius::Potential Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Generate effective potential from charge density and magnetization.  
 <a href="../../d2/d0b/classsirius_1_1_potential.html#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for sirius::Potential:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/d4b/classsirius_1_1_potential__inherit__graph.svg" width="123" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for sirius::Potential:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/daa/classsirius_1_1_potential__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/def/structsirius_1_1_potential_1_1paw__potential__data__t.html">paw_potential_data_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8d779e124012d2eb74e622b91774c2ea"><td class="memItemLeft" align="right" valign="top"><a id="a8d779e124012d2eb74e622b91774c2ea"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a8d779e124012d2eb74e622b91774c2ea">Potential</a> (<a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;ctx__)</td></tr>
<tr class="memdesc:a8d779e124012d2eb74e622b91774c2ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. <br /></td></tr>
<tr class="separator:a8d779e124012d2eb74e622b91774c2ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc39ad521981e230bcbc7b493a86f617"><td class="memItemLeft" align="right" valign="top"><a id="abc39ad521981e230bcbc7b493a86f617"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#abc39ad521981e230bcbc7b493a86f617">update</a> ()</td></tr>
<tr class="memdesc:abc39ad521981e230bcbc7b493a86f617"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recompute some variables that depend on atomic positions or the muffin-tin radius. <br /></td></tr>
<tr class="separator:abc39ad521981e230bcbc7b493a86f617"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa634d5aa4ae136bad08b704f5c1a5cc6"><td class="memTemplParams" colspan="2"><a id="aa634d5aa4ae136bad08b704f5c1a5cc6"></a>
template&lt;bool free_atom, typename T &gt; </td></tr>
<tr class="memitem:aa634d5aa4ae136bad08b704f5c1a5cc6"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; T &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#aa634d5aa4ae136bad08b704f5c1a5cc6">poisson_vmt</a> (<a class="el" href="../../d3/d50/classsirius_1_1_atom.html">Atom</a> const &amp;atom__, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, T &gt; const &amp;rho_mt__, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, T &gt; &amp;vha_mt__) const</td></tr>
<tr class="memdesc:aa634d5aa4ae136bad08b704f5c1a5cc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve Poisson equation for a single atom. <br /></td></tr>
<tr class="separator:aa634d5aa4ae136bad08b704f5c1a5cc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e30e263faee37bffa8da7c001e88a9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a5e30e263faee37bffa8da7c001e88a9d">poisson</a> (<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const &amp;rho)</td></tr>
<tr class="memdesc:a5e30e263faee37bffa8da7c001e88a9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Poisson solver.  <a href="#a5e30e263faee37bffa8da7c001e88a9d">More...</a><br /></td></tr>
<tr class="separator:a5e30e263faee37bffa8da7c001e88a9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a998c461b7cd69e56f4c4b0b547781737"><td class="memTemplParams" colspan="2">template&lt;bool add_pseudo_core__ = false&gt; </td></tr>
<tr class="memitem:a998c461b7cd69e56f4c4b0b547781737"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a998c461b7cd69e56f4c4b0b547781737">xc</a> (<a class="el" href="../../d7/d05/classsirius_1_1_density.html">Density</a> const &amp;rho__)</td></tr>
<tr class="memdesc:a998c461b7cd69e56f4c4b0b547781737"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate XC potential and energy density.  <a href="#a998c461b7cd69e56f4c4b0b547781737">More...</a><br /></td></tr>
<tr class="separator:a998c461b7cd69e56f4c4b0b547781737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dea1a31c220e7c4ad47453ed0f2fe1a"><td class="memItemLeft" align="right" valign="top"><a id="a7dea1a31c220e7c4ad47453ed0f2fe1a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a7dea1a31c220e7c4ad47453ed0f2fe1a">generate</a> (<a class="el" href="../../d7/d05/classsirius_1_1_density.html">Density</a> const &amp;density__)</td></tr>
<tr class="memdesc:a7dea1a31c220e7c4ad47453ed0f2fe1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate effective potential and magnetic field from charge density and magnetization. <br /></td></tr>
<tr class="separator:a7dea1a31c220e7c4ad47453ed0f2fe1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a476007fa356fb79d01cf829a69b26430"><td class="memItemLeft" align="right" valign="top"><a id="a476007fa356fb79d01cf829a69b26430"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>save</b> ()</td></tr>
<tr class="separator:a476007fa356fb79d01cf829a69b26430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4531df46202e7c0495ff7a389351486d"><td class="memItemLeft" align="right" valign="top"><a id="a4531df46202e7c0495ff7a389351486d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>load</b> ()</td></tr>
<tr class="separator:a4531df46202e7c0495ff7a389351486d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57df8029903153c8c6e4f8c71347334e"><td class="memItemLeft" align="right" valign="top"><a id="a57df8029903153c8c6e4f8c71347334e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>update_atomic_potential</b> ()</td></tr>
<tr class="separator:a57df8029903153c8c6e4f8c71347334e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa15c3084148757dd135180fe287e4497"><td class="memTemplParams" colspan="2"><a id="aa15c3084148757dd135180fe287e4497"></a>
template&lt;device_t pu&gt; </td></tr>
<tr class="memitem:aa15c3084148757dd135180fe287e4497"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>add_mt_contribution_to_pw</b> ()</td></tr>
<tr class="separator:aa15c3084148757dd135180fe287e4497"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef421db1d4ce4ece0be0cea7e0f0b12c"><td class="memItemLeft" align="right" valign="top"><a id="aef421db1d4ce4ece0be0cea7e0f0b12c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#aef421db1d4ce4ece0be0cea7e0f0b12c">generate_pw_coefs</a> ()</td></tr>
<tr class="memdesc:aef421db1d4ce4ece0be0cea7e0f0b12c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate plane-wave coefficients of the potential in the interstitial region. <br /></td></tr>
<tr class="separator:aef421db1d4ce4ece0be0cea7e0f0b12c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac53f9c549fb2e2a5e02992a823e792e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#ac53f9c549fb2e2a5e02992a823e792e7">generate_D_operator_matrix</a> ()</td></tr>
<tr class="memdesc:ac53f9c549fb2e2a5e02992a823e792e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate D operator from potential and augmentation charge.  <a href="#ac53f9c549fb2e2a5e02992a823e792e7">More...</a><br /></td></tr>
<tr class="separator:ac53f9c549fb2e2a5e02992a823e792e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a410fb8a7217f5881fc9dbb13bb2da684"><td class="memItemLeft" align="right" valign="top"><a id="a410fb8a7217f5881fc9dbb13bb2da684"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>generate_PAW_effective_potential</b> (<a class="el" href="../../d7/d05/classsirius_1_1_density.html">Density</a> const &amp;density)</td></tr>
<tr class="separator:a410fb8a7217f5881fc9dbb13bb2da684"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab98d9241bb17aa204bd2e86ccd0d7dec"><td class="memItemLeft" align="right" valign="top"><a id="ab98d9241bb17aa204bd2e86ccd0d7dec"></a>
std::vector&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_hartree_energies</b> () const</td></tr>
<tr class="separator:ab98d9241bb17aa204bd2e86ccd0d7dec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd04f866794cf8ab336a4597c9210385"><td class="memItemLeft" align="right" valign="top"><a id="afd04f866794cf8ab336a4597c9210385"></a>
std::vector&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_xc_energies</b> () const</td></tr>
<tr class="separator:afd04f866794cf8ab336a4597c9210385"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab6d6c3480cd8a47df8402b3b037a145"><td class="memItemLeft" align="right" valign="top"><a id="aab6d6c3480cd8a47df8402b3b037a145"></a>
std::vector&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_core_energies</b> () const</td></tr>
<tr class="separator:aab6d6c3480cd8a47df8402b3b037a145"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeddf5e54da5ad9edc49ccba74ff00be1"><td class="memItemLeft" align="right" valign="top"><a id="aeddf5e54da5ad9edc49ccba74ff00be1"></a>
std::vector&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_one_elec_energies</b> () const</td></tr>
<tr class="separator:aeddf5e54da5ad9edc49ccba74ff00be1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2b490deca7e327436686dce2425cb14"><td class="memItemLeft" align="right" valign="top"><a id="ae2b490deca7e327436686dce2425cb14"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_hartree_total_energy</b> () const</td></tr>
<tr class="separator:ae2b490deca7e327436686dce2425cb14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fde624bb6ddbe198257044c9be43939"><td class="memItemLeft" align="right" valign="top"><a id="a9fde624bb6ddbe198257044c9be43939"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_xc_total_energy</b> () const</td></tr>
<tr class="separator:a9fde624bb6ddbe198257044c9be43939"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1213f6b0509a9c03487d8669018a2a8"><td class="memItemLeft" align="right" valign="top"><a id="ac1213f6b0509a9c03487d8669018a2a8"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_total_core_energy</b> () const</td></tr>
<tr class="separator:ac1213f6b0509a9c03487d8669018a2a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9236ee1bb41df5ee9bfef9d115f2849"><td class="memItemLeft" align="right" valign="top"><a id="aa9236ee1bb41df5ee9bfef9d115f2849"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_total_energy</b> () const</td></tr>
<tr class="separator:aa9236ee1bb41df5ee9bfef9d115f2849"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a409e1a0e3d82df120f1e8d38d2dc2bb2"><td class="memItemLeft" align="right" valign="top"><a id="a409e1a0e3d82df120f1e8d38d2dc2bb2"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_one_elec_energy</b> () const</td></tr>
<tr class="separator:a409e1a0e3d82df120f1e8d38d2dc2bb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70e4eb1dbbe61223cfa9ec8e21f90252"><td class="memItemLeft" align="right" valign="top"><a id="a70e4eb1dbbe61223cfa9ec8e21f90252"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>check_potential_continuity_at_mt</b> ()</td></tr>
<tr class="separator:a70e4eb1dbbe61223cfa9ec8e21f90252"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d7cfdd0284254268957131c8285f939"><td class="memItemLeft" align="right" valign="top"><a id="a9d7cfdd0284254268957131c8285f939"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>effective_potential</b> ()</td></tr>
<tr class="separator:a9d7cfdd0284254268957131c8285f939"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2729ffb641b2ca78dab5c0b0e325f23"><td class="memItemLeft" align="right" valign="top"><a id="ac2729ffb641b2ca78dab5c0b0e325f23"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>effective_potential</b> () const</td></tr>
<tr class="separator:ac2729ffb641b2ca78dab5c0b0e325f23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ff5ed8a4645fd13da241c6dbeda88c1"><td class="memItemLeft" align="right" valign="top"><a id="a8ff5ed8a4645fd13da241c6dbeda88c1"></a>
<a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>local_potential</b> ()</td></tr>
<tr class="separator:a8ff5ed8a4645fd13da241c6dbeda88c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f7820bfac1e4fe7610d50a79671ac30"><td class="memItemLeft" align="right" valign="top"><a id="a5f7820bfac1e4fe7610d50a79671ac30"></a>
<a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>local_potential</b> () const</td></tr>
<tr class="separator:a5f7820bfac1e4fe7610d50a79671ac30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b145ccc293668342b94b2735fad8b1f"><td class="memItemLeft" align="right" valign="top"><a id="a1b145ccc293668342b94b2735fad8b1f"></a>
<a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>dveff</b> ()</td></tr>
<tr class="separator:a1b145ccc293668342b94b2735fad8b1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a878516a9301ea9ba65b520406e809b14"><td class="memItemLeft" align="right" valign="top"><a id="a878516a9301ea9ba65b520406e809b14"></a>
<a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>effective_potential_mt</b> (int ialoc) const</td></tr>
<tr class="separator:a878516a9301ea9ba65b520406e809b14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbeeef8aa1c38e461f3b1788f90e8752"><td class="memItemLeft" align="right" valign="top"><a id="abbeeef8aa1c38e461f3b1788f90e8752"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>effective_magnetic_field</b> (int i)</td></tr>
<tr class="separator:abbeeef8aa1c38e461f3b1788f90e8752"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba285cb2fd7baaddef7b08793f194b3b"><td class="memItemLeft" align="right" valign="top"><a id="aba285cb2fd7baaddef7b08793f194b3b"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>effective_magnetic_field</b> (int i) const</td></tr>
<tr class="separator:aba285cb2fd7baaddef7b08793f194b3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ea5be8a6be9e62f13f1fa73ada63d5"><td class="memItemLeft" align="right" valign="top"><a id="a44ea5be8a6be9e62f13f1fa73ada63d5"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>hartree_potential</b> ()</td></tr>
<tr class="separator:a44ea5be8a6be9e62f13f1fa73ada63d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbbce35fcadf3986b87604b40e601e82"><td class="memItemLeft" align="right" valign="top"><a id="afbbce35fcadf3986b87604b40e601e82"></a>
<a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>hartree_potential_mt</b> (int ialoc) const</td></tr>
<tr class="separator:afbbce35fcadf3986b87604b40e601e82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a478141b526a02558c14976bc53303232"><td class="memItemLeft" align="right" valign="top"><a id="a478141b526a02558c14976bc53303232"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>xc_potential</b> ()</td></tr>
<tr class="separator:a478141b526a02558c14976bc53303232"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ce4df60aa099399a7a2c6aef5a76644"><td class="memItemLeft" align="right" valign="top"><a id="a4ce4df60aa099399a7a2c6aef5a76644"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>xc_potential</b> () const</td></tr>
<tr class="separator:a4ce4df60aa099399a7a2c6aef5a76644"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ba965bda8371178cd7ef1471a0305ba"><td class="memItemLeft" align="right" valign="top"><a id="a0ba965bda8371178cd7ef1471a0305ba"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>xc_energy_density</b> ()</td></tr>
<tr class="separator:a0ba965bda8371178cd7ef1471a0305ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c404cebefd00710ed23b07339730b35"><td class="memItemLeft" align="right" valign="top"><a id="a2c404cebefd00710ed23b07339730b35"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>xc_energy_density</b> () const</td></tr>
<tr class="separator:a2c404cebefd00710ed23b07339730b35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd614cb39e86468fb7d6597f3150d863"><td class="memItemLeft" align="right" valign="top"><a id="acd614cb39e86468fb7d6597f3150d863"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>vh_el</b> (int <a class="el" href="../../d5/def/namespacesirius.html#aa85831f0ebd13ecc4d27b17ec224c3baab40788f566d1124a95169068077031a9">ia</a>) const</td></tr>
<tr class="separator:acd614cb39e86468fb7d6597f3150d863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e58e362a8bcf04a40283ef179a23d24"><td class="memItemLeft" align="right" valign="top"><a id="a6e58e362a8bcf04a40283ef179a23d24"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>energy_vha</b> () const</td></tr>
<tr class="separator:a6e58e362a8bcf04a40283ef179a23d24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed48eca89917a12857f4da176292bdb5"><td class="memItemLeft" align="right" valign="top"><a id="aed48eca89917a12857f4da176292bdb5"></a>
double_complex const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>veff_pw</b> (int ig__) const</td></tr>
<tr class="separator:aed48eca89917a12857f4da176292bdb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a49d0837134f3cee24493ad0a023abd"><td class="memItemLeft" align="right" valign="top"><a id="a4a49d0837134f3cee24493ad0a023abd"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_veff_pw</b> (double_complex const *veff_pw__)</td></tr>
<tr class="separator:a4a49d0837134f3cee24493ad0a023abd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6dbfa7b487ff1455b60fc465af0abc0"><td class="memItemLeft" align="right" valign="top"><a id="ae6dbfa7b487ff1455b60fc465af0abc0"></a>
double_complex const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>rm_inv_pw</b> (int ig__) const</td></tr>
<tr class="separator:ae6dbfa7b487ff1455b60fc465af0abc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f78d819006ea46b180d03f6171afa13"><td class="memItemLeft" align="right" valign="top"><a id="a7f78d819006ea46b180d03f6171afa13"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_rm_inv_pw</b> (double_complex const *rm_inv_pw__)</td></tr>
<tr class="separator:a7f78d819006ea46b180d03f6171afa13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18f596f187cc528ab0c63200ea915269"><td class="memItemLeft" align="right" valign="top"><a id="a18f596f187cc528ab0c63200ea915269"></a>
double_complex const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>rm2_inv_pw</b> (int ig__) const</td></tr>
<tr class="separator:a18f596f187cc528ab0c63200ea915269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe7f961fb005b5c33d0b9805c6ba2d63"><td class="memItemLeft" align="right" valign="top"><a id="afe7f961fb005b5c33d0b9805c6ba2d63"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_rm2_inv_pw</b> (double_complex const *rm2_inv_pw__)</td></tr>
<tr class="separator:afe7f961fb005b5c33d0b9805c6ba2d63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fb75c60a84d09397209de7e21c36fb4"><td class="memItemLeft" align="right" valign="top"><a id="a2fb75c60a84d09397209de7e21c36fb4"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a2fb75c60a84d09397209de7e21c36fb4">energy_vxc</a> (<a class="el" href="../../d7/d05/classsirius_1_1_density.html">Density</a> const &amp;density__) const</td></tr>
<tr class="memdesc:a2fb75c60a84d09397209de7e21c36fb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integral of \( \rho({\bf r}) V^{XC}({\bf r}) \). <br /></td></tr>
<tr class="separator:a2fb75c60a84d09397209de7e21c36fb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb9ba100a9eca1aabf95d10321402f95"><td class="memItemLeft" align="right" valign="top"><a id="adb9ba100a9eca1aabf95d10321402f95"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#adb9ba100a9eca1aabf95d10321402f95">energy_vxc_core</a> (<a class="el" href="../../d7/d05/classsirius_1_1_density.html">Density</a> const &amp;density__) const</td></tr>
<tr class="memdesc:adb9ba100a9eca1aabf95d10321402f95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integral of \( \rho_{c}({\bf r}) V^{XC}({\bf r}) \). <br /></td></tr>
<tr class="separator:adb9ba100a9eca1aabf95d10321402f95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31db28b6e96dc77dcccb6b34dc922e53"><td class="memItemLeft" align="right" valign="top"><a id="a31db28b6e96dc77dcccb6b34dc922e53"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a31db28b6e96dc77dcccb6b34dc922e53">energy_exc</a> (<a class="el" href="../../d7/d05/classsirius_1_1_density.html">Density</a> const &amp;density__) const</td></tr>
<tr class="memdesc:a31db28b6e96dc77dcccb6b34dc922e53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integral of \( \rho({\bf r}) \epsilon^{XC}({\bf r}) \). <br /></td></tr>
<tr class="separator:a31db28b6e96dc77dcccb6b34dc922e53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03cfd00150486abf344373823705a19e"><td class="memItemLeft" align="right" valign="top"><a id="a03cfd00150486abf344373823705a19e"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>is_gradient_correction</b> () const</td></tr>
<tr class="separator:a03cfd00150486abf344373823705a19e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a265acbf2c6781023674f5cb79110f557"><td class="memItemLeft" align="right" valign="top"><a id="a265acbf2c6781023674f5cb79110f557"></a>
<a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>vsigma</b> (int ispn__)</td></tr>
<tr class="separator:a265acbf2c6781023674f5cb79110f557"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a639de6162c6512444ced65e9e1b8f73b"><td class="memItemLeft" align="right" valign="top"><a id="a639de6162c6512444ced65e9e1b8f73b"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>vha_el</b> (int ia__) const</td></tr>
<tr class="separator:a639de6162c6512444ced65e9e1b8f73b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27bb3fdd0d63629bb0b15a5d4c1a283f"><td class="memItemLeft" align="right" valign="top"><a id="a27bb3fdd0d63629bb0b15a5d4c1a283f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>symmetrize</b> ()</td></tr>
<tr class="separator:a27bb3fdd0d63629bb0b15a5d4c1a283f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1078f8b65c12a3d07f164803ac9186c7"><td class="memItemLeft" align="right" valign="top"><a id="a1078f8b65c12a3d07f164803ac9186c7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a1078f8b65c12a3d07f164803ac9186c7">scale_rho_xc</a> (double d__)</td></tr>
<tr class="memdesc:a1078f8b65c12a3d07f164803ac9186c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the scale_rho_xc variable. <br /></td></tr>
<tr class="separator:a1078f8b65c12a3d07f164803ac9186c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82e5405b73c1ee1fdb97d153a4c3062b"><td class="memItemLeft" align="right" valign="top"><a id="a82e5405b73c1ee1fdb97d153a4c3062b"></a>
<a class="el" href="../../d7/d27/classsirius_1_1_hubbard.html">Hubbard</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>U</b> () const</td></tr>
<tr class="separator:a82e5405b73c1ee1fdb97d153a4c3062b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classsirius_1_1_field4_d"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classsirius_1_1_field4_d')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html">sirius::Field4D</a></td></tr>
<tr class="memitem:a28b1083500ae2cbc7926bd95ce68418f inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a28b1083500ae2cbc7926bd95ce68418f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Field4D</b> (<a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;ctx__, int lmmax__)</td></tr>
<tr class="separator:a28b1083500ae2cbc7926bd95ce68418f inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac46db987e3bce8d86a27d0ad567ea8a7 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="ac46db987e3bce8d86a27d0ad567ea8a7"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#ac46db987e3bce8d86a27d0ad567ea8a7">scalar</a> ()</td></tr>
<tr class="memdesc:ac46db987e3bce8d86a27d0ad567ea8a7 inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return scalar part of the field. <br /></td></tr>
<tr class="separator:ac46db987e3bce8d86a27d0ad567ea8a7 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3ab52194f408696d8d4866311f96ec1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="aa3ab52194f408696d8d4866311f96ec1"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#aa3ab52194f408696d8d4866311f96ec1">scalar</a> () const</td></tr>
<tr class="memdesc:aa3ab52194f408696d8d4866311f96ec1 inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return scalar part of the field. <br /></td></tr>
<tr class="separator:aa3ab52194f408696d8d4866311f96ec1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e134300db71bb73274bc5f7bfd42073 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a8e134300db71bb73274bc5f7bfd42073"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#a8e134300db71bb73274bc5f7bfd42073">vector</a> (int i)</td></tr>
<tr class="memdesc:a8e134300db71bb73274bc5f7bfd42073 inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return component of the vector part of the field. <br /></td></tr>
<tr class="separator:a8e134300db71bb73274bc5f7bfd42073 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83a48620b0a8bb1218135b328880bf4c inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a83a48620b0a8bb1218135b328880bf4c"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#a83a48620b0a8bb1218135b328880bf4c">vector</a> (int i) const</td></tr>
<tr class="memdesc:a83a48620b0a8bb1218135b328880bf4c inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return component of the vector part of the field. <br /></td></tr>
<tr class="separator:a83a48620b0a8bb1218135b328880bf4c inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6760e58b189285aa6d45864a6c638cb1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a6760e58b189285aa6d45864a6c638cb1"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>component</b> (int i)</td></tr>
<tr class="separator:a6760e58b189285aa6d45864a6c638cb1 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6ca1b060099cc75b5c7a0ba49060c4e inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="ad6ca1b060099cc75b5c7a0ba49060c4e"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html#ad6ca1b060099cc75b5c7a0ba49060c4e">component_raise</a> (int i)</td></tr>
<tr class="memdesc:ad6ca1b060099cc75b5c7a0ba49060c4e inherit pub_methods_classsirius_1_1_field4_d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Throws error in case of invalid access. <br /></td></tr>
<tr class="separator:ad6ca1b060099cc75b5c7a0ba49060c4e inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a066e5cb9cbd58539c2ccf5747b02eeed inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a066e5cb9cbd58539c2ccf5747b02eeed"></a>
<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>component</b> (int i) const</td></tr>
<tr class="separator:a066e5cb9cbd58539c2ccf5747b02eeed inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf95b126e3e692c2e93a01eba7b0d943 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="adf95b126e3e692c2e93a01eba7b0d943"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>zero</b> ()</td></tr>
<tr class="separator:adf95b126e3e692c2e93a01eba7b0d943 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa34675a4cefd019dfe6567024da36b17 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="aa34675a4cefd019dfe6567024da36b17"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>fft_transform</b> (int direction__)</td></tr>
<tr class="separator:aa34675a4cefd019dfe6567024da36b17 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf935423af950dc46a97852c1d787903 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="aaf935423af950dc46a97852c1d787903"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mixer_input</b> ()</td></tr>
<tr class="separator:aaf935423af950dc46a97852c1d787903 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00bbdc6c15c965463e8254509aec5170 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a00bbdc6c15c965463e8254509aec5170"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mixer_output</b> ()</td></tr>
<tr class="separator:a00bbdc6c15c965463e8254509aec5170 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af43079007c73c1d9427fb02aae6e0585 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="af43079007c73c1d9427fb02aae6e0585"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mixer_init</b> (<a class="el" href="../../d4/db0/structsirius_1_1_mixer__input.html">Mixer_input</a> mixer_cfg__)</td></tr>
<tr class="separator:af43079007c73c1d9427fb02aae6e0585 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3b5f8fb15546cb04ff186e1a76cd496 inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="aa3b5f8fb15546cb04ff186e1a76cd496"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>mix</b> (double rss_min__)</td></tr>
<tr class="separator:aa3b5f8fb15546cb04ff186e1a76cd496 inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af36a17ade3860cfdb872b42d9b11fbad inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="af36a17ade3860cfdb872b42d9b11fbad"></a>
<a class="el" href="../../d1/d76/classsirius_1_1_mixer.html">Mixer</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>mixer</b> ()</td></tr>
<tr class="separator:af36a17ade3860cfdb872b42d9b11fbad inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1b2e72b2168727b3a1c022f882d4eaa inherit pub_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="ae1b2e72b2168727b3a1c022f882d4eaa"></a>
<a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>ctx</b> ()</td></tr>
<tr class="separator:ae1b2e72b2168727b3a1c022f882d4eaa inherit pub_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a3c711c33b95fff9172c892d7dcc680fc"><td class="memItemLeft" align="right" valign="top"><a id="a3c711c33b95fff9172c892d7dcc680fc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>init_PAW</b> ()</td></tr>
<tr class="separator:a3c711c33b95fff9172c892d7dcc680fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fed308bfa56ea479d6937e80f66a87e"><td class="memItemLeft" align="right" valign="top"><a id="a0fed308bfa56ea479d6937e80f66a87e"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>xc_mt_PAW_nonmagnetic</b> (<a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; &amp;full_potential, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; const &amp;full_density, std::vector&lt; double &gt; const &amp;rho_core)</td></tr>
<tr class="separator:a0fed308bfa56ea479d6937e80f66a87e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a221e15e5ece6b65737408dfae1769743"><td class="memItemLeft" align="right" valign="top"><a id="a221e15e5ece6b65737408dfae1769743"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>xc_mt_PAW_collinear</b> (std::vector&lt; <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt;&gt; &amp;potential, std::vector&lt; <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt;&gt; const &amp;density, std::vector&lt; double &gt; const &amp;rho_core)</td></tr>
<tr class="separator:a221e15e5ece6b65737408dfae1769743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af197b6a80b0ac17dc86fce97452a9225"><td class="memItemLeft" align="right" valign="top"><a id="af197b6a80b0ac17dc86fce97452a9225"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>xc_mt_PAW_noncollinear</b> (std::vector&lt; <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt;&gt; &amp;potential, std::vector&lt; <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt;&gt; const &amp;density, std::vector&lt; double &gt; const &amp;rho_core)</td></tr>
<tr class="separator:af197b6a80b0ac17dc86fce97452a9225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a428a8d257c51acca6f2cda75bb436fde"><td class="memItemLeft" align="right" valign="top"><a id="a428a8d257c51acca6f2cda75bb436fde"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>calc_PAW_local_potential</b> (<a class="el" href="../../d1/def/structsirius_1_1_potential_1_1paw__potential__data__t.html">paw_potential_data_t</a> &amp;pdd, std::vector&lt; <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt;&gt; const &amp;ae_density, std::vector&lt; <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt;&gt; const &amp;ps_density)</td></tr>
<tr class="separator:a428a8d257c51acca6f2cda75bb436fde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64db1a46f1e1df544e799a1add3cbcb9"><td class="memItemLeft" align="right" valign="top"><a id="a64db1a46f1e1df544e799a1add3cbcb9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>calc_PAW_local_Dij</b> (<a class="el" href="../../d1/def/structsirius_1_1_potential_1_1paw__potential__data__t.html">paw_potential_data_t</a> &amp;pdd, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double, 4 &gt; &amp;paw_dij)</td></tr>
<tr class="separator:a64db1a46f1e1df544e799a1add3cbcb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe5c801841b68182567e4a446fa19142"><td class="memItemLeft" align="right" valign="top"><a id="abe5c801841b68182567e4a446fa19142"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>calc_PAW_hartree_potential</b> (<a class="el" href="../../d3/d50/classsirius_1_1_atom.html">Atom</a> &amp;atom, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; const &amp;full_density, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; &amp;full_potential)</td></tr>
<tr class="separator:abe5c801841b68182567e4a446fa19142"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23521be809d6ca206ead7502f27b82dd"><td class="memItemLeft" align="right" valign="top"><a id="a23521be809d6ca206ead7502f27b82dd"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>calc_PAW_one_elec_energy</b> (<a class="el" href="../../d1/def/structsirius_1_1_potential_1_1paw__potential__data__t.html">paw_potential_data_t</a> &amp;pdd, const <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 4 &gt; &amp;density_matrix, const <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double, 4 &gt; &amp;paw_dij)</td></tr>
<tr class="separator:a23521be809d6ca206ead7502f27b82dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3bc1de5a8c117611d0dc0e7dba408a9"><td class="memItemLeft" align="right" valign="top"><a id="af3bc1de5a8c117611d0dc0e7dba408a9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>add_paw_Dij_to_atom_Dmtrx</b> ()</td></tr>
<tr class="separator:af3bc1de5a8c117611d0dc0e7dba408a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a250e453096ce667899410b3bdb323484"><td class="memItemLeft" align="right" valign="top"><a id="a250e453096ce667899410b3bdb323484"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a250e453096ce667899410b3bdb323484">poisson_vmt</a> (<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const &amp;rho__, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 2 &gt; &amp;qmt__)</td></tr>
<tr class="memdesc:a250e453096ce667899410b3bdb323484"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute MT part of the potential and MT multipole moments. <br /></td></tr>
<tr class="separator:a250e453096ce667899410b3bdb323484"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1e5381fc52a6d366849c48daf4fdc32"><td class="memItemLeft" align="right" valign="top"><a id="ac1e5381fc52a6d366849c48daf4fdc32"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#ac1e5381fc52a6d366849c48daf4fdc32">poisson_add_pseudo_pw</a> (<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 2 &gt; &amp;qmt, <a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 2 &gt; &amp;qit, double_complex *rho_pw)</td></tr>
<tr class="memdesc:ac1e5381fc52a6d366849c48daf4fdc32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add contribution from the pseudocharge to the plane-wave expansion. <br /></td></tr>
<tr class="separator:ac1e5381fc52a6d366849c48daf4fdc32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4383d38a605d0b6367da339035e0130"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#ab4383d38a605d0b6367da339035e0130">generate_local_potential</a> ()</td></tr>
<tr class="memdesc:ab4383d38a605d0b6367da339035e0130"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate local part of pseudo potential.  <a href="#ab4383d38a605d0b6367da339035e0130">More...</a><br /></td></tr>
<tr class="separator:ab4383d38a605d0b6367da339035e0130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a160c56d355724305c00fed1c0078c69c"><td class="memItemLeft" align="right" valign="top"><a id="a160c56d355724305c00fed1c0078c69c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a160c56d355724305c00fed1c0078c69c">xc_mt_nonmagnetic</a> (<a class="el" href="../../d9/dbf/classsirius_1_1_radial__grid.html">Radial_grid</a>&lt; double &gt; const &amp;rgrid, std::vector&lt; <a class="el" href="../../d8/de5/classsirius_1_1_x_c__functional.html">XC_functional</a> &gt; &amp;xc_func, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; const &amp;rho_lm, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357acdb36c370b737074c455bf1ee75a2f56">function_domain_t::spatial</a>, double &gt; &amp;rho_tp, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357acdb36c370b737074c455bf1ee75a2f56">function_domain_t::spatial</a>, double &gt; &amp;vxc_tp, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357acdb36c370b737074c455bf1ee75a2f56">function_domain_t::spatial</a>, double &gt; &amp;exc_tp)</td></tr>
<tr class="memdesc:a160c56d355724305c00fed1c0078c69c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate non-spin polarized XC potential in the muffin-tins. <br /></td></tr>
<tr class="separator:a160c56d355724305c00fed1c0078c69c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9606543e95770d33b2afad3acceb10d8"><td class="memItemLeft" align="right" valign="top"><a id="a9606543e95770d33b2afad3acceb10d8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a9606543e95770d33b2afad3acceb10d8">xc_mt_magnetic</a> (<a class="el" href="../../d9/dbf/classsirius_1_1_radial__grid.html">Radial_grid</a>&lt; double &gt; const &amp;rgrid, std::vector&lt; <a class="el" href="../../d8/de5/classsirius_1_1_x_c__functional.html">XC_functional</a> &gt; &amp;xc_func, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; &amp;rho_up_lm, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357acdb36c370b737074c455bf1ee75a2f56">function_domain_t::spatial</a>, double &gt; &amp;rho_up_tp, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357ac6d79e22d837d4172867f7dce96d2a62">function_domain_t::spectral</a>, double &gt; &amp;rho_dn_lm, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357acdb36c370b737074c455bf1ee75a2f56">function_domain_t::spatial</a>, double &gt; &amp;rho_dn_tp, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357acdb36c370b737074c455bf1ee75a2f56">function_domain_t::spatial</a>, double &gt; &amp;vxc_up_tp, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357acdb36c370b737074c455bf1ee75a2f56">function_domain_t::spatial</a>, double &gt; &amp;vxc_dn_tp, <a class="el" href="../../d9/ddf/classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; <a class="el" href="../../de/df7/typedefs_8hpp.html#a1e9abc1cdcdeb1cc57c6bc9c630b0357acdb36c370b737074c455bf1ee75a2f56">function_domain_t::spatial</a>, double &gt; &amp;exc_tp)</td></tr>
<tr class="memdesc:a9606543e95770d33b2afad3acceb10d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate spin-polarized XC potential in the muffin-tins. <br /></td></tr>
<tr class="separator:a9606543e95770d33b2afad3acceb10d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b566572b8f15cd252e2d86ca0be185e"><td class="memItemLeft" align="right" valign="top"><a id="a8b566572b8f15cd252e2d86ca0be185e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a8b566572b8f15cd252e2d86ca0be185e">xc_mt</a> (<a class="el" href="../../d7/d05/classsirius_1_1_density.html">Density</a> const &amp;density__)</td></tr>
<tr class="memdesc:a8b566572b8f15cd252e2d86ca0be185e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate XC potential in the muffin-tins. <br /></td></tr>
<tr class="separator:a8b566572b8f15cd252e2d86ca0be185e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac624a14a70b218d3d9c0b1a1c3583faa"><td class="memTemplParams" colspan="2">template&lt;bool add_pseudo_core__&gt; </td></tr>
<tr class="memitem:ac624a14a70b218d3d9c0b1a1c3583faa"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#ac624a14a70b218d3d9c0b1a1c3583faa">xc_rg_nonmagnetic</a> (<a class="el" href="../../d7/d05/classsirius_1_1_density.html">Density</a> const &amp;density__)</td></tr>
<tr class="memdesc:ac624a14a70b218d3d9c0b1a1c3583faa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate non-magnetic XC potential on the regular real-space grid.  <a href="#ac624a14a70b218d3d9c0b1a1c3583faa">More...</a><br /></td></tr>
<tr class="separator:ac624a14a70b218d3d9c0b1a1c3583faa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ae1ae4feb183313f6fcf666cee475d2"><td class="memTemplParams" colspan="2"><a id="a2ae1ae4feb183313f6fcf666cee475d2"></a>
template&lt;bool add_pseudo_core__&gt; </td></tr>
<tr class="memitem:a2ae1ae4feb183313f6fcf666cee475d2"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a2ae1ae4feb183313f6fcf666cee475d2">xc_rg_magnetic</a> (<a class="el" href="../../d7/d05/classsirius_1_1_density.html">Density</a> const &amp;density__)</td></tr>
<tr class="memdesc:a2ae1ae4feb183313f6fcf666cee475d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate magnetic XC potential on the regular real-space grid. <br /></td></tr>
<tr class="separator:a2ae1ae4feb183313f6fcf666cee475d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aa94f0458ddf8c127759e0b73de16acc6"><td class="memItemLeft" align="right" valign="top"><a id="aa94f0458ddf8c127759e0b73de16acc6"></a>
<a class="el" href="../../d6/dd1/classsirius_1_1_unit__cell.html">Unit_cell</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>unit_cell_</b></td></tr>
<tr class="separator:aa94f0458ddf8c127759e0b73de16acc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aa716bb6ae5c3b5ca6ae44b262fac94"><td class="memItemLeft" align="right" valign="top"><a id="a1aa716bb6ae5c3b5ca6ae44b262fac94"></a>
<a class="el" href="../../da/d70/classsddk_1_1_communicator.html">Communicator</a> const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>comm_</b></td></tr>
<tr class="separator:a1aa716bb6ae5c3b5ca6ae44b262fac94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67c9d72f0486c5fe5fd802146cdcbb8a"><td class="memItemLeft" align="right" valign="top"><a id="a67c9d72f0486c5fe5fd802146cdcbb8a"></a>
std::unique_ptr&lt; <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a67c9d72f0486c5fe5fd802146cdcbb8a">hartree_potential_</a></td></tr>
<tr class="memdesc:a67c9d72f0486c5fe5fd802146cdcbb8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hartree potential. <br /></td></tr>
<tr class="separator:a67c9d72f0486c5fe5fd802146cdcbb8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa048fa432a3d56bd07e3fac7efc31cf0"><td class="memItemLeft" align="right" valign="top"><a id="aa048fa432a3d56bd07e3fac7efc31cf0"></a>
std::unique_ptr&lt; <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#aa048fa432a3d56bd07e3fac7efc31cf0">xc_potential_</a></td></tr>
<tr class="memdesc:aa048fa432a3d56bd07e3fac7efc31cf0"><td class="mdescLeft">&#160;</td><td class="mdescRight">XC potential. <br /></td></tr>
<tr class="separator:aa048fa432a3d56bd07e3fac7efc31cf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5df64003cb5a6a88239e52c68bf0717f"><td class="memItemLeft" align="right" valign="top"><a id="a5df64003cb5a6a88239e52c68bf0717f"></a>
std::unique_ptr&lt; <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a5df64003cb5a6a88239e52c68bf0717f">xc_energy_density_</a></td></tr>
<tr class="memdesc:a5df64003cb5a6a88239e52c68bf0717f"><td class="mdescLeft">&#160;</td><td class="mdescRight">XC energy per unit particle. <br /></td></tr>
<tr class="separator:a5df64003cb5a6a88239e52c68bf0717f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01b360ea311c193d58888e4a1db7aaa8"><td class="memItemLeft" align="right" valign="top"><a id="a01b360ea311c193d58888e4a1db7aaa8"></a>
std::unique_ptr&lt; <a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a01b360ea311c193d58888e4a1db7aaa8">local_potential_</a></td></tr>
<tr class="memdesc:a01b360ea311c193d58888e4a1db7aaa8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local part of pseudopotential. <br /></td></tr>
<tr class="separator:a01b360ea311c193d58888e4a1db7aaa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bfbcae94d3935db0be03f732f98001b"><td class="memItemLeft" align="right" valign="top">std::array&lt; std::unique_ptr&lt; <a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; &gt;, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a8bfbcae94d3935db0be03f732f98001b">vsigma_</a></td></tr>
<tr class="memdesc:a8bfbcae94d3935db0be03f732f98001b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derivative \( \partial \epsilon^{XC} / \partial \sigma_{\alpha} \).  <a href="#a8bfbcae94d3935db0be03f732f98001b">More...</a><br /></td></tr>
<tr class="separator:a8bfbcae94d3935db0be03f732f98001b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a012796229f9d5c055dbd1fe7112dca27"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a012796229f9d5c055dbd1fe7112dca27">dveff_</a></td></tr>
<tr class="memdesc:a012796229f9d5c055dbd1fe7112dca27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to compute SCF correction to forces.  <a href="#a012796229f9d5c055dbd1fe7112dca27">More...</a><br /></td></tr>
<tr class="separator:a012796229f9d5c055dbd1fe7112dca27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1dc9c74958d3e7d11bbfbb1aa0bbb4b"><td class="memItemLeft" align="right" valign="top"><a id="ae1dc9c74958d3e7d11bbfbb1aa0bbb4b"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>sbessel_mom_</b></td></tr>
<tr class="separator:ae1dc9c74958d3e7d11bbfbb1aa0bbb4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2d7e1a92fa0ce8754648315bb4acce3"><td class="memItemLeft" align="right" valign="top"><a id="ab2d7e1a92fa0ce8754648315bb4acce3"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>sbessel_mt_</b></td></tr>
<tr class="separator:ab2d7e1a92fa0ce8754648315bb4acce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6095f630f2f5b843d901538a0f37f04e"><td class="memItemLeft" align="right" valign="top"><a id="a6095f630f2f5b843d901538a0f37f04e"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>gamma_factors_R_</b></td></tr>
<tr class="separator:a6095f630f2f5b843d901538a0f37f04e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7648173e3f1d0edc91d221c934b8e736"><td class="memItemLeft" align="right" valign="top"><a id="a7648173e3f1d0edc91d221c934b8e736"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>lmax_</b></td></tr>
<tr class="separator:a7648173e3f1d0edc91d221c934b8e736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75a43cb1413d564463a2895d691a959d"><td class="memItemLeft" align="right" valign="top"><a id="a75a43cb1413d564463a2895d691a959d"></a>
std::unique_ptr&lt; <a class="el" href="../../d1/d08/classsirius_1_1_s_h_t.html">SHT</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>sht_</b></td></tr>
<tr class="separator:a75a43cb1413d564463a2895d691a959d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a781473e76bf903a5822000662c3b4414"><td class="memItemLeft" align="right" valign="top"><a id="a781473e76bf903a5822000662c3b4414"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>pseudo_density_order_</b> {9}</td></tr>
<tr class="separator:a781473e76bf903a5822000662c3b4414"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1010a62cf2d65377fb1a8c0020849b24"><td class="memItemLeft" align="right" valign="top"><a id="a1010a62cf2d65377fb1a8c0020849b24"></a>
std::vector&lt; double_complex &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>zil_</b></td></tr>
<tr class="separator:a1010a62cf2d65377fb1a8c0020849b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab01d0a3fd83573cf6b6b34e3d1ef6ce7"><td class="memItemLeft" align="right" valign="top"><a id="ab01d0a3fd83573cf6b6b34e3d1ef6ce7"></a>
std::vector&lt; double_complex &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>zilm_</b></td></tr>
<tr class="separator:ab01d0a3fd83573cf6b6b34e3d1ef6ce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2a1abca8860b91354ab61c141b76a4f"><td class="memItemLeft" align="right" valign="top"><a id="ae2a1abca8860b91354ab61c141b76a4f"></a>
std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>l_by_lm_</b></td></tr>
<tr class="separator:ae2a1abca8860b91354ab61c141b76a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae474479d1266ed12f5196d887f9b88e1"><td class="memItemLeft" align="right" valign="top"><a id="ae474479d1266ed12f5196d887f9b88e1"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>gvec_ylm_</b></td></tr>
<tr class="separator:ae474479d1266ed12f5196d887f9b88e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b3cee2d4ec5d7c841bb401729a1960a"><td class="memItemLeft" align="right" valign="top"><a id="a1b3cee2d4ec5d7c841bb401729a1960a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>energy_vha_</b></td></tr>
<tr class="separator:a1b3cee2d4ec5d7c841bb401729a1960a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0126d2afa48714b359eede273905a64c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a0126d2afa48714b359eede273905a64c">vh_el_</a></td></tr>
<tr class="memdesc:a0126d2afa48714b359eede273905a64c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Electronic part of Hartree potential.  <a href="#a0126d2afa48714b359eede273905a64c">More...</a><br /></td></tr>
<tr class="separator:a0126d2afa48714b359eede273905a64c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab013e57ad7b7e10dcb6526379b768eb"><td class="memItemLeft" align="right" valign="top"><a id="aab013e57ad7b7e10dcb6526379b768eb"></a>
std::vector&lt; <a class="el" href="../../d8/de5/classsirius_1_1_x_c__functional.html">XC_functional</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>xc_func_</b></td></tr>
<tr class="separator:aab013e57ad7b7e10dcb6526379b768eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf213a65c122ebe4ed46b02560174da8"><td class="memItemLeft" align="right" valign="top"><a id="adf213a65c122ebe4ed46b02560174da8"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#adf213a65c122ebe4ed46b02560174da8">veff_pw_</a></td></tr>
<tr class="memdesc:adf213a65c122ebe4ed46b02560174da8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plane-wave coefficients of the effective potential weighted by the unit step-function. <br /></td></tr>
<tr class="separator:adf213a65c122ebe4ed46b02560174da8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a681931c08f11ddea4b3709280d7b309d"><td class="memItemLeft" align="right" valign="top"><a id="a681931c08f11ddea4b3709280d7b309d"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a681931c08f11ddea4b3709280d7b309d">rm_inv_pw_</a></td></tr>
<tr class="memdesc:a681931c08f11ddea4b3709280d7b309d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plane-wave coefficients of the inverse relativistic mass weighted by the unit step-function. <br /></td></tr>
<tr class="separator:a681931c08f11ddea4b3709280d7b309d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71c1a995bc68a97d48e004999cd2b8a0"><td class="memItemLeft" align="right" valign="top"><a id="a71c1a995bc68a97d48e004999cd2b8a0"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a71c1a995bc68a97d48e004999cd2b8a0">rm2_inv_pw_</a></td></tr>
<tr class="memdesc:a71c1a995bc68a97d48e004999cd2b8a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plane-wave coefficients of the squared inverse relativistic mass weighted by the unit step-function. <br /></td></tr>
<tr class="separator:a71c1a995bc68a97d48e004999cd2b8a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a444caac8abc61a7b0c7b1cf1685ab67d"><td class="memItemLeft" align="right" valign="top"><a id="a444caac8abc61a7b0c7b1cf1685ab67d"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>paw_hartree_energies_</b></td></tr>
<tr class="separator:a444caac8abc61a7b0c7b1cf1685ab67d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb48c608fe5fdc14b200ec50a21bca12"><td class="memItemLeft" align="right" valign="top"><a id="acb48c608fe5fdc14b200ec50a21bca12"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>paw_xc_energies_</b></td></tr>
<tr class="separator:acb48c608fe5fdc14b200ec50a21bca12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fa98d38946a062e90e717375fa5a66a"><td class="memItemLeft" align="right" valign="top"><a id="a4fa98d38946a062e90e717375fa5a66a"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>paw_core_energies_</b></td></tr>
<tr class="separator:a4fa98d38946a062e90e717375fa5a66a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a543259d27f0e07764ce7347c7adf3018"><td class="memItemLeft" align="right" valign="top"><a id="a543259d27f0e07764ce7347c7adf3018"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>paw_one_elec_energies_</b></td></tr>
<tr class="separator:a543259d27f0e07764ce7347c7adf3018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ecb8ae450a712a26dc1b91ad8348e28"><td class="memItemLeft" align="right" valign="top"><a id="a6ecb8ae450a712a26dc1b91ad8348e28"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>paw_hartree_total_energy_</b> {0.0}</td></tr>
<tr class="separator:a6ecb8ae450a712a26dc1b91ad8348e28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b07d2b2ee776efdb34a64b4041ecb87"><td class="memItemLeft" align="right" valign="top"><a id="a0b07d2b2ee776efdb34a64b4041ecb87"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>paw_xc_total_energy_</b> {0.0}</td></tr>
<tr class="separator:a0b07d2b2ee776efdb34a64b4041ecb87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51b0a21e62d33305653555820c8e656a"><td class="memItemLeft" align="right" valign="top"><a id="a51b0a21e62d33305653555820c8e656a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>paw_total_core_energy_</b> {0.0}</td></tr>
<tr class="separator:a51b0a21e62d33305653555820c8e656a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1328b6bfd09912ade6b156476cd2752"><td class="memItemLeft" align="right" valign="top"><a id="af1328b6bfd09912ade6b156476cd2752"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>paw_one_elec_energy_</b> {0.0}</td></tr>
<tr class="separator:af1328b6bfd09912ade6b156476cd2752"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a190a0617e74f0cce2aed286680c74a17"><td class="memItemLeft" align="right" valign="top"><a id="a190a0617e74f0cce2aed286680c74a17"></a>
std::vector&lt; <a class="el" href="../../d1/def/structsirius_1_1_potential_1_1paw__potential__data__t.html">paw_potential_data_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>paw_potential_data_</b></td></tr>
<tr class="separator:a190a0617e74f0cce2aed286680c74a17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1be1519ea9df817fccd83552594509c4"><td class="memItemLeft" align="right" valign="top"><a id="a1be1519ea9df817fccd83552594509c4"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double, 4 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>paw_dij_</b></td></tr>
<tr class="separator:a1be1519ea9df817fccd83552594509c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a556afd6462fb98e93aa0293651273a"><td class="memItemLeft" align="right" valign="top"><a id="a4a556afd6462fb98e93aa0293651273a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>max_paw_basis_size_</b> {0}</td></tr>
<tr class="separator:a4a556afd6462fb98e93aa0293651273a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcb103eec275ae68e5030bbabbe43539"><td class="memItemLeft" align="right" valign="top"><a id="afcb103eec275ae68e5030bbabbe43539"></a>
<a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt; double, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>aux_bf_</b></td></tr>
<tr class="separator:afcb103eec275ae68e5030bbabbe43539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2c36faeee53cce7b5f705ee7c60a3d2"><td class="memItemLeft" align="right" valign="top"><a id="aa2c36faeee53cce7b5f705ee7c60a3d2"></a>
std::unique_ptr&lt; <a class="el" href="../../d7/d27/classsirius_1_1_hubbard.html">Hubbard</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#aa2c36faeee53cce7b5f705ee7c60a3d2">U_</a></td></tr>
<tr class="memdesc:aa2c36faeee53cce7b5f705ee7c60a3d2"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d7/d27/classsirius_1_1_hubbard.html" title="Apply Hubbard correction in the colinear case.">Hubbard</a> potential correction. <br /></td></tr>
<tr class="separator:aa2c36faeee53cce7b5f705ee7c60a3d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b2c954a61491589a599738167416300"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0b/classsirius_1_1_potential.html#a8b2c954a61491589a599738167416300">scale_rho_xc_</a> {1}</td></tr>
<tr class="memdesc:a8b2c954a61491589a599738167416300"><td class="mdescLeft">&#160;</td><td class="mdescRight">A debug variable to scale the density when computing the XC potential.  <a href="#a8b2c954a61491589a599738167416300">More...</a><br /></td></tr>
<tr class="separator:a8b2c954a61491589a599738167416300"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classsirius_1_1_field4_d"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classsirius_1_1_field4_d')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html">sirius::Field4D</a></td></tr>
<tr class="memitem:a7f248a9f9365c8311c0cb266ec4429ba inherit pro_methods_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a7f248a9f9365c8311c0cb266ec4429ba"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>symmetrize</b> (<a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *f__, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *gz__, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *gx__, <a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *gy__)</td></tr>
<tr class="separator:a7f248a9f9365c8311c0cb266ec4429ba inherit pro_methods_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classsirius_1_1_field4_d"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classsirius_1_1_field4_d')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../d3/d1f/classsirius_1_1_field4_d.html">sirius::Field4D</a></td></tr>
<tr class="memitem:a7feb66284564598af275959d77e2c10b inherit pro_attribs_classsirius_1_1_field4_d"><td class="memItemLeft" align="right" valign="top"><a id="a7feb66284564598af275959d77e2c10b"></a>
<a class="el" href="../../d6/d66/classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>ctx_</b></td></tr>
<tr class="separator:a7feb66284564598af275959d77e2c10b inherit pro_attribs_classsirius_1_1_field4_d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Generate effective potential from charge density and magnetization. </p>
<dl class="section note"><dt>Note</dt><dd>At some point we need to update the atomic potential with the new MT potential. This is simple if the effective potential is a global function. Otherwise we need to pass the effective potential between MPI ranks. This is also simple, but requires some time. It is also easier to mix the global functions. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/df2/potential_8hpp_source.html#l00038">38</a> of file <a class="el" href="../../de/df2/potential_8hpp_source.html">potential.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ab4383d38a605d0b6367da339035e0130"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4383d38a605d0b6367da339035e0130">&#9670;&nbsp;</a></span>generate_local_potential()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Potential::generate_local_potential </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate local part of pseudo potential. </p>
<p>Total local potential is a lattice sum: </p><p class="formulaDsp">
\[ V({\bf r}) = \sum_{{\bf T},\alpha} V_{\alpha}({\bf r} - {\bf T} - {\bf \tau}_{\alpha}) \]
</p>
<p> We want to compute it's plane-wave expansion coefficients: </p><p class="formulaDsp">
\[ V({\bf G}) = \frac{1}{V} \int e^{-i{\bf Gr}} V({\bf r}) d{\bf r} = \frac{1}{V} \sum_{{\bf T},\alpha} \int e^{-i{\bf Gr}}V_{\alpha}({\bf r} - {\bf T} - {\bf \tau}_{\alpha})d{\bf r} \]
</p>
<p> Standard change of variables: \( {\bf r}&#39; = {\bf r} - {\bf T} - {\bf \tau}_{\alpha},\; {\bf r} = {\bf r}&#39; + {\bf T} + {\bf \tau}_{\alpha} \) leads to: </p><p class="formulaDsp">
\[ V({\bf G}) = \frac{1}{V} \sum_{{\bf T},\alpha} \int e^{-i{\bf G}({\bf r}&#39; + {\bf T} + {\bf \tau}_{\alpha})}V_{\alpha}({\bf r}&#39;)d{\bf r&#39;} = \frac{N}{V} \sum_{\alpha} \int e^{-i{\bf G}({\bf r}&#39; + {\bf \tau}_{\alpha})}V_{\alpha}({\bf r}&#39;)d{\bf r&#39;} = \frac{1}{\Omega} \sum_{\alpha} e^{-i {\bf G} {\bf \tau}_{\alpha} } \int e^{-i{\bf G}{\bf r}}V_{\alpha}({\bf r})d{\bf r} \]
</p>
<p> Using the well-known expansion of a plane wave in terms of spherical Bessel functions: </p><p class="formulaDsp">
\[ e^{i{\bf G}{\bf r}}=4\pi \sum_{\ell m} i^\ell j_{\ell}(Gr)Y_{\ell m}^{*}({\bf \hat G})Y_{\ell m}({\bf \hat r}) \]
</p>
<p> and remembering that for \( \ell = 0 \) (potential is sphericla) \( j_{0}(x) = \sin(x) / x \) we have: </p><p class="formulaDsp">
\[ V_{\alpha}({\bf G}) = \int V_{\alpha}(r) 4\pi \frac{\sin(Gr)}{Gr} Y^{*}_{00} Y_{00} r^2 \sin(\theta) dr d \phi d\theta = 4\pi \int V_{\alpha}(r) \frac{\sin(Gr)}{Gr} r^2 dr \]
</p>
<p> The tricky part comes next: \( V_{\alpha}({\bf r}) \) is a long-range potential &ndash; it decays slowly as \( -Z_{\alpha}^{p}/r \) and the straightforward integration with sperical Bessel function is numerically unstable. For \( {\bf G} = 0 \) an extra term \( Z_{\alpha}^p/r \), corresponding to the potential of pseudo-ion, is added to and removed from the local part of the atomic pseudopotential \( V_{\alpha}({\bf r}) \): </p><p class="formulaDsp">
\[ V_{\alpha}({\bf G} = 0) = \int V_{\alpha}({\bf r})d{\bf r} \Rightarrow 4\pi \int \Big( V_{\alpha}(r) + \frac{Z_{\alpha}^p}{r} \Big) r^2 dr - 4\pi \int \Big( \frac{Z_{\alpha}^p}{r} \Big) r^2 dr \]
</p>
<p> Second term corresponds to the average electrostatic potential of ions and it is ignored (like the \( {\bf G} = 0 \) term in the Hartree potential of electrons). For \( G \ne 0 \) the following trick is done: \( Z_{\alpha}^p {\rm erf}(r) / r \) is added to and removed from \( V_{\alpha}(r) \). The idea is to make potential decay quickly and then take the extra contribution analytically. We have: </p><p class="formulaDsp">
\[ V_{\alpha}({\bf G}) = 4\pi \int \Big(V_{\alpha}(r) + Z_{\alpha}^p \frac{{\rm erf}(r)} {r} - Z_{\alpha}^p \frac{{\rm erf}(r)}{r}\Big) \frac{\sin(Gr)}{Gr} r^2 dr \]
</p>
<p> Analytical contribution from the error function is computed using the 1D Fourier transform in complex plane: </p><p class="formulaDsp">
\[ \frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} {\rm erf}(t) e^{i\omega t} dt = \frac{i e^{-\frac{\omega ^2}{4}} \sqrt{\frac{2}{\pi }}}{\omega } \]
</p>
<p> from which we immediately get </p><p class="formulaDsp">
\[ \int_{0}^{\infty} \frac{{\rm erf}(r)}{r} \frac{\sin(Gr)}{Gr} r^2 dr = \frac{e^{-\frac{G^2}{4}}}{G^2} \]
</p>
<p> The final expression for the local potential radial integrals for \( G \ne 0 \) take the following form: </p><p class="formulaDsp">
\[ 4\pi \int \Big(V_{\alpha}(r) r + Z_{\alpha}^p {\rm erf}(r) \Big) \frac{\sin(Gr)}{G} dr - Z_{\alpha}^p \frac{e^{-\frac{G^2}{4}}}{G^2} \]
</p>
 
<p class="definition">Definition at line <a class="el" href="../../de/df2/potential_8hpp_source.html#l00259">259</a> of file <a class="el" href="../../de/df2/potential_8hpp_source.html">potential.hpp</a>.</p>

</div>
</div>
<a id="ac624a14a70b218d3d9c0b1a1c3583faa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac624a14a70b218d3d9c0b1a1c3583faa">&#9670;&nbsp;</a></span>xc_rg_nonmagnetic()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool add_pseudo_core__&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">template void sirius::Potential::xc_rg_nonmagnetic&lt; false &gt; </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d05/classsirius_1_1_density.html">Density</a> const &amp;&#160;</td>
          <td class="paramname"><em>density__</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate non-magnetic XC potential on the regular real-space grid. </p>
<ul>
<li>this will create a full list of G-vectors of the size of the FFT box */ </li>
</ul>

<p class="definition">Definition at line <a class="el" href="../../d6/d2b/xc_8cpp_source.html#l00484">484</a> of file <a class="el" href="../../d6/d2b/xc_8cpp_source.html">xc.cpp</a>.</p>

</div>
</div>
<a id="a5e30e263faee37bffa8da7c001e88a9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e30e263faee37bffa8da7c001e88a9d">&#9670;&nbsp;</a></span>poisson()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Potential::poisson </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d6d/classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; const &amp;&#160;</td>
          <td class="paramname"><em>rho</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Poisson solver. </p>
<p>Detailed explanation is available in:</p><ul>
<li>Weinert, M. (1981). Solution of Poisson's equation: beyond Ewald-type methods. Journal of Mathematical Physics, 22(11), 24332439. doi:10.1063/1.524800</li>
<li>Classical Electrodynamics Third Edition by J. D. Jackson.</li>
</ul>
<p>Solution of Poisson's equation for the muffin-tin geometry is carried out in several steps:</p><ul>
<li>True multipole moments \( q_{\ell m}^{\alpha} \) of the muffin-tin charge density are computed.</li>
<li>Pseudocharge density is introduced. Pseudocharge density coincides with the true charge density in the interstitial region and it's multipole moments inside muffin-tin spheres coincide with the true multipole moments.</li>
<li>Poisson's equation for the pseudocharge density is solved in the plane-wave domain. It gives the correct interstitial potential and correct muffin-tin boundary values.</li>
<li>Finally, muffin-tin part of potential is found by solving Poisson's equation in spherical coordinates with Dirichlet boundary conditions.</li>
</ul>
<p>We start by computing true multipole moments of the charge density inside the muffin-tin spheres: </p><p class="formulaDsp">
\[ q_{\ell m}^{\alpha} = \int Y_{\ell m}^{*}(\hat {\bf r}) r^{\ell} \rho({\bf r}) d {\bf r} = \int \rho_{\ell m}^{\alpha}(r) r^{\ell + 2} dr \]
</p>
<p> and for the nucleus with charge density \( \rho(r, \theta, \phi) = -\frac{Z \delta(r)}{4 \pi r^2} \): </p><p class="formulaDsp">
\[ q_{00}^{\alpha} = \int Y_{0 0} \frac{-Z_{\alpha} \delta(r)}{4 \pi r^2} r^2 \sin \theta dr d\phi d\theta = -Z_{\alpha} Y_{00} \]
</p>
<p>Now we need to get the multipole moments of the interstitial charge density \( \rho^{I}({\bf r}) \) inside muffin-tin spheres. We need this in order to estimate the amount of pseudocharge to be added to \( \rho^{I}({\bf r}) \) to get the pseudocharge multipole moments equal to the true multipole moments. We want to compute </p><p class="formulaDsp">
\[ q_{\ell m}^{I,\alpha} = \int Y_{\ell m}^{*}(\hat {\bf r}) r^{\ell} \rho^{I}({\bf r}) d {\bf r} \]
</p>
<p> where </p><p class="formulaDsp">
\[ \rho^{I}({\bf r}) = \sum_{\bf G}e^{i{\bf Gr}} \rho({\bf G}) \]
</p>
<p>Recall the spherical plane wave expansion: </p><p class="formulaDsp">
\[ e^{i{\bf G r}}=4\pi e^{i{\bf G r}_{\alpha}} \sum_{\ell m} i^\ell j_{\ell}(G|{\bf r}-{\bf r}_{\alpha}|) Y_{\ell m}^{*}({\bf \hat G}) Y_{\ell m}(\widehat{{\bf r}-{\bf r}_{\alpha}}) \]
</p>
<p> Multipole moments of each plane-wave are computed as: </p><p class="formulaDsp">
\[ q_{\ell m}^{\alpha}({\bf G}) = 4 \pi e^{i{\bf G r}_{\alpha}} Y_{\ell m}^{*}({\bf \hat G}) i^{\ell} \int_{0}^{R} j_{\ell}(Gr) r^{\ell + 2} dr = 4 \pi e^{i{\bf G r}_{\alpha}} Y_{\ell m}^{*}({\bf \hat G}) i^{\ell} \left\{\begin{array}{ll} \frac{R^{\ell + 2} j_{\ell + 1}(GR)}{G} &amp; G \ne 0 \\ \frac{R^3}{3} \delta_{\ell 0} &amp; G = 0 \end{array} \right. \]
</p>
<p>Final expression for the muffin-tin multipole moments of the interstitial charge denisty: </p><p class="formulaDsp">
\[ q_{\ell m}^{I,\alpha} = \sum_{\bf G}\rho({\bf G}) q_{\ell m}^{\alpha}({\bf G}) \]
</p>
<p>Now we are going to modify interstitial charge density inside the muffin-tin region in order to get the true multipole moments. We will add a pseudodensity of the form: </p><p class="formulaDsp">
\[ P({\bf r}) = \sum_{\ell m} p_{\ell m}^{\alpha} Y_{\ell m}(\hat {\bf r}) r^{\ell} \left(1-\frac{r^2}{R^2}\right)^n \]
</p>
<p> Radial functions of the pseudodensity are chosen in a special way. First, they produce a confined and smooth functions inside muffin-tins and second (most important) plane-wave coefficients of the pseudodensity can be computed analytically. Let's find the relation between \( p_{\ell m}^{\alpha} \) coefficients and true and interstitial multipole moments first. We are searching for the pseudodensity which restores the true multipole moments: </p><p class="formulaDsp">
\[ \int Y_{\ell m}^{*}(\hat {\bf r}) r^{\ell} \Big(\rho^{I}({\bf r}) + P({\bf r})\Big) d {\bf r} = q_{\ell m}^{\alpha} \]
</p>
<p> Then </p><p class="formulaDsp">
\[ p_{\ell m}^{\alpha} = \frac{q_{\ell m}^{\alpha} - q_{\ell m}^{I,\alpha}} {\int r^{2 \ell + 2} \left(1-\frac{r^2}{R^2}\right)^n dr} = (q_{\ell m}^{\alpha} - q_{\ell m}^{I,\alpha}) \frac{2 \Gamma(5/2 + \ell + n)}{R^{2\ell + 3}\Gamma(3/2 + \ell) \Gamma(n + 1)} \]
</p>
<p>Now let's find the plane-wave coefficients of \( P({\bf r}) \) inside each muffin-tin: </p><p class="formulaDsp">
\[ P^{\alpha}({\bf G}) = \frac{4\pi e^{-i{\bf G r}_{\alpha}}}{\Omega} \sum_{\ell m} (-i)^{\ell} Y_{\ell m}({\bf \hat G}) p_{\ell m}^{\alpha} \int_{0}^{R} j_{\ell}(G r) r^{\ell} \left(1-\frac{r^2}{R^2}\right)^n r^2 dr \]
</p>
<p>Integral of the spherical Bessel function with the radial pseudodensity component is taken analytically: </p><p class="formulaDsp">
\[ \int_{0}^{R} j_{\ell}(G r) r^{\ell} \left(1-\frac{r^2}{R^2}\right)^n r^2 dr = 2^n R^{\ell + 3} (GR)^{-n - 1} \Gamma(n + 1) j_{n + \ell + 1}(GR) \]
</p>
<p>The final expression for the pseudodensity plane-wave component is: </p><p class="formulaDsp">
\[ P^{\alpha}({\bf G}) = \frac{4\pi e^{-i{\bf G r}_{\alpha}}}{\Omega} \sum_{\ell m} (-i)^{\ell} Y_{\ell m}({\bf \hat G}) (q_{\ell m}^{\alpha} - q_{\ell m}^{I,\alpha}) \Big( \frac{2}{GR} \Big)^{n+1} \frac{ \Gamma(5/2 + n + \ell) } {R^{\ell} \Gamma(3/2+\ell)} j_{n + \ell + 1}(GR) \]
</p>
<p>For \( G=0 \) only \( \ell = 0 \) contribution survives: </p><p class="formulaDsp">
\[ P^{\alpha}({\bf G}=0) = \frac{4\pi}{\Omega} Y_{00} (q_{00}^{\alpha} - q_{00}^{I,\alpha}) \]
</p>
<p>We can now sum the contributions from all muffin-tin spheres and obtain a modified charge density, which is equal to the exact charge density in the interstitial region and which has correct multipole moments inside muffin-tin spheres: </p><p class="formulaDsp">
\[ \tilde \rho({\bf G}) = \rho({\bf G}) + \sum_{\alpha} P^{\alpha}({\bf G}) \]
</p>
<p> This density is used to solve the Poisson's equation in the plane-wave domain: </p><p class="formulaDsp">
\[ V_{H}({\bf G}) = \frac{4 \pi \tilde \rho({\bf G})}{G^2} \]
</p>
<p> The potential is correct in the interstitial region and also on the muffin-tin surface. We will use it to find the boundary conditions for the potential inside the muffin-tins. Using spherical plane-wave expansion we get: </p><p class="formulaDsp">
\[ V^{\alpha}_{\ell m}(R) = \sum_{\bf G} V_{H}({\bf G}) 4\pi e^{i{\bf G r}_{\alpha}} i^\ell j_{\ell}^{\alpha}(GR) Y_{\ell m}^{*}({\bf \hat G}) \]
</p>
<p>As soon as the muffin-tin boundary conditions for the potential are known, we can find the potential inside spheres using Dirichlet Green's function: </p><p class="formulaDsp">
\[ V({\bf x}) = \int \rho({\bf x&#39;})G_D({\bf x},{\bf x&#39;}) d{\bf x&#39;} - \frac{1}{4 \pi} \int_{S} V({\bf x&#39;}) \frac{\partial G_D}{\partial n&#39;} d{\bf S&#39;} \]
</p>
<p> where Dirichlet Green's function for the sphere is defined as: </p><p class="formulaDsp">
\[ G_D({\bf x},{\bf x&#39;}) = 4\pi \sum_{\ell m} \frac{Y_{\ell m}^{*}({\bf \hat x&#39;}) Y_{\ell m}(\hat {\bf x})}{2\ell + 1} \frac{r_{&lt;}^{\ell}}{r_{&gt;}^{\ell+1}}\Biggl(1 - \Big( \frac{r_{&gt;}}{R} \Big)^{2\ell + 1} \Biggr) \]
</p>
<p> and it's normal derivative at the surface is equal to: </p><p class="formulaDsp">
\[ \frac{\partial G_D}{\partial n&#39;} = -\frac{4 \pi}{R^2} \sum_{\ell m} \Big( \frac{r}{R} \Big)^{\ell} Y_{\ell m}^{*}({\bf \hat x&#39;}) Y_{\ell m}(\hat {\bf x}) \]
</p>
 
<p class="definition">Definition at line <a class="el" href="../../d8/dcd/poisson_8cpp_source.html#l00136">136</a> of file <a class="el" href="../../d8/dcd/poisson_8cpp_source.html">poisson.cpp</a>.</p>

</div>
</div>
<a id="a998c461b7cd69e56f4c4b0b547781737"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a998c461b7cd69e56f4c4b0b547781737">&#9670;&nbsp;</a></span>xc()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool add_pseudo_core__&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">template void sirius::Potential::xc&lt; false &gt; </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d05/classsirius_1_1_density.html">Density</a> const &amp;&#160;</td>
          <td class="paramname"><em>rho__</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate XC potential and energy density. </p>
<p>In case of spin-unpolarized GGA the XC potential has the following expression: </p><p class="formulaDsp">
\[ V_{XC}({\bf r}) = \frac{\partial}{\partial \rho} \varepsilon_{xc}(\rho, \nabla \rho) - \nabla \frac{\partial}{\partial (\nabla \rho)} \varepsilon_{xc}(\rho, \nabla \rho) = \frac{\partial}{\partial \rho} \varepsilon_{xc}(\rho, \nabla \rho) - \sum_{\alpha} \frac{\partial}{\partial r_{\alpha}} \frac{\partial \varepsilon_{xc}(\rho, \nabla \rho) }{\partial g_{\alpha}} \]
</p>
<p> where \( {\bf g}({\bf r}) = \nabla \rho({\bf r}) \).</p>
<p>LibXC packs the gradient information into the so-called <em>sigma</em> array: </p><p class="formulaDsp">
\[ \sigma = \nabla \rho \nabla \rho = \sum_{\alpha} g_{\alpha}^2({\bf r}) \]
</p>
<p> The derivative of \( \sigma \) with respect to the gradient of density is simply </p><p class="formulaDsp">
\[ \frac{\partial \sigma}{\partial g_{\alpha}} = 2 g_{\alpha} \]
</p>
<p>Changing variables in \( V_{XC} \) expression gives: </p><p class="formulaDsp">
\begin{eqnarray*} V_{XC}({\bf r}) &amp;=&amp; \frac{\partial}{\partial \rho} \varepsilon_{xc}(\rho, \sigma) - \nabla \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} \frac{\partial \sigma}{ \partial (\nabla \rho)} \\ &amp;=&amp; \frac{\partial}{\partial \rho} \varepsilon_{xc}(\rho, \sigma) - 2 \nabla \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} \nabla \rho - 2 \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} \nabla^2 \rho \end{eqnarray*}
</p>
<p> Alternative expression can be derived for the XC potential if we leave the gradient: </p><p class="formulaDsp">
\[ V_{XC}({\bf r}) = \frac{\partial}{\partial \rho} \varepsilon_{xc}(\rho, \sigma) - \sum_{\alpha} \frac{\partial}{\partial r_{\alpha}} \Big( \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} 2 g_{\alpha} \Big) = \frac{\partial}{\partial \rho} \varepsilon_{xc}(\rho, \sigma) - 2 \nabla \Big( \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} {\bf g}({\bf r}) \Big) \]
</p>
<p> The following sequence of functions must be computed:</p><ul>
<li>density on the real space grid</li>
<li>gradient of density (in spectral representation)</li>
<li>gradient of density on the real space grid</li>
<li>laplacian of density (in spectral representation)</li>
<li>laplacian of density on the real space grid</li>
<li><em>sigma</em> array</li>
<li>a call to Libxc must be performed <em>sigma</em> derivatives must be obtained</li>
<li>\( \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} \) in spectral representation</li>
<li>gradient of \( \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} \) in spectral representation</li>
<li>gradient of \( \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} \) on the real space grid</li>
</ul>
<p>Expression for spin-polarized potential has a bit more complicated form: </p><p class="formulaDsp">
\begin{eqnarray*} V_{XC}^{\gamma} &amp;=&amp; \frac{\partial \varepsilon_{xc}}{\partial \rho_{\gamma}} - \nabla \Big( 2 \frac{\partial \varepsilon_{xc}}{\partial \sigma_{\gamma \gamma}} \nabla \rho_{\gamma} + \frac{\partial \varepsilon_{xc}}{\partial \sigma_{\gamma \delta}} \nabla \rho_{\delta} \Big) \\ &amp;=&amp; \frac{\partial \varepsilon_{xc}}{\partial \rho_{\gamma}} -2 \nabla \frac{\partial \varepsilon_{xc}}{\partial \sigma_{\gamma \gamma}} \nabla \rho_{\gamma} -2 \frac{\partial \varepsilon_{xc}}{\partial \sigma_{\gamma \gamma}} \nabla^2 \rho_{\gamma} - \nabla \frac{\partial \varepsilon_{xc}}{\partial \sigma_{\gamma \delta}} \nabla \rho_{\delta} - \frac{\partial \varepsilon_{xc}}{\partial \sigma_{\gamma \delta}} \nabla^2 \rho_{\delta} \end{eqnarray*}
</p>
<p> In magnetic case the "up" and "dn" density and potential decomposition is used. Using the fact that the effective magnetic field is parallel to magnetization at each point in space, we can write the coupling of density and magnetization with XC potential and XC magentic field as: </p><p class="formulaDsp">
\[ V_{xc}({\bf r}) \rho({\bf r}) + {\bf B}_{xc}({\bf r}){\bf m}({\bf r}) = V_{xc}({\bf r}) \rho({\bf r}) + {\rm B}_{xc}({\bf r}) {\rm m}({\bf r}) = V^{\uparrow}({\bf r})\rho^{\uparrow}({\bf r}) + V^{\downarrow}({\bf r})\rho^{\downarrow}({\bf r}) \]
</p>
<p> where </p><p class="formulaDsp">
\begin{eqnarray*} \rho^{\uparrow}({\bf r}) &amp;=&amp; \frac{1}{2}\Big( \rho({\bf r}) + {\rm m}({\bf r}) \Big) \\ \rho^{\downarrow}({\bf r}) &amp;=&amp; \frac{1}{2}\Big( \rho({\bf r}) - {\rm m}({\bf r}) \Big) \end{eqnarray*}
</p>
<p> and </p><p class="formulaDsp">
\begin{eqnarray*} V^{\uparrow}({\bf r}) &amp;=&amp; V_{xc}({\bf r}) + {\rm B}_{xc}({\bf r}) \\ V^{\downarrow}({\bf r}) &amp;=&amp; V_{xc}({\bf r}) - {\rm B}_{xc}({\bf r}) \end{eqnarray*}
</p>
 
<p class="definition">Definition at line <a class="el" href="../../d6/d2b/xc_8cpp_source.html#l01048">1048</a> of file <a class="el" href="../../d6/d2b/xc_8cpp_source.html">xc.cpp</a>.</p>

</div>
</div>
<a id="ac53f9c549fb2e2a5e02992a823e792e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac53f9c549fb2e2a5e02992a823e792e7">&#9670;&nbsp;</a></span>generate_D_operator_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Potential::generate_D_operator_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate D operator from potential and augmentation charge. </p>
<p>The following real symmetric matrix is computed: </p><p class="formulaDsp">
\[ D_{\xi \xi&#39;}^{\alpha} = \int V({\bf r}) Q_{\xi \xi&#39;}^{\alpha}({\bf r}) d{\bf r} \]
</p>
<p> In the plane-wave domain this integrals transform into sum over Fourier components: </p><p class="formulaDsp">
\[ D_{\xi \xi&#39;}^{\alpha} = \sum_{\bf G} \langle V |{\bf G}\rangle \langle{\bf G}|Q_{\xi \xi&#39;}^{\alpha} \rangle = \sum_{\bf G} V^{*}({\bf G}) e^{-i{\bf r}_{\alpha}{\bf G}} Q_{\xi \xi&#39;}^{A}({\bf G}) = \sum_{\bf G} Q_{\xi \xi&#39;}^{A}({\bf G}) \tilde V_{\alpha}^{*}({\bf G}) \]
</p>
<p> where \( \alpha \) is the atom, \( A \) is the atom type and </p><p class="formulaDsp">
\[ \tilde V_{\alpha}({\bf G}) = e^{i{\bf r}_{\alpha}{\bf G}} V({\bf G}) \]
</p>
<p> Both \( V({\bf r}) \) and \( Q({\bf r}) \) functions are real and the following condition is fulfilled: </p><p class="formulaDsp">
\[ \tilde V_{\alpha}({\bf G}) = \tilde V_{\alpha}^{*}(-{\bf G}) \]
</p>
 <p class="formulaDsp">
\[ Q_{\xi \xi&#39;}({\bf G}) = Q_{\xi \xi&#39;}^{*}(-{\bf G}) \]
</p>
<p> In the sum over plane-wave coefficients the \( {\bf G} \) and \( -{\bf G} \) contributions will give: </p><p class="formulaDsp">
\[ Q_{\xi \xi&#39;}^{A}({\bf G}) \tilde V_{\alpha}^{*}({\bf G}) + Q_{\xi \xi&#39;}^{A}(-{\bf G}) \tilde V_{\alpha}^{*}(-{\bf G}) = 2 \Re \Big( Q_{\xi \xi&#39;}^{A}({\bf G}) \Big) \Re \Big( \tilde V_{\alpha}({\bf G}) \Big) + 2 \Im \Big( Q_{\xi \xi&#39;}^{A}({\bf G}) \Big) \Im \Big( \tilde V_{\alpha}({\bf G}) \Big) \]
</p>
<p> This allows the use of a <b>dgemm</b> instead of a <b>zgemm</b> when \( D_{\xi \xi&#39;}^{\alpha} \) matrix is calculated for all atoms of the same type. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/db8/generate__d__operator__matrix_8cpp_source.html#l00043">43</a> of file <a class="el" href="../../d4/db8/generate__d__operator__matrix_8cpp_source.html">generate_d_operator_matrix.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a8bfbcae94d3935db0be03f732f98001b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bfbcae94d3935db0be03f732f98001b">&#9670;&nbsp;</a></span>vsigma_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::array&lt;std::unique_ptr&lt;<a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt;double&gt; &gt;, 2&gt; sirius::Potential::vsigma_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Derivative \( \partial \epsilon^{XC} / \partial \sigma_{\alpha} \). </p>
<p>\( \epsilon^{XC} \) is the exchange-correlation energy per unit volume and \( \sigma \) is one of \( \nabla \rho_{\uparrow} \nabla \rho_{\uparrow} \), \( \nabla \rho_{\uparrow} \nabla \rho_{\downarrow} \) or \( \nabla \rho_{\downarrow} \nabla \rho_{\downarrow} \). This quantity is required to compute the GGA contribution to the XC stress tensor. </p>

<p class="definition">Definition at line <a class="el" href="../../de/df2/potential_8hpp_source.html#l00063">63</a> of file <a class="el" href="../../de/df2/potential_8hpp_source.html">potential.hpp</a>.</p>

</div>
</div>
<a id="a012796229f9d5c055dbd1fe7112dca27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a012796229f9d5c055dbd1fe7112dca27">&#9670;&nbsp;</a></span>dveff_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="../../d6/d10/classsirius_1_1_smooth__periodic__function.html">Smooth_periodic_function</a>&lt;double&gt; &gt; sirius::Potential::dveff_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Used to compute SCF correction to forces. </p>
<p>This function is set by PW code and is not computed here. </p>

<p class="definition">Definition at line <a class="el" href="../../de/df2/potential_8hpp_source.html#l00067">67</a> of file <a class="el" href="../../de/df2/potential_8hpp_source.html">potential.hpp</a>.</p>

</div>
</div>
<a id="a0126d2afa48714b359eede273905a64c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0126d2afa48714b359eede273905a64c">&#9670;&nbsp;</a></span>vh_el_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dab/classsddk_1_1mdarray.html">mdarray</a>&lt;double, 1&gt; sirius::Potential::vh_el_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Electronic part of Hartree potential. </p>
<p>Used to compute electron-nuclear contribution to the total energy </p>

<p class="definition">Definition at line <a class="el" href="../../de/df2/potential_8hpp_source.html#l00093">93</a> of file <a class="el" href="../../de/df2/potential_8hpp_source.html">potential.hpp</a>.</p>

</div>
</div>
<a id="a8b2c954a61491589a599738167416300"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b2c954a61491589a599738167416300">&#9670;&nbsp;</a></span>scale_rho_xc_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double sirius::Potential::scale_rho_xc_ {1}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A debug variable to scale the density when computing the XC potential. </p>
<p>This is used to verify the variational derivative of Exc </p>

<p class="definition">Definition at line <a class="el" href="../../de/df2/potential_8hpp_source.html#l00146">146</a> of file <a class="el" href="../../de/df2/potential_8hpp_source.html">potential.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../de/df2/potential_8hpp_source.html">potential.hpp</a></li>
<li><a class="el" href="../../d4/db8/generate__d__operator__matrix_8cpp_source.html">generate_d_operator_matrix.cpp</a></li>
<li><a class="el" href="../../de/dfb/generate__pw__coeffs_8cpp_source.html">generate_pw_coeffs.cpp</a></li>
<li><a class="el" href="../../d0/d7d/paw__potential_8cpp_source.html">paw_potential.cpp</a></li>
<li><a class="el" href="../../d8/dcd/poisson_8cpp_source.html">poisson.cpp</a></li>
<li><a class="el" href="../../d6/d2b/xc_8cpp_source.html">xc.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 4 2019 11:48:44 for SIRIUS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
