<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SIRIUS: Stress tensor</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SIRIUS
   &#160;<span id="projectnumber">4.3</span>
   </div>
   <div id="projectbrief">Electronic structure library and applications</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Stress tensor </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="stress_section1"></a>
Preliminary notes</h1>
<p>Derivative of the G-vector in Cartesian coordinates over the lattice vector components: </p><p class="formulaDsp">
\[ \frac{\partial G_{\tau}}{\partial a_{\mu\nu}} + ({\bf a}^{-1})_{\nu \tau} G_{\mu} = 0 \]
</p>
<p> Mathematica proof script: </p><pre class="fragment">A = Table[Subscript[a, i, j], {i, 1, 3}, {j, 1, 3}];
invA = Inverse[A];
B = 2*Pi*Transpose[Inverse[A]];
G = Table[Subscript[g, i], {i, 1, 3}];
gvec = B.G;
Do[
  Print[FullSimplify[
   D[gvec[[tau]], Subscript[a, mu, nu]] + invA[[nu]][[tau]]*gvec[[mu]]]],
{beta, 1, 3}, {mu, 1, 3}, {nu, 1,3}]
</pre><p> Another relation: </p><p class="formulaDsp">
\[ \frac{\partial}{\partial a_{\mu \nu}} \frac{1}{\sqrt{\Omega}} + \frac{1}{2} \frac{1}{\sqrt{\Omega}} ({\bf a}^{-1})_{\nu \mu} = 0 \]
</p>
<p> Mathematica proof script: </p><pre class="fragment">A = Table[Subscript[a, i, j], {i, 1, 3}, {j, 1, 3}];
invA = Inverse[A];
Do[
 Print[FullSimplify[
   D[1/Sqrt[Det[A]], Subscript[a, mu, nu]] + (1/2)*(1/Sqrt[Det[A]]) * invA[[nu]][[mu]]
   ]
  ],
{mu, 1, 3}, {nu, 1, 3}]
</pre><p>Strain tensor describes the deformation of a crystal: </p><p class="formulaDsp">
\[ r_{\mu} \rightarrow \sum_{\nu} (\delta_{\mu \nu} + \varepsilon_{\mu \nu}) r_{\nu} \]
</p>
<p> Strain derivative of general position vector component: </p><p class="formulaDsp">
\[ \frac{\partial r_{\tau}}{\partial \varepsilon_{\mu \nu}} = \delta_{\tau \mu} r_{\nu} \]
</p>
<p> Strain derivative of the lengths of general position vector: </p><p class="formulaDsp">
\[ \frac{\partial |{\bf r}|}{\partial \varepsilon_{\mu \nu}} = \sum_{\tau} \frac{\partial |{\bf r}|}{\partial r_{\tau}} \frac{\partial r_{\tau}}{\partial \varepsilon_{\mu \nu}} = \sum_{\tau} \frac{ r_{\tau}}{|{\bf r}|} \delta_{\tau \mu} r_{\nu} = \frac{r_{\mu} r_{\nu}}{|{\bf r}|} \]
</p>
<p> Strain derivative of unit cell volume: </p><p class="formulaDsp">
\[ \frac{\partial \Omega}{\partial \varepsilon_{\mu \nu}} = \delta_{\mu \nu} \Omega \]
</p>
<p> Strain derivative of reciprocal vector: </p><p class="formulaDsp">
\[ \frac{\partial G_{\tau}}{\partial \varepsilon_{\mu \nu}} = -\delta_{\tau \nu} G_{\mu} \]
</p>
<p> Strain derivative of the length of reciprocal vector: </p><p class="formulaDsp">
\[ \frac{\partial |{\bf G}|}{\partial \varepsilon_{\mu \nu}} = \sum_{\tau} \frac{\partial |{\bf G}|}{\partial G_{\tau}} \frac{\partial G_{\tau}}{\partial \varepsilon_{\mu \nu}} = -\frac{1}{|{\bf G}|}G_{\nu}G_{\mu} \]
</p>
<p> Stress tensor is a reaction to strain: </p><p class="formulaDsp">
\[ \sigma_{\mu \nu} = \frac{1}{\Omega} \frac{\partial E_{tot}}{\partial \varepsilon_{\mu \nu}} = \frac{1}{\Omega} \sum_{\mu&#39; \nu&#39;} \frac{\partial E_{tot}}{\partial a_{\mu&#39; \nu&#39;}} \frac{\partial a_{\mu&#39; \nu&#39;}}{\partial \varepsilon_{\mu \nu}} = \frac{1}{\Omega} \sum_{\nu&#39;} \frac{\partial E_{tot}}{\partial a_{\mu \nu&#39;}} a_{\nu \nu&#39;} \]
</p>
<h1><a class="anchor" id="stress_section2"></a>
Derivative of beta-projectors.</h1>
<p>We need to compute derivative of beta-projectors </p><p class="formulaDsp">
\[ \frac{\partial}{\partial a_{\mu \nu}} \langle {\bf G+k} | \beta_{\ell m} \rangle \]
</p>
<p>Derivative of the G-vector real spherical harmonics over the lattice vector components: </p><p class="formulaDsp">
\[ \frac{\partial R_{\ell m}(\theta, \phi)}{\partial a_{\mu \nu}} = \frac{\partial R_{\ell m}(\theta, \phi)}{\partial \theta} \frac{\partial \theta} {\partial a_{\mu \nu}} + \frac{\partial R_{\ell m}(\theta, \phi)}{\partial \phi} \frac{\partial \phi} {\partial a_{\mu \nu}} \]
</p>
<p> Derivatives of the \( R_{\ell m} \) with respect to the \( \theta,\, \phi\) angles can be tabulated up to a given \( \ell_{max} \). The derivatives of angles are computed as following: </p><p class="formulaDsp">
\[ \frac{\partial \theta} {\partial a_{\mu \nu}} = \sum_{\beta=1}^{3} \frac{\partial \theta}{\partial G_{\beta}} \frac{\partial G_{\beta}} {\partial a_{\mu \nu}} \]
</p>
 <p class="formulaDsp">
\[ \frac{\partial \phi} {\partial a_{\mu \nu}} = \sum_{\beta=1}^{3} \frac{\partial \phi}{\partial G_{\beta}} \frac{\partial G_{\beta}} {\partial a_{\mu \nu}} \]
</p>
<p> where </p><p class="formulaDsp">
\[ \frac{\partial \theta}{\partial G_{x}} = \frac{\cos(\phi) \cos(\theta)}{G} \\ \frac{\partial \theta}{\partial G_{y}} = \frac{\cos(\theta) \sin(\phi)}{G} \\ \frac{\partial \theta}{\partial G_{z}} = -\frac{\sin(\theta)}{G} \]
</p>
<p> and </p><p class="formulaDsp">
\[ \frac{\partial \phi}{\partial G_{x}} = -\frac{\sin(\phi)}{\sin(\theta) G} \\ \frac{\partial \phi}{\partial G_{y}} = \frac{\cos(\phi)}{\sin(\theta) G} \\ \frac{\partial \phi}{\partial G_{z}} = 0 \]
</p>
<p> The derivative of \( phi \) has discontinuities at \( \theta = 0, \theta=\pi \). This, however, is not a problem, because multiplication by the the derivative of \( R_{\ell m} \) removes it. The following functions have to be hardcoded: </p><p class="formulaDsp">
\[ \frac{\partial R_{\ell m}(\theta, \phi)}{\partial \theta} \\ \frac{\partial R_{\ell m}(\theta, \phi)}{\partial \phi} \frac{1}{\sin(\theta)} \]
</p>
<p>Derivatives of the spherical Bessel functions are computed in the same fashion: </p><p class="formulaDsp">
\[ \frac{\partial j_{\ell}(Gx)}{\partial a_{\mu \nu}} = \frac{\partial j_{\ell}(Gx)}{\partial G} \frac{\partial G} {\partial a_{\mu \nu}} = \frac{\partial j_{\ell}(Gx)}{\partial G} \sum_{\beta=1}^{3}\frac{\partial G}{\partial G_{\beta}} \frac{\partial G_{\beta}} {\partial a_{\mu \nu}} \]
</p>
<p> The derivatives of \( G \) are: </p><p class="formulaDsp">
\[ \frac{\partial G}{\partial G_{x}} = \sin(\theta)\cos(\phi) \\ \frac{\partial G}{\partial G_{y}} = \sin(\theta)\sin(\phi) \\ \frac{\partial G}{\partial G_{z}} = \cos(\theta) \]
</p>
<p>Let's write the full expression for the derivative of beta-projector matrix elements with respect to lattice vector components: </p><p class="formulaDsp">
\[ \frac{\partial \langle {\bf G+k}|\beta_{\ell m} \rangle} {\partial a_{\mu \nu}} = \frac{\partial} {\partial a_{\mu \nu}} \frac{4\pi}{\sqrt{\Omega}}(-i)^{\ell} R_{\ell m}(\theta_{G+k}, \phi_{G+k}) \int \beta_{\ell}(r) j_{\ell}(Gr) r^2 dr =\\ \frac{4\pi}{\sqrt{\Omega}} (-i)^{\ell} \Bigg[ \int \beta_{\ell}(r) j_{\ell}(Gr) r^2 dr \Big( \frac{\partial R_{\ell m}(\theta, \phi)}{\partial a_{\mu \nu}} - \frac{1}{2} R_{\ell m}(\theta, \phi) ({\bf a}^{-1})_{\nu \mu} \Big) + R_{\ell m}(\theta, \phi) \int \beta_{\ell}(r) \frac{\partial j_{\ell}(Gr)}{\partial a_{\mu \nu}} r^2 dr \Bigg] \]
</p>
<h1><a class="anchor" id="stress_section3"></a>
Kinetic energy contribution to stress.</h1>
<p>Kinetic contribution to stress tensor: </p><p class="formulaDsp">
\[ E^{kin} = \sum_{{\bf k}} w_{\bf k} \sum_i f_i \frac{1}{2} |{\bf G+k}|^2 |\psi_i({\bf G + k})|^2 \]
</p>
<p> Derivative over lattice vectors </p><p class="formulaDsp">
\[ \frac{\partial E^{kin}}{\partial a_{\mu \nu}} = \sum_{{\bf k}} w_{\bf k} \sum_i f_i \sum_{\tau} (G+k)_{\tau} (-{\bf a}^{-1})_{\nu \tau} (G+k)_{\mu} |\psi_i({\bf G + k})|^2 \]
</p>
<p> Contribution to the stress tensor </p><p class="formulaDsp">
\[ \sigma_{\mu \nu}^{kin} = \frac{1}{\Omega} \sum_{\nu&#39;} \frac{\partial E^{kin}}{\partial a_{\mu \nu&#39;}} a_{\nu \nu&#39;} = \frac{1}{\Omega} \sum_{\nu&#39;} \sum_{{\bf k}} w_{\bf k} \sum_i f_i \sum_{\tau} (G+k)_{\tau} (-{\bf a}^{-1})_{\nu&#39; \tau} (G+k)_{\mu} |\psi_i({\bf G + k})|^2 a_{\nu \nu&#39;} = -\frac{1}{\Omega} \sum_{{\bf k}} w_{\bf k} \sum_i (G+k)_{\nu} (G+k)_{\mu} f_i |\psi_i({\bf G + k})|^2 \]
</p>
<h1><a class="anchor" id="stress_section4"></a>
Hartree energy contribution to stress.</h1>
<p>Hartree energy: </p><p class="formulaDsp">
\[ E^{H} = \frac{1}{2} \int_{\Omega} \rho({\bf r}) V^{H}({\bf r}) d{\bf r} = \frac{1}{2} \frac{1}{\Omega} \sum_{\bf G} \langle \rho | {\bf G} \rangle \langle {\bf G}| V^{H} \rangle = \frac{2 \pi}{\Omega} \sum_{\bf G} \frac{|\tilde \rho({\bf G})|^2}{G^2} \]
</p>
<p> where </p><p class="formulaDsp">
\[ \langle {\bf G} | \rho \rangle = \int e^{-i{\bf Gr}}\rho({\bf r}) d {\bf r} = \tilde \rho({\bf G}) \]
</p>
<p> and </p><p class="formulaDsp">
\[ \langle {\bf G} | V^{H} \rangle = \int e^{-i{\bf Gr}}V^{H}({\bf r}) d {\bf r} = \frac{4\pi}{G^2} \tilde \rho({\bf G}) \]
</p>
<p>Hartree energy contribution to stress tensor: </p><p class="formulaDsp">
\[ \sigma_{\mu \nu}^{H} = \frac{1}{\Omega} \frac{\partial E^{H}}{\partial \varepsilon_{\mu \nu}} = \frac{1}{\Omega} 2\pi \Big( \big( \frac{\partial}{\partial \varepsilon_{\mu \nu}} \frac{1}{\Omega} \big) \sum_{{\bf G}} \frac{|\tilde \rho({\bf G})|^2}{G^2} + \frac{1}{\Omega} \sum_{{\bf G}} |\tilde \rho({\bf G})|^2 \frac{\partial}{\partial \varepsilon_{\mu \nu}} \frac{1}{G^2} \Big) = \\ \frac{1}{\Omega} 2\pi \Big( -\frac{1}{\Omega} \delta_{\mu \nu} \sum_{{\bf G}} \frac{|\tilde \rho({\bf G})|^2}{G^2} + \frac{1}{\Omega} \sum_{\bf G} |\tilde \rho({\bf G})|^2 \sum_{\tau} \frac{-2 G_{\tau}}{G^4} \frac{\partial G_{\tau}}{\partial \varepsilon_{\mu \nu}} \Big) = \\ 2\pi \sum_{\bf G} \frac{|\rho({\bf G})|^2}{G^2} \Big( -\delta_{\mu \nu} + \frac{2}{G^2} G_{\nu} G_{\mu} \Big) \]
</p>
<h1><a class="anchor" id="stress_section5"></a>
Ewald energy contribution to stress.</h1>
<p>Ewald energy: </p><p class="formulaDsp">
\[ E^{ion-ion} = \frac{1}{2} \sideset{}{&#39;} \sum_{\alpha \beta {\bf T}} Z_{\alpha} Z_{\beta} \frac{{\rm erfc}(\sqrt{\lambda} |{\bf r}_{\alpha} - {\bf r}_{\beta} + {\bf T}|)}{|{\bf r}_{\alpha} - {\bf r}_{\beta} + {\bf T}|} + \frac{2 \pi}{\Omega} \sum_{{\bf G}} \frac{e^{-\frac{G^2}{4 \lambda}}}{G^2} \Big| \sum_{\alpha} Z_{\alpha} e^{-i{\bf r}_{\alpha}{\bf G}} \Big|^2 - \sum_{\alpha} Z_{\alpha}^2 \sqrt{\frac{\lambda}{\pi}} - \frac{2\pi}{\Omega}\frac{N_{el}^2}{4 \lambda} \]
</p>
<p> Contribution to stress tensor: </p><p class="formulaDsp">
\[ \sigma_{\mu \nu}^{ion-ion} = \frac{1}{\Omega} \frac{\partial E^{ion-ion}}{\partial \varepsilon_{\mu \nu}} \]
</p>
<p> Derivative of the first part: </p><p class="formulaDsp">
\[ \frac{1}{\Omega}\frac{\partial}{\partial \varepsilon_{\mu \nu}} \frac{1}{2} \sideset{}{&#39;} \sum_{\alpha \beta {\bf T}} Z_{\alpha} Z_{\beta} \frac{{\rm erfc}(\sqrt{\lambda} |{\bf r}_{\alpha} - {\bf r}_{\beta} + {\bf T}|)}{|{\bf r}_{\alpha} - {\bf r}_{\beta} + {\bf T}|} = \frac{1}{2\Omega} \sideset{}{&#39;} \sum_{\alpha \beta {\bf T}} Z_{\alpha} Z_{\beta} \Big( -2e^{-\lambda |{\bf r&#39;}|^2} \sqrt{\frac{\lambda}{\pi}} \frac{1}{|{\bf r&#39;}|^2} - {\rm erfc}(\sqrt{\lambda} |{\bf r&#39;}|) \frac{1}{|{\bf r&#39;}|^3} \Big) r&#39;_{\mu} r&#39;_{\nu} \]
</p>
<p> where \( {\bf r&#39;} = {\bf r}_{\alpha} - {\bf r}_{\beta} + {\bf T} \).</p>
<p>Derivative of the second part: </p><p class="formulaDsp">
\[ \frac{1}{\Omega}\frac{\partial}{\partial \varepsilon_{\mu \nu}} \frac{2\pi}{\Omega} \sum_{{\bf G}} \frac{e^{-\frac{G^2}{4 \lambda}}}{G^2} \Big| \sum_{\alpha} Z_{\alpha} e^{-i{\bf r}_{\alpha}{\bf G}} \Big|^2 = -\frac{2\pi}{\Omega^2} \delta_{\mu \nu} \sum_{{\bf G}} \frac{e^{-\frac{G^2}{4 \lambda}}}{G^2} \Big| \sum_{\alpha} Z_{\alpha} e^{-i{\bf r}_{\alpha}{\bf G}} \Big|^2 + \frac{2\pi}{\Omega^2} \sum_{\bf G} G_{\mu} G_{\nu} \frac{e^{-\frac{G^2}{4 \lambda}}}{G^2} 2 \frac{\frac{G^2}{4\lambda} + 1}{G^2} \Big| \sum_{\alpha} Z_{\alpha} e^{-i{\bf r}_{\alpha}{\bf G}} \Big|^2 \]
</p>
<p>Derivative of the fourth part: </p><p class="formulaDsp">
\[ -\frac{1}{\Omega}\frac{\partial}{\partial \varepsilon_{\mu \nu}} \frac{2\pi}{\Omega}\frac{N_{el}^2}{4 \lambda} = \frac{2\pi}{\Omega^2}\frac{N_{el}^2}{4 \lambda} \delta_{\mu \nu} \]
</p>
<h1><a class="anchor" id="stress_section6"></a>
Local potential contribution to stress.</h1>
<p>Energy contribution from the local part of pseudopotential: </p><p class="formulaDsp">
\[ E^{loc} = \int \rho({\bf r}) V^{loc}({\bf r}) d{\bf r} = \frac{1}{\Omega} \sum_{\bf G} \langle \rho | {\bf G} \rangle \langle {\bf G}| V^{loc} \rangle = \frac{1}{\Omega} \sum_{\bf G} \tilde \rho^{*}({\bf G}) \tilde V^{loc}({\bf G}) \]
</p>
<p> where </p><p class="formulaDsp">
\[ \tilde \rho({\bf G}) = \langle {\bf G} | \rho \rangle = \int e^{-i{\bf Gr}}\rho({\bf r}) d {\bf r} \]
</p>
<p> and </p><p class="formulaDsp">
\[ \tilde V^{loc}({\bf G}) = \langle {\bf G} | V^{loc} \rangle = \int e^{-i{\bf Gr}}V^{loc}({\bf r}) d {\bf r} \]
</p>
<p> Using the expression for \( \tilde V^{loc}({\bf G}) \), the local contribution to the total energy is rewritten as </p><p class="formulaDsp">
\[ E^{loc} = \frac{1}{\Omega} \sum_{\bf G} \tilde \rho^{*}({\bf G}) \sum_{\alpha} e^{-{\bf G\tau}_{\alpha}} 4 \pi \int V_{\alpha}^{loc}(r)\frac{\sin(Gr)}{Gr} r^2 dr = \frac{4\pi}{\Omega}\sum_{\bf G}\tilde \rho^{*}({\bf G})\sum_{\alpha} e^{-{\bf G\tau}_{\alpha}} \Bigg( \int \Big(V_{\alpha}(r) r + Z_{\alpha}^p {\rm erf}(r) \Big) \frac{\sin(Gr)}{G} dr - Z_{\alpha}^p \frac{e^{-\frac{G^2}{4}}}{G^2} \Bigg) \]
</p>
<p> (see <a class="el" href="classsirius_1_1_potential.html#ab4383d38a605d0b6367da339035e0130">sirius::Potential::generate_local_potential</a> for details).</p>
<p>Contribution to stress tensor: </p><p class="formulaDsp">
\[ \sigma_{\mu \nu}^{loc} = \frac{1}{\Omega} \frac{\partial E^{loc}}{\partial \varepsilon_{\mu \nu}} = \frac{1}{\Omega} \frac{-1}{\Omega} \delta_{\mu \nu} \sum_{\bf G}\tilde \rho^{*}({\bf G}) \tilde V^{loc}({\bf G}) + \frac{4\pi}{\Omega^2} \sum_{\bf G}\tilde \rho^{*}({\bf G}) \sum_{\alpha} e^{-{\bf G\tau}_{\alpha}} \Bigg( \int \Big(V_{\alpha}(r) r + Z_{\alpha}^p {\rm erf}(r) \Big) \Big( \frac{r \cos (G r)}{G}-\frac{\sin (G r)}{G^2} \Big) \Big( -\frac{G_{\mu}G_{\nu}}{G} \Big) dr - Z_{\alpha}^p \Big( -\frac{e^{-\frac{G^2}{4}}}{2 G}-\frac{2 e^{-\frac{G^2}{4}}}{G^3} \Big) \Big( -\frac{G_{\mu}G_{\nu}}{G} \Big) \Bigg) = \\ -\delta_{\mu \nu} \sum_{\bf G}\rho^{*}({\bf G}) V^{loc}({\bf G}) + \sum_{\bf G} \rho^{*}({\bf G}) \Delta V^{loc}({\bf G}) G_{\mu}G_{\nu} \]
</p>
<p> where \( \Delta V^{loc}({\bf G}) \) is built from the following radial integrals: </p><p class="formulaDsp">
\[ \int \Big(V_{\alpha}(r) r + Z_{\alpha}^p {\rm erf}(r) \Big) \Big( \frac{\sin (G r)}{G^3} - \frac{r \cos (G r)}{G^2}\Big) dr - Z_{\alpha}^p \Big( \frac{e^{-\frac{G^2}{4}}}{2 G^2} + \frac{2 e^{-\frac{G^2}{4}}}{G^4} \Big) \]
</p>
<h1><a class="anchor" id="stress_section7"></a>
Non-local contribution to stress.</h1>
<p>Energy contribution from the non-local part of pseudopotential: </p><p class="formulaDsp">
\[ E^{nl} = \sum_{i{\bf k}} \sum_{\alpha}\sum_{\xi \xi&#39;}P_{\xi}^{*\alpha,i{\bf k}} D_{\xi\xi&#39;}^{\alpha}P_{\xi&#39;}^{\alpha,i{\bf k}} \]
</p>
<p> where </p><p class="formulaDsp">
\[ P_{\xi}^{\alpha,i{\bf k}} = \langle \beta_{\xi}^{\alpha} | \psi_{i{\bf k}} \rangle \]
</p>
 </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Mar 20 2017 09:52:03 for SIRIUS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
